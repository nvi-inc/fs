FTN4,X
C@BPSET 
C 
      SUBROUTINE BPSET(IHOLD,IBYPCH,ITRK,KSPLIT,ITKA,ITKB,ISKIP)
     .,SETS TRACKS AND IBYPPC C#780803:09:10# 
C 
C     This routine sets up IBYPAS and the A and B tracks
C     for the tape recorder, according to the mode specified
C     in the common variables IREPPC and IBYPPC.  Before
C     changing ITRAKA, ITRAKB and IBYPAS, uncheck the tape
C     recorder and remember the check value in IHOLD. 
C     Also check if RAW and track not enabled, then don't do track. 
C 
      INCLUDE #FSCOM::FS
C 
      LOGICAL KSPLIT
C 
100   IHOLD = ICHECK(18)
      ICHECK(18) = 0
      ITRAKB = ITRK 
      KSPLIT = .FALSE.
C      - uncheck tape recorder whilst changing tracks 
700   GOTO (701,702,702,704) IREPPC+1 
701   IBYPPC = IBYPAS 
      IF (ITRKPC(ITRK).GE.1.AND.ITRKPC(ITRK).LE.28.AND.IBYPPC.GT.0) 
     . KSPLIT = .TRUE.
      GOTO 705
702   IBYPAS = IBYPPC 
      GOTO 705
704   IBYPAS = IBYPPC 
      IF (ITRKPC(ITRK).GE.1.AND.ITRKPC(ITRK).LE.28) KSPLIT = .TRUE. 
705   IBYPCH = IBYPPC 
      IF (KSPLIT) ITRAKA = ITRKPC(ITRK) 
      ITKA = ITRAKA 
      ITKB = ITRAKB 
      IF (IBYPCH.EQ.0.AND.ITRKEN(ITRK).EQ.0) ISKIP = -1 
      END 
