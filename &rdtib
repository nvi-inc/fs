FTN4,X
C@RDTIB 
C 
      SUBROUTINE RDTIB(IDCB,ICR,IERR),READ TABLE FOR IB C#870115:04:18# 
C 
C 1.1.   RDTIB reads a table of names and addresses of HPIB devices 
C 
C     INPUT VARIABLES:
C 
      DIMENSION IDCB(1) 
C                   DCB for files 
C 
C     OUTPUT VARIABLES: 
C 
C     IERR - error return, 0 OK, <0 trouble 
C 
C     CALLED SUBROUTINES: FMP PACKAGE, IBCON
C 
C 3.  LOCAL VARIABLES 
C 
      DIMENSION IP(5) 
C                   for RMPAR 
      DIMENSION IBUF(4) 
C                   buffer to hold input records
      DIMENSION LNAMEF(3) 
C                   name of file with correspondences 
C     ICLASS - class to send to IBCON 
C     NREC   - number of records in class 
C 
C 4.  CONSTANTS USED
C 
C 5.  INITIALIZED VARIABLES 
C 
      DATA LNAMEF /2H(I,2HBA,2HD /
C 
C 6.  PROGRAMMER: NRV 
C     LAST MODIFIED: 800224 
C# LAST COMPC'ED  870115:04:18 #
C 
C     PROGRAM STRUCTURE 
C 
C     1. Open up the file with the name/address correspondences.
C 
      CALL OPEN(IDCB,IERR,LNAMEF,0,0,ICR) 
      IF (IERR.LT.0) RETURN 
      CALL READF(IDCB,IERR,IBUF,4,ILEN) 
      ICLASS = 0
      NREC = 0
      DO 100 I=1,256
      IF (ILEN.LT.0) GOTO 110 
        CALL EXEC(20,0,IBUF,-7,0,0,ICLASS)
C                   Put record into class record
        NREC = NREC + 1 
        CALL READF(IDCB,IERR,IBUF,4,ILEN) 
100     CONTINUE
110   CALL CLOSE(IDCB)
C 
C     2. Now schedule IBCON and wait until it's done. 
C 
200   CALL EXEC(9,6HIBCON ,ICLASS,NREC) 
      CALL RMPAR(IP)
      IERR = IP(3)
      RETURN
      END 
