FTN4
      FUNCTION IGETB(IBUF,N)
C 
C     ROUTINE TO RETURN VALUE OF Nth BIT IN ARRAY IBUF. 
C     FIRST BIT IS BIT #1.
C 
      INTEGER MASK(16),IBUF(1)
      DATA MASK/100000B,40000B,20000B,10000B,4000B,2000B,1000B, 
     .          400B,200B,100B,40B,20B,10B,4B,2B,1B/
C 
      NN=N-1
      IW=NN/16+1
      IGETB=0 
      IF (IAND(IBUF(IW),MASK(MOD(NN,16)+1)) .NE. 0) IGETB=1 
      RETURN
      END 
