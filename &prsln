FTN4,X
C@PRSLN 
C 
        SUBROUTINE PRSLN(IBUFF,LEN,NOUT),C#870227:18:36 V=2.0#
C 
C     PRSLN 
C 
C 1.  NAME PROGRAM SPECIFICATION
C 
C 1.1.   PRSLN
C               THIS ROUTINE PARSES AN INPUT STREAM OF THE FORM 
C 
C                       NAME,O1,O2,P1,P2,P3,P4,P5 
C 
C       AND RETURNS THE CONVERTED VALUES IN NOUT IN THE FORM
C       FOR THE FOLLOWING CASES:
C 
C       O1 - NUMERIC
C 
C               NOUT(1-3)       - NAME
C 
C               NOUT(4-5)       - O1,O2 
C 
C               NOUT(6-10)      - P1 - P5 WHERE NUMBERS (DECIMAL
C                                 AND OCTAL) HAVE BEEN CONVERTED
C                                 AND THE FIRST 2 ASCII CHARACTERS
C                                 HAVE BEEN RETURNED. 
C 
C 
C 1.2.   RESTRICTIONS - limits on use of routine
C 
C 1.3.   REFERENCES - document cited
C 
C 2.  NAME INTERFACE
C 
C 2.1.   CALLING SEQUENCE: CALL PRSLN(IBUFF,LEN,NOUT) 
C 
C     INPUT VARIABLES:
C 
C       GLOBAL DEFS REFERENCED: "name'(local name if different)' ...
C 
        DIMENSION IBUFF(1),NOUT(1)
C 
C       IBUFF   - INPUT BUFFER FOR PARSING
C 
C       LEN     - LENGTH OF INPUT BUFFER TO USE 
C 
C       NOUT    - OUTPUT ARRAY OF FOLLOWING FORM
C 
C               NOUT(1-3)       - ASCII NAME PRECEEDING FIRST COMMA 
C 
C               IF O1 IS NUMERIC THEN 
C 
C               NOUT(4 -,- 10)  - CONVERTED INPUT OR FIRST 2 ASCII
C                                 CHARACTERS (O1,O2,P1,,P5 IN ORDER)
C 
C               NOUT(11)        - NUMBER OF PARAMETERS PRESENT
C 
C               IF O1 =3HOFF THEN 
C 
C               NOUT(4) =400B - OFF INDICATOR 
C 
C               NOUT(5) =O2 IF PRESENT
C 
C               NOUT(6-10)      0 
C 
C               NOUT(11)        NUMBER OF PARAMETERS PRESENT(3,4) 
C                                -1 IMPLIES NO NAME FOUND 
C 
C     OUTPUT VARIABLES: 
C 
C       GLOBAL DEFS REFERENCED: "name'(local name if different)' ...
C 
C 2.2.   COMMON BLOCKS USED 
C 
C 2.3.   DATA BASE ACCESSES 
C 
C 2.4.   EXTERNAL INPUT/OUTPUT
C 
C 2.5.   SUBROUTINE INTERFACE:
C 
C     CALLING SUBROUTINES: SUB1, SUB2, ... (not required for utilities) 
C 
C     CALLED SUBROUTINES: SUB1, SUB2, ... (includes segments scheduled) 
C 
C 3.  LOCAL VARIABLES 
C 
C       GLOBAL DEFS REFERENCED: "name'(local name if different)' ...
C 
        DIMENSION IRBUF(4,9)
C 
C       IRBUF   - PARSE OUTPUT BUFFER FOR EXTRACTING INFORMATION
C 
C 4.  CONSTANTS USED
C 
C 5.  INITIALIZED VARIABLES 
C 
C 6.  PROGRAMMER: LEE N. FOSTER 
C     LAST MODIFIED:
C# LAST COMPC'ED  870227:18:36urrent date) #
C 
C     PROGRAM STRUCTURE 
C 
C               PARSE THE INPUT USING SYSTEM FUNCTION 
C 
        CALL PARSE(IBUFF,IABS(LEN),IRBUF) 
C 
C               CHECK FOR NAME FOUND
C 
        NOUT(11)=0
C 
        IF(IRBUF .NE. 2)GO TO 99999 
C 
C               MOVE IN NAME FIELD
C 
        CALL ICHMV(NOUT,1,IRBUF,3,6)
C 
C               SAVE # OF PARAMETERS FOUND
C 
        NOUT(11)=IRBUF(1,9) 
C 
C               NOTE PARAMETER PRESENT IF ASKED TO
C 
        IF(LEN .LT. 0)NOUT(11)=IOR(NOUT(11),100000B)
C 
C               CHECK FOR O1 NUMERIC
C 
        IF(IRBUF(1,2) .GT. 1)GO TO 20000
C 
C               MOVE VALID PARAMETERS TO OUTPUT OR ZERO PARM
C 
        DO 10000 I=2,8
C 
C               FIRST RESET OUTPUT
C 
        IF(LEN .GT. 0)NOUT(I+2)=0 
C 
C               REPLACE WITH VALID INPUT IF PRESENT 
C 
        IF(IRBUF(1,I) .EQ. 0)GO TO 10000
C 
C               DO THE REPLACE AT THIS POINT
C 
        NOUT(I+2)=IRBUF(2,I)
C 
C               RECORD PARAMETER PRESENT IF ASKED TO
C 
        IF(LEN .LT. 0)NOUT(11)=ISBIT(NOUT(11),16-I) 
C 
10000   CONTINUE
C 
C               NOW EXIT
C 
        GO TO 99999 
C 
20000   CONTINUE
C 
C               CHECK FOR OFF 
C 
        IF(ICHCM(IRBUF(2,2),1,3HOFF,1,3) .NE. 0)GO TO 99999 
C 
C               NOTE OFF FOUND
C 
        NOUT(4)=400B
C 
C               CLEAR THE REST OF THE PARAMETERS
C 
        CALL IFILL(NOUT(5),1,12,0)
C 
C               CHECK FOR O2 PRESENT
C 
        IF(IRBUF(1,3) .EQ. 0 .OR. NOUT(11) .LT. 3)GO TO 99999 
C 
C               SAVE O2 
C 
        NOUT(5)=IRBUF(2,3)
C 
C 
99999   CONTINUE
C 
        RETURN
        END 
        END$
