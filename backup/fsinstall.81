#!/bin/sh
# This is the installation script for Field System version 8.1
# Created by G. Gregorich 921106
# Modified by N. Vandenberg 921202
#
echo "******************************************************************"
echo "*  This is the INSTALLATION script for Field System version 8.1  *"
echo "*  Refer to instructions in the Computer Reference manual.       *"
echo "******************************************************************"
echo "\nCAUTION: This script will REMOVE all files in the following "
echo "         directories and their subdirectories before restoring "
echo "         the standard distributed files from the floppy:"
echo "                /usr2/fs" 
echo "                /usr2/control"
echo "                /usr2/sched"
echo "                /usr2/proc"
echo "                /usr2/log"
echo "                /usr2/st"
echo "\nIf you want to update only the Field System software, use"
echo "the fsupdate.81 script instead."
echo "\nDo you wish to continue with the complete INSTALLATION? (y=yes, n=no) : \c" 
badans=true
while [ "$badans" = "true" ]
do
  read ans
  case "$ans" in
    y|yes) echo "\nO.K. Continuing with install ... "
           badans=false
           ;;
    n|no)  echo "\nO.K. Exiting."
           exit
           ;;
    *)     echo "\nPlease answer with y=yes or n=no : \c"
  esac
done

# UNCOMPRESS THE CPIO FILES FROM THE DISTRIBUTION DISKETTE
/usr/bin/X11/uncompress fsc.cpio.Z
/usr/bin/X11/uncompress fsd.cpio.Z
/usr/bin/X11/uncompress fsf.cpio.Z
/usr/bin/X11/uncompress fsi.cpio.Z
/usr/bin/X11/uncompress fsm.cpio.Z
/usr/bin/X11/uncompress fso.cpio.Z
/usr/bin/X11/uncompress fsp.cpio.Z
# Remove all old files
rm -rf /usr2/fs
rm -rf /usr2/control
rm -rf /usr2/sched
rm -rf /usr2/proc
rm -rf /usr2/log
rm -rf /usr2/st
# WRITE ALL THE FILES USING CPIO
cpio -Bicmuvd < fsc.cpio
cpio -Bicmuvd < fsd.cpio
cpio -Bicmuvd < fsf.cpio
cpio -Bicmuvd < fsi.cpio
cpio -Bicmuvd < fsm.cpio
cpio -Bicmuvd < fso.cpio
cpio -Bicmuvd < fsp.cpio
# Create BIN subdirectory for FS
cd /usr2/fs
mkdir bin
# CREATE AND COPY THE DEFAULT CONTROL FILES TO THE CONTROL DIRECTORY
cd /usr2
mkdir control
chmod +w control
cd /usr2/fs/st/control
cp * /usr2/control/.
# CREATE THE LOG DIRECTORY
cd /usr2
mkdir log
chmod +w log
# CREATE AND COPY THE DEFAULT PROCEDURE FILES TO THE PROC DIRECTORY
mkdir proc
chmod +w proc
cd /usr2/fs/st/proc
cp * /usr2/proc/.
# CREATE AND COPY THE DEFAULT SCHEDULE FILES TO THE SCHED DIRECTORY
cd /usr2
mkdir sched
chmod +w sched
cd /usr2/fs/st/sched
cp * /usr2/sched/.
# CREATE AND COPY THE DEFAULT ST FILES TO THE ST DIRECTORY
cd /usr2
mkdir st
chmod +w st
cd st
mkdir antcn
mkdir bin
mkdir include
mkdir stalloc
mkdir stlib
mkdir stqkr
chmod +w *
cd /usr2/fs/st/antcn
cp * /usr2/st/antcn/.
cd /usr2/fs/st/stlib
cp * /usr2/st/stlib/.
cd /usr2/fs/st/stalloc
cp * /usr2/st/stalloc/.
cd /usr2/fs/st/stqkr
cp * /usr2/st/stqkr/.
cd /usr2/fs/st/include
cp * /usr2/st/include/.
cd /usr2/fs
mkdir bin
chmod +w bin
# COPY THE SYSTEM MISCELLANEOUS FILES TO THEIR RESPECTIVE DIRECTORIES
cd /usr2/fs/misc
cp S* /etc/rc2.d/.
mv /usr/lib/X11/xdm/Xresources /usr/lib/X11/xdm/Xresources.org
cp Xresources /usr/lib/X11/xdm/.
cp remake /usr2/fs/.
cp rmdoto /usr2/fs/.
# COPY THE DEFAULT ACCOUNT FILES TO THE HOME DIRECTORIES OF OPER, PROG, 
# AND DOS USERS
#   OPER
cd /usr2/fs/oper
cp Xresources /usr2/oper/.Xresources
cp cshrc /usr2/oper/.cshrc
cp exrc /usr2/oper/.exrc
cp login /usr2/oper/.login
cp mwmrc /usr2/oper/.mwmrc
cp xsession /usr2/oper/.xsession
cp fitter /usr2/oper/fitter
cp update /usr2/oper/update
cd /usr2/oper
chown oper .*
#   PROG
cd /usr2/fs/oper
cp Xresources /usr2/prog/.Xresources
cp cshrc /usr2/prog/.cshrc
cp exrc /usr2/prog/.exrc
cp login /usr2/prog/.login
cp mwmrc /usr2/prog/.mwmrc
cp xsession /usr2/prog/.xsession
cd /usr2/prog
chown prog .*
#   DOS
cd /usr2/fs/oper
cp Xresources /usr2/dos/.Xresources
cp cshrc /usr2/dos/.cshrc
cp exrc /usr2/dos/.exrc
cp login /usr2/dos/.login
cp mwmrc /usr2/dos/.mwmrc
cp xsession /usr2/dos/.xsession
cd /usr2/dos
chown dos .*
# CHANGE THE OWNERSHIP OF ALL SOURCE CODE AND RELATED FILES TO PROG
cd /usr2/fs
find . -print | xargs chown prog
cd /usr2/st
find . -print | xargs chown prog
# CHANGE THE OWNERSHIP OF THESE FILES TO ROOT  !!! VERY IMPORTANT !!!
cd /usr2/fs/setb
chown root *
cd /tmp/fs
