#!/bin/sh
# This is the update script for Field System version 8.2, for root only
#
echo "******************************************************************"
echo "*  This is the UPDATE script for Field System version 8.2        *"
echo "*  Refer to instructions in the update notice.                   *"
echo "******************************************************************"
echo "\nCAUTION: This script will REMOVE all files in the following "
echo "         directories and their subdirectories before restoring "
echo "         the standard distributed files from the floppy:"
echo "                /usr2/fs" 
echo "\nIf you want to perform a complete installation, use the fsinstall.82"
echo "script instead."
echo "\nDo you wish to continue with the UPDATE? (y=yes, n=no) : \c" 
badans=true
while [ "$badans" = "true" ]
do
  read ans
  case "$ans" in
    y|yes) echo "\nO.K. Continuing with update ... "
           badans=false
           ;;
    n|no)  echo "\nO.K. Exiting."
           exit
           ;;
    *)     echo "\nPlease answer with y=yes or n=no : \c"
  esac
done
#
echo "Uncompressing cpio archive"
ulimit 409600
cd /tmp/fsdist
/usr/bin/X11/uncompress fs.cpio.Z
#
echo "Removing any old directories"
rm -rf /usr2/fs
#
echo "Restoring FS files"
cd /usr2
cpio -icmud < /tmp/fsdist/fs.cpio
#
echo "Setting permissions"
cd /usr2
find fs -print |xargs chown prog
find fs -print |xargs chgrp code
find fs -print |xargs chmod a+r,ug+w,o-w
#
echo "Making setb"
cd /usr2/fs/setb
cc -o setb setb.c
./setb setb
#
echo "Done."
