FTN4,X
C@IF2MA 
C 
      SUBROUTINE IF2MA(IBUF,IAT1,IAT2,INP1,INP2)
     .,CONVERT IFD DATA TO MAT BUFFER C#890516:19:00# 
C 
C     IF2MA converts data for the IF distributor to an MAT buffer.
C 
C  INPUT: 
C 
C     IBUF - buffer to use
C     INP1,2 - the IFD's input type 
C     IAT1,2 - attenuator settings
      DIMENSION IBUF(1) 
C 
C     The buffer is set up as follows:
C                       00ija2a1
C     where each letter represents a character (half word). 
C                   00 = these bits unused
C                   i  = input for IF 2 (0=NOR,8=ALT) 
C                   j  = input for IF 1  (0=NOR,8=ALT)
C                   a2 = atten. setting for IF 2
C                   a1 = atten. setting for IF 1
C 
      CALL IFILL(IBUF,1,2,2H00) 
C                   Fill unused fields with zeros 
      CALL IB2AS(INP2*8,IBUF,3,1) 
      CALL IB2AS(INP1*8,IBUF,4,1) 
C                     Put inputs into chars 3,4 
C 
      CALL ICHMV(IBUF,7,IHX2A(IAND(IAT1,60B)/16),2,1) 
C                     Put upper two bits (of six) into char 7 
      CALL ICHMV(IBUF,8,IHX2A(IAND(IAT1,17B)),2,1)
C                     Put lower four bits into next character.
      CALL ICHMV(IBUF,5,IHX2A(IAND(IAT2,60B)/16),2,1) 
      CALL ICHMV(IBUF,6,IHX2A(IAND(IAT2,17B)),2,1)
C                     Do the same for channel 2 
C 
C 
      RETURN
      END 
