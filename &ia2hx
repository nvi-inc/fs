FTN4,X
      FUNCTION IA2HX(LBUF,ICH)
C     CONVERT HEX CHARACTER ICH OF LBUF TO BINARY 
      DIMENSION IVAL(23)
      DATA IVAL/0,1,2,3,4,5,6,7,8,9,7*0,10,11,12,13,14,15/  
      LCH = ICHAR(LBUF,ICH) 
C                   Extract the character 
      IA2HX = -1
C               <0     OR      >F   OR       (>9 AND <A)
      IF (LCH.LT.60B.OR.LCH.GT.106B.OR.(LCH.GT.71B.AND.LCH.LT.101B))  
     .RETURN
      IA2HX = IVAL(LCH-57B) 
      RETURN
      END 
