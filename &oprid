FTN4
C@OPRID 
      SUBROUTINE OPRID(IP),OPERATOR ID C#870115:04:53#
C 
C     OPRID gets/displays the operator's name 
C 
C     INPUT VARIABLES:
C 
      DIMENSION IP(1) 
C        IP(1)  - class number of input parameter buffer. 
C 
C     OUTPUT VARIABLES: 
C 
C        IP(1) - CLASS #
C        IP(2) - # RECORDS IN CLASS 
C        IP(3) - ERROR
C        IP(4) - who we are 
C 
      INCLUDE #FSCOM::56
C 
C     CALLED SUBROUTINES: CHARACTER ROUTINES
C 
C   LOCAL VARIABLES 
C 
C        NCHAR  - number of characters in buffer
C        NCH    - character counter 
      DIMENSION IBUF(20)
C               - class buffer
C        ILEN   - length of IBUF, chars 
      DIMENSION IREG(2) 
C               - registers from EXEC calls 
      DIMENSION IPARM(2)
C              - parameters from GTPARM 
C 
      EQUIVALENCE (REG,IREG(1)) 
      EQUIVALENCE (PARM,IPARM(1)) 
C 
C 
C 5.  INITIALIZED VARIABLES 
C 
      DATA ILEN/40/ 
C 
C 6.  PROGRAMMER: NRV 
C     LAST MODIFIED: CREATED  820323
C 
C 
C     1. Get the class buffer.  Messages for the OPRID consist of 
C     a series of LUs, separated by commas. 
C 
      ICLCM = IP(1) 
      IF (ICLCM.NE.0) GOTO 110
100   IERR = -1 
      GOTO 990
110   REG = EXEC(21,ICLCM,IBUF,-ILEN) 
      NCHAR = MIN0(IREG(2),ILEN)
      IEQ = ISCNC(IBUF,1,NCHAR,75B) 
C                   Scan for "="
      IF (IEQ.EQ.0.OR.ICHAR(IBUF,IEQ+1).EQ.77B) GOTO 500
C 
C 
C     2. Get the parameters from the command. 
C 
      ICH = IEQ+1 
      CALL GTPRM(IBUF,ICH,NCHAR,0,PARM,IERR)
C                   Scan for characters in operator's name
      IF (ICHAR(PARM,1).NE.54B) GOTO 210
      IERR = -101 
      GOTO 990
210   NCH = ICH-IEQ-2 
      IF (NCH.LE.12) GOTO 220 
      IERR = -201 
      GOTO 990
220   CALL IFILL(LOPRID,1,12,0) 
C                     Fill name with nulls
      CALL ICHMV(LOPRID,1,IBUF,IEQ+1,NCH) 
      IERR = 0
      GOTO 990
C 
C 
C     5. Display current ID.
C 
500   IF (IEQ.EQ.0) IEQ = NCHAR+1 
      NCH = ICHMV(IBUF,IEQ,2H/ ,1,1)
C                   Put / to indicate a response
      NCH = ICHMV(IBUF,NCH,LOPRID,1,12)-1 
C 
      ICLASS = 0
      CALL EXEC(20,0,IBUF,-NCH,2HFS,0,ICLASS) 
      IP(1) = ICLASS
      IP(2) = 1 
      IP(3) = 0 
      IP(4) = 2HQ&
      GOTO 999
C 
C 
990   IP(1) = 0 
      IP(2) = 0 
      IP(3) = IERR
      IP(4) = 2HQ&
999   RETURN
      END 
