FTN4,A
        FUNCTION IDLTV(LINA,KAL,LINB,KBL,KCOL,ILU,LLN,IMODE)
     .,C#870115:05:48 DISPLAY MIN UP DATE V=1.00# 
C 
C 
C               This routine compares the information in LINA and LINB  
C       and builds a display line for 264x using cursor positioning 
C       The length of the information to be written is IDLTV at 
C       completion of this routine.  A value of zero says there is
C       no change and nothing need be written.  Changed information 
C       is replaced in LINB as it is found. 
C 
        DIMENSION LINA(1),LINB(1) 
C 
C               INITIALIZE INTERNAL VARIABLES 
C 
        LAS=1 
        LAL=KAL 
        LBS=KCOL
        LBL=KBL 
        LCOL=KCOL 
C 
C               SET DEFAULT RETURN VALUE
C 
        IDLTV=KCOL+KAL-1
C 
30000   CONTINUE
C 
C               GET INITIAL LAS 
C 
        LAS0=LAS
C 
C               COMPUTE MAX COMPARE LENGTH
C 
        ICMP=MIN0(LAL-LAS,LBL-LBS)+1
C 
C               COMPARE STRINGS 
C 
        IMC=IABS(ICHCM(LINA,LAS,LINB,LBS,ICMP)) 
C 
D       WRITE(1,3001)LAS,LAL,LBS,LBL,ICMP,IMC 
D3001   FORMAT("IDLTV: LAS= ",I3," LAL= ",I3," LBS= ",I3," LBL= ",I3, 
D    . " ICMP= ",I3," IMC= ",I3)
C 
C               FOR  NO CHANGE EXIT NOW 
C 
        IF(IMC .EQ. 0)GO TO 90000 
C 
C               CALCULATE MAXIMUM COLUMN SHIFT TO CHANGE
C 
        IDCOL=IMC-LAS 
C 
C               CALCULATE NEW LBS 
C 
        LBS=LBS+IDCOL 
C 
C               UPDATE LAS
C 
        LAS=IMC 
C 
C 
C               SCAN FOR RESUMPTION OF MATCH IN STRINGS 
C 
        LRMC=ISRMC(LINA,LAS,LAL,LINB,LBS,LBL) 
C 
C               FOR NO NEW MATCH USE REST OF STRING 
C 
        IF(LRMC .EQ. 0)LRMC=LAL+1 
C 
C               GET MOVE COUNT
C 
        LMV=LRMC-LAS
C 
C               MOVE UNMATCHED INFO INTO LINB NOW 
C 
        LBS=ICHMV(LINB,LBS,LINA,LAS,LMV)
C 
C               SHIFT INFO FOR OUTPUT IF NEEDED 
C 
        IF(LAS .NE. 1)CALL ICHMV(LINA,1,LINA,LAS,LMV) 
C 
C               FIND NEW COLUMN POSITION
C 
        LCOL=LCOL+IDCOL 
C 
C               CORRECT DISPLAY WITH NEW INFORMATION
C 
        CALL IVOUT(ILU,LINA,LMV,LLN,LCOL,IMODE) 
C 
C               COMPUTE NEW COLUMN POSITION 
C 
        LCOL=LCOL+LMV 
C 
C               GET NEW LOC IN LINA FOR MORE LOOPING
C 
        LAS=LRMC
C 
C               FOR MORE INFO LOOP BACK AND SCAN SOME MORE
C 
        IF(LAS .LT. LAL)GO TO 30000 
C 
90000   CONTINUE
C 
C               RETURN TO CALLER
D       WRITE(1,9001)IDLTV
D9001   FORMAT("IDLTV: IDLTV= ",I3) 
C 
        RETURN
        END 
        END$
