FTN4,X
C@FPDIS 
C 
      SUBROUTINE FPDIS(IP,IBUF,ILEN,NCHAR)
     .,FIVPT PARMS DISPLAY C#870115:04:57#
C 
C 1.1.   FPDIS gets data from common variables and displays them
C 
C 2.  FPDIS INTERFACE 
C 
C     INPUT VARIABLES:
C 
      DIMENSION IP(1),IBUF(1) 
C 
C     OUTPUT VARIABLES: 
C 
C        IP(1) - CLASS
C        IP(2) - # RECS 
C        IP(4) - who we are 
C 
C 2.2.   COMMON BLOCKS USED 
C 
      INCLUDE #FSCOM::FS
C 2.5.   SUBROUTINE INTERFACE:
C 
C     CALLING SUBROUTINES: FVPNT
C 
C     CALLED SUBROUTINES: character utilities 
C 
C 3.  LOCAL VARIABLES 
C 
C        NCH    - character counter 
C 
C 4.  CONSTANTS USED
C 
C 5.  INITIALIZED VARIABLES 
C 
C 
C 6.  PROGRAMMER: MWH 
C     CREATED: 840510 
C# LAST COMPC'ED  870115:04:57 #
C 
C     PROGRAM STRUCTURE 
C 
C     1. First set up output buffer for response. 
C 
C 
D     WRITE(LU,9002)
D9002 FORMAT("ENTERING FPDIS")
      NCH = ISCNC(IBUF,1,NCHAR,75B) 
C                  Scan for "=" 
      IF (NCH.EQ.0) NCH = NCHAR+1 
C                  If no "=" found position after last character
      NCH = ICHMV(IBUF,NCH,2H/ ,1,1)  
C              Put / to indicate a response 
C 
C 
C     2.  Fill the buffer with the required common variables
C 
200   IERR = 0
D     WRITE(LU,9001)LAXFP,LDEVFP,CALFP,NREPFP,NPTSFP,FREQFP,INTPFP, 
D    .STEPFP,ANGLFP,DIAMAN
D9001 FORMAT("AX,DEV,CAL,NREP,NPTS,FREQ,INTP,STEP,ANGL,DIAM = "/
D    .2A2,1X,A2,F7.1,2I5,F7.1,I5,3F7.1) 
      NCH = ICHMV(IBUF,NCH,LAXFP,1,4) 
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IB2AS(NREPFP,IBUF,NCH,100002B)
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IB2AS(NPTSFP,IBUF,NCH,100002B)
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IR2AS(STEPFP,IBUF,NCH,6,2)
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IB2AS(INTPFP,IBUF,NCH,100002B)
      NCH = MCOMA(IBUF,NCH) 
      NCH = ICHMV(IBUF,NCH,LDEVFP,1,2)
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IR2AS(CALFP,IBUF,NCH,6,1) 
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IR2AS(FREQFP,IBUF,NCH,6,2)
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IR2AS(DIAMAN,IBUF,NCH,6,2)
C 
C     5. Now send the buffer to SAM and schedule PPT. 
C 
500   ICLASS = 0
      NCH = NCH - 1 
      CALL EXEC(20,0,IBUF,-NCH,2HFS,0,ICLASS) 
C                   Send buffer starting with info to display 
      IP(1) = ICLASS
      IP(2) = 1 
      IP(4) = 2HQZ
990   RETURN
      END 
