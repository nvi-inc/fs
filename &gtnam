FTN4,X
C@GTNAM 
C 
      SUBROUTINE GTNAM(IAS,IFC,IEC,LNAMES,NNAMES,LPROC1,NPROC1, 
     .LPROC2,NPROC2,IERR,ITYPE, 
     .           INDEX),CHECK FOR LEGAL NAME C#870115:04:20#
C 
C     GTNAM returns the index of the given word in one of 3 
C              lists, and which list. 
C 
C     INPUT VARIABLES:
C 
      DIMENSION IAS(1)
C               - input character string
C        IFC,IEC- first, end characters in input string IAS 
C                 Word to be checked lies here. 
      DIMENSION LNAMES(5,1),LPROC1(5,1),LPROC2(5,1) 
C               - 3 lists to be checked for the word
C               - word to be checked is word (1,I) in each array
C        NNAMES - number of entries in LNAMES 
C        NPROC1,2 - number of entries in LPROC1,2 (may be zero) 
C 
C     OUTPUT VARIABLES: 
C 
C        IERR   - error return.  0=all ok 
C        ITYPE  - which list word was found in, F (names) or
C                 P (procedure list1) or Q (procedure list 2) 
C        INDEX  - index of word in above list 
C 
C     CALLING SUBROUTINES: SPARS, GETCM 
C     CALLED SUBROUTINES: IHASH 
C 
C   LOCAL VARIABLES 
C 
C        ICODE  - returned from hashing routine 
C        NCHAR  - number of characters in word
C 
C 
C 
C     1. First hash up the word.
C 
      NCHAR = IEC-IFC+1 
      IF (NCHAR.LE.12) GOTO 110 
      IERR = -3 
      GOTO 999
C 
110   ICODE = IHASH(IAS,IFC,NCHAR)
C 
C 
C     2. Now search the first list. 
C 
200   DO 290 I=1,NNAMES 
        IF (LNAMES(1,I).NE.ICODE) GOTO 290
        ITYPE = 106B
        INDEX = I 
        GOTO 999
290     CONTINUE
C 
C 
C     3.  No match found in first list. 
C         Search the first procedure list.
C 
      IF (NPROC1.LE.0) GOTO 400 
      DO 390 I=1,NPROC1 
        IF (LPROC1(1,I).NE.ICODE) GOTO 390
        ITYPE = 120B
        INDEX = I 
        GOTO 999
390     CONTINUE
C 
C 
C     4. No match on the second list.  Try for the third. 
C 
400   IF (NPROC2.LE.0) GOTO 900 
      DO 490 I=1,NPROC2 
        IF (LPROC2(1,I).NE.ICODE) GOTO 490
        ITYPE = 121B
        INDEX = I 
        GOTO 999
490     CONTINUE
C 
C 
C     9. No match was found in any of the lists.
C 
900   IERR = -4 
C 
999   RETURN
      END 
