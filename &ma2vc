FTN4,X
C@MA2VC 
      SUBROUTINE MA2VC(IBUF1,IBUF2,LFREQ,IBW,ITP,IATU,IATL,IREM,ILOK, 
     .     TPWR,IAL),CONVERT MAT BUFFER TO VC DATA C#890516:19:02#
C 
C     This routine converts the buffers returned from the MAT 
C     into the video converter indices, frequency, and total power. 
C 
C  INPUT: 
C 
      DIMENSION IBUF1(1),IBUF2(1) 
C      - buffers of length 5 words, as returned from MATCN
C 
C  OUTPUT:
C 
      DIMENSION LFREQ(3)
C      - frequency, ASCII characters in format fff.ff (MHz) 
C     IBW - bandwidth code
C     ITP - TPI selection code
C     IATU, IATL - upper, lower attenuator settings 
C     IREM - remote/local code
C     ILOK - lock/unlock code 
C     TPWR - total power, binary
C     IAL  - alarm
C 
C 
C     Buffers from MATCN look like: 
C     for ! data:   Vntabfffff
C     for % data:   Vn----pppp (total power word) 
C     Note we are only concerned with the last 8 characters 
C 
      CALL ICHMV(LFREQ,1,IBUF1,6,3) 
      CALL ICHMV(LFREQ,4,2H. ,1,1)
      CALL ICHMV(LFREQ,5,IBUF1,9,2) 
      IBW = IA2HX(IBUF1,5)
      ITP = IAND(IA2HX(IBUF1,3),7)
      IA = IA2HX(IBUF1,4) 
      IATU = 10*IAND(IA,2)/2
      IATL = 10*IAND(IA,1)
      IREM = IAND(IA2HX(IBUF1,3),8)/8 
      ILOK = IAND(IA,8)/8 
      TPWR = 0.0
      DO 410 I=1,4
        TPWR = TPWR + IA2HX(IBUF2,6+I)*(16.0**(4-I))
410     CONTINUE
      IAL = IAND(IA,4)/4
      RETURN
      END 
