FTN4,X
C@WVHOR 
      SUBROUTINE WVHOR(AZ,EL) 
C 
C     WVHOR adjusts the input az and el so as to account for a
C     horizon mask at this station. 
C 
C  MODIFICATIONS: 
C 
C  830908 NRV Check for plunged elevations  
C 
C 
      INCLUDE #FSCOM::FS
C 
C  INPUT: 
C 
C     AZ,EL - the commanded az,el 
C 
C  OUTPUT:
C 
C     AZ,EL - adjusted az,el to conform to the horizon
C 
C 
C  LOCAL: 
C 
C     ELT - temp. elevation 
C 
C 
C 
C     1. This should not be too difficult.
C     Go through each of the stored az,el pairs and check for the 
C     az in the range between one az and the next one.  If it is, 
C     then set the el to the max of the stored el and the commanded el. 
C 
      ELT = EL
      IF (EL.GT.90.) ELT = 180.0-EL 
C                       First, adjust elevation to remove plunge. 
C 
      DO 190 I=1,NHORWV-1 
        IF (AZ.GT.AZHMWV(I).AND.AZ.LE.AZHMWV(I+1))
     .      ELT=AMAX1(ELT,ELHMWV(I))
190     CONTINUE
C 
      IF (EL.GT.90.) EL = 180.0 - ELT 
      IF (EL.LE.90.) EL = ELT 
C 
900   RETURN
      END 
