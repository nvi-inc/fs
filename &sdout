FTN4,X
        SUBROUTINE SDOUT(LU,IERR,LWHO,NWHAT,IBUF,NBUF)
C 
C               THIS ROUTINE DOES A SHORT MESSAGE TO THE USER WHEN
C       DDOUT CAN NOT BE USED.
C 
C       LU      - THE LOGICAL UNIT ON WHICH TO WRITE THE MESSAGE
C 
C       IERR    - THE ERROR NUMBER TO BE IN THE MESSAGE (VIA LOGEN) 
C 
C       IBUFF   - THE MESSAGE TO BE APPENDED AFTER THE LOGEN MESSAGE
C 
C       NBUF    - THE LENGTH OF THE MESSAGE TO BE APPENDED AFTER THE LOGEN
C                 MESSAGE 
C 
        DIMENSION IBUF(1),ITBUF(40) 
C 
C               GET THE NUMBER OF INPUT PARAMETERS
C 
        NPS=IGNPS(NPS)
C 
C               SET LWHAT TO ZERO 
C 
        LWHAT=0 
C 
C               IF IWHAT PRESENT MOVE TO LWHAT
C 
        IF(NPS .GE. 4)LWHAT=NWHAT 
C 
C               GET THE STANDARD ERROR MESSAGE
C 
        CALL LOGEN(ITBUF,NCHAR,0,0,0,1,IERR,LWHO,LWHAT) 
C 
C               CHECK FOR ADDITIONAL INFORMATION
C 
        IF(NPS .LT. 6 .OR. NBUF .EQ. 0)GO TO 40000
C 
C               MOVE IN ADDITIONAL INFORMATION
C 
        NCHAR=ICHMV(ITBUF,NCHAR+1,IBUF,1,NBUF)-1
C 
40000   CONTINUE
C 
C               WRITE THE MESSAGE TO THE GIVEN LU 
C 
        CALL EXEC(2,LU,ITBUF,-NCHAR)
C 
C               RETURN TO CALLER
C 
        RETURN
        END 
        END$
