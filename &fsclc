FTN4,X
        INTEGER FUNCTION FSCLC(ID)
     .,C#870328:18:46    FIELD SYSTEM CLASS CLEAR V=1.0#
        DIMENSION IREG(2) 
        EQUIVALENCE (REG,IREG(1),IRGA),(IREG(2),IGRB) 
C 
C               INITIALIZE VARIABLES
C 
        FSCLC=0 
C 
C               GET THE STARTING OF CLASS TABLE AND NUMBER OF ENTRIES 
C 
        CALL GETCL(ICLAD,INUMB) 
C 
C               LOOP OVER ALL CLASSES 
C 
        DO 10000 I=1,INUMB
C 
C               RESET LOOP COUNTER
C 
        ILOP=0
C 
C               GET CLASS ENTRY ADDRESS 
C 
        IAD=ICLAD+I 
C 
C               GET THE ENTRY FOR THIS CLASS NUMBER 
C 
        ICLAS=IXGET(IAD)
C 
C               DECIDE STATUS OF CLASS NUMBER ENTRY 
C                       <0 ENTRIES PRESENT THIS IS CLASS NUMBER AND SEC 
C                       =0 NO ENTRIES THIS CLASS NUMBER 
C                       >0 ENTRIES THIS IS A LINK POINTER 
C 
C               TEST IF ANYTHING PRESENT
C 
        IF(ICLAS .LE. 0)GO TO 10000 
C 
1000    CONTINUE
C 
        IF(ICLAS)5000,10000,2000
C 
2000    CONTINUE
C 
C               INCREMENT LOOP COUNTER TO PREVENT HANG UPS
C 
        ILOP=ILOP+1 
C 
C               IF TOO BIG QUIT WITH THIS CLASS NUMBER
C 
        IF(ILOP .GT. 10)GO TO 10000 
C 
C               STEP THROUGH THE CHAIN
C 
        IAD=ICLAS 
C 
        ICLAS=IXGET(IAD)
C 
C               CONTINUE SEARCH 
C 
        GO TO 1000
C 
5000    CONTINUE
C 
C               GET CLASS NUMBER AND TAKE CONTROL OF CLASS
C 
        ICLN=IOR(IAND(ICLAS,17400B),I)
C 
C               GET THE FIRST ENTRY IN CLASS FOR ID CHECK 
C 
        REG=EXEC(21,IOR(ICLN,160000B),IBUFF,-2,IR1,IR2,IR3) 
C 
C               IF NO DATA LEAVE ALONE GO TO NEXT ENTRY 
C 
        IF(IRGA .LT. 0)GO TO 10000
C 
C               IF ID DOES NOT MATCH GO TO NEXT ENTRY 
C 
        IF(IR1 .NE. ID)GO TO 10000
C 
C               SET CLASS NUMBER TO EMPTY BUFFERS NO WAIT SAVE CLASS #
C 
        ICLN=IOR(ICLN,120000B)
C 
8000    CONTINUE
C 
C               READ OUT THE BUFFERS UNTIL EMPTY
C 
        REG=EXEC(21,ICLN,IBUFF,-2,IR1,IR2,IR3)
C 
C               IF NOT EMPTY LAST TIME TRY AGAIN UNTIL IT IS
C 
        IF(IRGA .GT. 0)GO TO 8000 
C 
C               SET CLASS NUMBER FOR RELEASE NO WAIT
C 
        ICLN=IAND(ICLN,117777B) 
C 
C               DEALLOCATE THE CLASS # NOW
C 
        CALL EXEC(21,ICLN,IBUFF,-2,IR1,IR2,IR3) 
C 
C               COUNT CLASSES CLEARED 
C 
        FSCLC=FSCLC+1 
C 
10000   CONTINUE
C 
C               ALL CLASS ARE NOW CLEAR RETURN
C 
        RETURN
C 
        END 
        END$
