FTN4,X
C@WVWVR 
C 
      SUBROUTINE WVWVR(IP),WVR TANT AND PATH DELAY C#870115:04:46#
C 
C     WVWVR calculates antenna temperatures in both channels and
C     computes a nominal value for the path delay.
C 
C   INPUT VARIABLES:
C 
      DIMENSION IP(1) 
C             -Parameters from QUIKR
C      IP(1)  -Class number of input buffer 
C      IP(2-5)-Not used 
C 
C   OUTPUT VARIABLES: 
C 
C      IP(1) - Class number 
C      IP(2) - Number of records
C      IP(3) - Error number 
C      IP(4) - Who we are 
C 
C   COMMON BLOCKS USED
C 
      INCLUDE #FSCOM::FS
C 
C   SUBROUTINE INTERFACE
C 
C   CALLING SUBROUTINE: QUIKR 
C   CALLED SUBROUTINES: Character string utilities
C                       WVTBR - compute brightness temps  
C 
C   LOCAL VARIABLES 
C 
      DIMENSION IBUF(40)
C               - input class buffer and output display buffer
C       ILEN    - length of buffer, chars 
C       NCH     - character counter 
      DIMENSION IREG(2) 
C               - Registers from EXEC calls 
      EQUIVALENCE (REG,IREG(1)) 
C 
C   INITIALIZED VARIABLES 
C 
      DATA ILEN/80/ 
C 
C   PROGRAMMER nrv
C     LAST MODIFIED: 820525 NRV 
C 
C 
C     1. WVWVR is a monitor only request. An
C     equal sign or any other parameters following the command will 
C     be bitterly complained about. 
C 
      ICLCM=IP(1) 
      IF(ICLCM.NE.0)GO TO 100 
      IERR=-1 
      GO TO 990 
  100 REG= EXEC(21,ICLCM,IBUF,-ILEN)    
C                   Get command buffer
      NCHAR = MIN0(IREG(2),ILEN)
      NCH = ISCNC(IBUF,1,NCHAR,75B) 
C                   Scan for "="
      IF (NCH.EQ.0) GOTO 500
      IERR=-201 
      GOTO 990
C 
C 
C     5. Set up the first part of the response. 
C     Compute the antenna temp and the path.
C     Add each value to the response. 
C 
500   NCH = NCHAR+1 
C                   Position after last character in command
      NCH = ICHMV(IBUF,NCH,2H/ ,1,1)  
C                   Put / to indicate a response
      CALL WVTBR  
C 
      PATHWV = -0.11 + 0.22*(2.236*TANTWV(1)-TANTWV(2)) 
C 
      NCH = NCH + IR2AS(TANTWV(1),IBUF,NCH,5,1) 
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IR2AS(TANTWV(2),IBUF,NCH,5,1) 
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IR2AS(PATHWV,IBUF,NCH,5,1)  
      NCH = MCOMA(IBUF,NCH) 
      NCH = NCH + IR2AS(PATHWV*SIN(ELEVWV*PI/180.),IBUF,NCH,5,1)
      NCH = MCOMA(IBUF,NCH) 
      CALL WET(ALAT,HEIGHT,PI/2,TEMPWX,PRESWX,HUMIWX/100.0, 
     .WETD) 
C                   Get wet atmosphere at zenith
      NCH = NCH + IR2AS(WETD,IBUF,NCH,5,1)
      NCH = NCH - 1 
C 
      ICLASS = 0
      NREC = 1
      CALL EXEC(20,0,IBUF,-NCH,2HFS,0,ICLASS) 
      IERR = 0
C 
      IP(1)=ICLASS
      IP(2)=NREC
      IP(3)=IERR
      IP(4)=2HQW
      IP(5)=0 
C 
990   RETURN
      END 
