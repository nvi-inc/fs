FTN4X 
      SUBROUTINE HLPEM (INDEX,IDUM,LUOP) ,Stand-alone version for VTAPE 
C     This routine is a stand-alone version of the correlator VHELP facility
C     designed for use with VTAPE on other systems.   RJC 850725
C 
C     INDEX index # for "VTAPE help information access
C     IDUM  unused parameter left for compatibility with official SR HLPEM
C     LUOP  lu to which retrieved lines are written.
C 
      LOGICAL EQUAL,NOTYET
      INTEGER*2 IVTAPE(6),LINE(40)
      EQUIVALENCE (NERROR,IVTAPE(5))  !to keep the ENCODE happy 
      DATA IVTAPE /'""VTAPE nn  '/  
C 
C 
      LINE(1)=0 
      NOTYET=.TRUE. 
      ENCODE (2,101,NERROR) INDEX 
C     Must shift if only one digit. 
      IF (INDEX .LT. 10) CALL CMOVE (IVTAPE,10,IVTAPE,9,2)  
C 
      OPEN (10,FILE='"VTAPE::FS',ERR=90,IOSTAT=IOS)   
C 
      DO 50 IJKLMN=1,32767  !infinite line-reading loop 
          IF (NOTYET .AND. .NOT.EQUAL (LINE,1,IVTAPE,1,10)) THEN  
C             Read up to beginning of section.  
              READ (10,102,END=99,ERR=90,IOSTAT=IOS) LINE     
          ELSE  !we're into writable section
              NOTYET=.FALSE.
              READ (10,102,END=99,ERR=90,IOSTAT=IOS) LINE     
              IF (EQUAL (LINE,1,IVTAPE,1,8)) GOTO 99 !end of section  
C 
              NWORDS=(ITLOG()+1)/2
              WRITE (LUOP,102) (LINE (N),N=1,NWORDS)  
          ENDIF 
 50       CONTINUE
C 
 90   WRITE (LUOP,'("Error code",I4," reading the ""VTAPE FILE")') IOS
 99   CLOSE (10)
      RETURN
C 
 101  FORMAT (I2) 
 102  FORMAT (40A2) 
      END 
