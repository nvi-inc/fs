FTN4,X
C@OPRIN 
C 
        PROGRAM OPRIN(3,99),C#870115:04:06    RTE-IV VER=2# 
C 
C     OPRIN 
C 
C 1.  NAME PROGRAM SPECIFICATION
C 
C 1.1.   OPRIN
C 
C               THE OPERATOR INPUT CONTROL PROGRAM FOR THE MANAGING OF
C       THE FIELD SYSTEM SOFTWARE.  THID ROUTINE ALSO RESPONDS TO 
C       CONTROL SEQUENCES INPUT BY THE OPERATOR WHERE SUPPORTED BY THE
C       DRIVER. 
C 
C 1.2.   RESTRICTIONS - limits on use of routine
C 
C 1.3.   REFERENCES - document cited
C 
C 2.  NAME INTERFACE
C 
C 2.1.   CALLING SEQUENCE: RU,OPRIN,LU,P2,P3,P4,P5
C 
C     INPUT VARIABLES:
C 
C       GLOBAL DEFS REFERENCED: "name'(local name if different)' ...
C 
C       LU      - THE LOGICAL UNIT TO INITIALIZE OPRIN FOR /
C                 THE CONTROL INFORMATION FROM THE DRIVER FOR A CNTRL 
C                 FUNCTION
C 
C       P2 - P5 - INPUT CONTROL PARAMETERS FOR BOSS / ADDITIONAL CNTRL
C                 FUNTION INPUT(SEE RELAVANT DRIVER FOR DETAILS)
C 
C     OUTPUT VARIABLES: 
C 
C       GLOBAL DEFS REFERENCED: "name'(local name if different)' ...
C 
C 2.2.   COMMON BLOCKS USED 
C 
      INCLUDE #FSCOM::FS
C 
C 2.3.   DATA BASE ACCESSES 
C 
C 2.4.   EXTERNAL INPUT/OUTPUT
C 
C 2.5.   SUBROUTINE INTERFACE:
C 
C     CALLING SUBROUTINES: none 
C 
C     CALLED SUBROUTINES: INOPR, RUOPR
C 
C 3.  LOCAL VARIABLES 
C 
C       GLOBAL DEFS REFERENCED: "name'(local name if different)' ...
C 
      DIMENSION NAMEC(32,20),NAMEI(14,15),NAMUS(3),MCNTL(13),NCNTL(9) 
        DIMENSION IBUF(60)
C 
C       NAMEC   - PROGRAMS ACTIVATED BY CNTRL-CHARACTER BY OPERATOR 
C                 THE FOLLOWING INFORMATION IS IN THIS LIST;
C 
C               NAMEC(1-3,IX)   - ASCII NAME OF PROGRAM TO BE ACTIVATED 
C 
C               NAMEC(4,IX)     - PARTITION TO RUN PROGRAM IN 
C 
C               NAMEC(5,IX)     - PARTITION SIZE FOR RUNNING PROGRAM
C 
C               NAMEC(6-10,IX)  - DEFAULT PARAMETERS P1-P5 FOR PROGRAM
C 
C               NAMEC(11,IX)    - NUMBER OF DEFAULT PARAMETERS DEFINED
C 
C               NAMEC(12,IX)    - NUMBER OF COMMENT CHARARACTERS PRESENT
C 
C               NAMEC(13-32,IX) - COMMENT FOR USER 40 CHARACTERS MAX 
C 
C       NAMEI   - INITIALIZATION LIST FOR OPRIN OF PROGRAMS IT MUST 
C                 GET A FRESH COPY OF FOR THIS RUNNING OF THE FIELD SYSTEM. 
C                 THE INFORMATION IN THIS LIST IS AS FOLLOWS: 
C 
C               NAMEI(1-3,IX)   - ASCII NAME OF PROGRAM TO BE INITIALIZED 
C 
C               NAMEI(4,IX)     - SIZE OF PARTITION TO USE WHEN RUNNING(RTE-M)
C 
C               NAMEI(5,IX)     - PARTITION TO USE FOR RUNNING THIS PROGRAM 
C                                 (RTE-M). 0 IMPLIES LOAD INTO SYSTEM.
C 
C               NAMEI(6,IX)     - PRIORITY TO BE SET TO IF NOT=0
C 
C               NAMEI(7,IX)     - =IO1*400B+ISOP
C 
C                       IO1     - THE OFFING OPTION PRIOR TO START UP 
C                                 THIS SHOULD BE 0,1,2,8.  SEE HP SYSTEM
C 
C                       ISOP    - THE OPRIN INTERFACE EXEC OPTION 
C                                 THIS SHOULD BE 9,10,23, OR 24.
C                                 SEE HP EXEC CALLS OF THESE NUMBERS
C 
C               NAMEI(8,IX)     - =ISP*400+IIST+IOOP
C 
C                       ISP     - SPECIAL PROGRAM DESIGNATION WILL
C                                 MAKE CROSS REFERENCE IN NCNTL WHEN
C                                 NOT EQUAL TO 0. 
C                                       0 - NO SPECIAL FUNCTION 
C                                       1 - SEGMENT 
C                                       2 - FS MANAGER
C                                       3 - CHECKING MANAGER
C                                       4 - LOG SYSTEM MANAGER
C                                       5 - ASSIST LOG SYSTEM MANAGER 
C                                       10-15 - USER OPTIONS
C 
C                       IIST    - INITIAL STATUS OF PROGRAM AFTER INITIAL 
C                                 OFF IF REQUESTED.  0 - NOT PRESENT ORIGINALLY 
C                                 1 - PRESENT INIALLY(LEAVE UNLESS OFF
C                                 REQUESTED AT TERMINATION) 
C 
C                       IOOP    - OFFING OPTION AT COMPLETION 
C                                 VALUES SHOULD BE 0,1,2,8
C                                 NOTE 0 IMPLIOES NO ACTION 
C 
C               NAMEI(9-13,IX)  - INPUT PARAMETERS TO CALLING PROGRAM 
C                                 IF OPRIN INPUT REQUESTED IT WILL HAVE 
C                                 BEEN SUBSTITUTED HERE FROM IP.
C 
C               NAMEI(14,IX)    - THE NUMBER OF PARAMETERS TO BE PASSED 
C                                 TO THE CALLED PROGRAM, FROM (FSPGM LIST.
C 
C       MCNTL   - BRANCH CONTROL ARRAY
C 
C       IBUF   - BUFFER FOR GENERAL USE 
C 
        DIMENSION IP(11)
C 
C       IP      - INPUT PARAMETERS OBTAINED THROUGH RMPAR 
C 
C       NAMUS   - OUR NAME FROM IDSEG 
C 
C 4.  CONSTANTS USED
C 
        DATA MCNTL/57117B,50440B/ 
C                   ^  ^   ^  ^ 
C                   ^  O   Q  NULL
C 
C       MCNTL   - SET FOR MONITOR ON AND OFF
C 
        DATA NCNTL/0,0,4,15/
C 
C       NCNTL(1)        - NUMBER OF ENTRIES USED IN MCNTL 
C 
C       NCNTL(2)        - NUMBER OF CHARCTERS SET UP HERE 
C 
C       NCNTL(3)        - FIRST USER ENTRY IN MCNTL 
C 
C       NCNTL(4)        - MAXIMUM NUMBER OF NAMEI ENTRIES ALLOWED 
C 
C       NCNTL(5)        - NUMBER OF NAMEI'S READ IN 
C 
C       NCNTL(6)        - LAST FIELD SYSTEM MANAGER FOUND (nominally BOSS)
C 
C       NCNTL(7)        - LAST CHECKING SYSTEM MANAGER FOUND (CHEKR)
C 
C       NCNTL(8)        - LAST OUTPUT MANAGER FOUND (NOMINALLY DDOUT) 
C 
C       NCNTL(9)        - LAST ASSIST OUTPUT MANAGER FOUND( 'CLOUT')
C 
C 5.  INITIALIZED VARIABLES 
C 
C 6.  PROGRAMMER: LEE N. FOSTER 
C     LAST MODIFIED:
C# LAST COMPC'ED  870115:04:06urrent date) #
C 
C     PROGRAM STRUCTURE 
C 
C               6.1  INITIALIZE VARIABLES 
C 
        CALL RMPAR(IP)
C 
        LU=1
C 
        IF(IP(1) .NE. 0)LU=IP(1)
C 
C               SET OFFING FOR SELF TERMINATION 
C 
        NOFST=4 
C 
C               SET IERR TO ZERO
C 
        IERR=0
C 
C               RESET ICLBOX (in case of trouble before BOSS) 
C 
        ICLBOX=0
C 
C               INITIALIZE THIS ROUTINE 
C 
        CALL RPLNK(1,6HOPINI ,1,8,NAMEI,NAMEC,IP,NAMUS, 
     .MCNTL,NCNTL,IERR,IBUF)
C 
C               TEST FOR ERROR RETURN FROM BOSS 
C 
        IF(IERR .LT. 0 .OR. IERR .EQ. 14) GO TO 90000 
C 
60000   CONTINUE
C 
C               NOW CYCLE AND RUN THIS ROUTINE UNTIL TOLD TO EXIT 
C 
      CALL RPLNK(2,6HOPRUN ,1,7,NAMEC,IP,NAMUS,MCNTL,NCNTL,IBUF,NAMEI)
C 
90000   CONTINUE
C 
C               NOW EXIT - RETURN OCCURS ONLY IF BOSS TERMINATES
C 
      CALL RPLNK(3,6HOPTER ,1,7,NAMEC,IP,NAMUS,MCNTL,NCNTL,IBUF,NAMEI)
C 
C               REMOVE OPTER SEGMENT NOW
C 
        CALL RPLNK(0,0.0D0) 
C 
C               TERMINATE AND REMOVE FROM TIME LIST 
C 
        CALL EXEC(6,0,2)
C 
        END 
        END$
