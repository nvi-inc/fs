File: /usr2/fs-9.6.1/misc/fs9601up.txt  Version: 1.7 Date: 030508

I. Introduction

This memo is divided into 4 sections:
   I.   Introduction.
   II.  Changes Since Version 9.5.12
   III. Installation
   IV.  Transferring The Update Archive By DOS Floppy

Please print this notice and read it carefully before installing the
new version. This version contains a preliminary version of several
new tools for antenna gain and system temperature calibration. This
version is intended for all stations except those using stations
detectors and/or special S2 DAS version of the FS. If you have any
questions about whether is applies to you, please contact Ed.

This version is intended to installed as an update for 9.5.12 and is
relatively easy to do in this case.

II. Changes Since Version 9.5.12

The sections is divided into three sub-sections: A. Change in the FS,
B. Changes in DRUDG, and C. Known Bugs. Each sub-section starts with a
summary of the items covered followed by a more detailed description.

			 A. Changes in the FS

The following is a summary of the changes. Itemsn umbered 6 and above
were added after 9.5.13. Items numbered 11 and above were added after
9.5.15. More detailed text follows the summary.

1. The Mark 5 data_check command protects against negative read
   pointers.
2. logpl now supports plotting channel 1 versus channel 2
3. tacd updated for new TAC32+ software
4. fsvue enhancements
5. VEX library update
6. Change in Tsys calculations and other associated changes for Mark
   III/IV and VLBA/4.
7. New ONOFF program
8. New program gnplt for analyzing antenna gain.
9. New control files *.rxg for receiver gain/Tcal data
10. New flux.ctl control file
11. New point.prc library and vpoint.prc has been removed.
12. Australian LBA Data Acquisition System support
13. Fsvue patched to allow compilation on FS Linux 1
14. Monit2 display for S2 drive combination fixed
15. Minor error message corrections
16. The source command will now accept a wider range of azimuths.
17. In the source command standard notation now accepts 100s of
    degrees.
18. The named semaphore utility function "nsem_find()" is no longer
    declared static.
19. A bug in the calculation of the cal temperatures was fixed.
20. Several error recovery problems were fixed in the new ONOFF.
21. Support for the MET3 met. sensors has been added.
22. Several font bugs in fsvue and msg were fixed.
23. TAC support has been improved.
24. ONOFF has been improved.
25. GNPLT and GNDAT have been improved.
26. Support for Mark 5A systems has been added.
27. vmk5 visual Mark 5 interface added.
28. New "exper_initi" experiment specific start-up procedure added.
29. Coding change: IPC keys are now generated by ftok().
30. IFADJUST more robust, set-up issues identified, Mk3 supported.

A more detailed discussion of these changes follows.

1. The Mark 5 data_check command protects against negative read
   pointers. The data_check command now verifies that setting the red
   pointer to one Megabyte less than the write pointer won't result in
   a negative pointer and reports an error if it does.

2. logpl now supports plotting channel 1 versus channel 2. logpl
   includes a new feature that allows channel 1 to be plotted against
   channel 2. This is available through the "Options" menu. If
   parameters for both channels appear on the same log line, the
   pairing of points is straightforward. If they appear on different
   lines, the algorithm is that the first entry encountered for
   channel 1 is paired with the first following entry for channel
   2. For subsequent points, the search begins with the next following
   channel 1 entry. If after a channel 1 entry is found no channel 2
   entry is found before the next encountered channel 1 entry, the
   first channel 1 entry is discarded and the search continues to find
   a channel 2 entry for the second channel 1 entry. The "Options"
   menu also includes an option to switch to the plot axes. This
   allows the plot to have its axes reversed, without changing the
   search algorithm, i.e., the meaning of channel 1 and channel 2 for
   the search algorithm are not reversed. This is useful for example
   for two items that are sampled as a pair, such as phase-cal phase
   and amplitude, within a few seconds of each other, with a longer
   delay between pairs. Switching axes does not change the matching of
   the pairs, but only of which items is displayed on vertical axis.

3. tcad updated for new TAC32+ software. New code was introduced for
   reading TAC32+ code version and new TAC32+ formatting. It is
   recommended that all who are using the TAC32+ should update to
   version 2.7.0. This version of tacd is backward compatible with all
   TAC32+ software versions except 2.6.x.

4. fsvue enhancements. When examining logs the current log file will
   appear on the screen, and help for the TNX command was added.
   'fsvue' is coming along due to the help and comments from all in
   the field. Please continue to express what you would like to see
   'fsvue' do as your Friendly User Interface (FUI). If you have not
   tried fsvue please do so. All comments and/or questions are always
   welcomed (good or bad). rgonzale@gemini.gsfc.nasa.gov

5. VEX library update. A capability for writing vex files has been
   added to vex library. In addition there is now support for literal
   blocks and scan IDs.

6. Change in Tsys calculations and other associated changes for Mark
   III/IV and VLBA/4. The way Tsys calculationss are handled has been
   modified to distinguish between the TPI measurement used for the
   degree/count conversion (TPICAL-TPI in the denominator of the Tsys
   calculation) and the TPI measurement used to meaure the level of
   the signal above the detector zero (TPI-TPZERO in the numerator of
   the Tsys calculation). The TPICAL-TPI value is now set by executing
   the TPDIFF command, which calculates the difference based on the
   most recent TPI and TPICAL commands. The Tsys command uses the most
   recent TPI and TPDIFF values for its calculations. This makes the
   calculation more robust, if for example under the old scheme, the
   antenna is not on source during TPICAL during PREOB, but is during
   TPI in MIDOB. Now the TPI and TPICAL for TPDIFF can be measured
   together during PREOB so they are measured under the same
   conditions. Please see the TSYS command help page for more
   information.

   Further for VLBA/4 racks, a new command TPDIFFGAIN has been added
   to record the BBC gain level associated with TPDIFF and TPZERO. The
   TSYS command now takes the TPDIFFGAIN and TPGAIN (associated with
   the TPI command) gain level into account. Please see the TSYS
   command help page for more information.

   These changes and an attempt to unify calibration procedures for
   geodesy and astronomy has lead to new standard versions of PREOB,
   MIDOB, CALTSYS, and MIDTP. The change to PREOB is now to just use
   CALTSYS rather than a subset of CALTSYS commands. The reason this
   was not done before was to reduce the execution time of PREOB. If
   you find that the new approach causes PREOB to take more than the
   nominal 10 seconds, please contact us. MIDOB is changed so that it
   stands on its own as long valid measurements of TPZERO and TPDIFF
   (and TPGAIN and TPDIFFGAIN for VLBA/4) have been made earlier.
   CALTSYS incorporates the changes described in the previous two
   paragraphs. MIDTP has had TPZERO and associated IF attenuation
   manipulation commands removed. (In the future we may move TPZERO
   commands to the mode set-up procedures to speed-up CALTSYS). Please
   see the default versions of the changed procedures in new default
   procedure library for your equipment in /usr2/fs/st.default/proc
   for more information.

7. New ONOFF program. The ONOFF program has been completely
   re-written. It now will make meaurements for any subset of
   detectors in Mark III/IV and VLBA/4 racks. The new version does not
   yet support station defined detectors. Please see the ONOFF command
   help page for information on the new version of this command.

8. New program gnplt for analyzing antenna gain. A new program, gnplt,
   is being released with this version. It allows a user to analyze
   the output of the new ONOFF program to develop gain curves and Tcal
   versus frequency tables. The program was demonstrated at Medicina
   in September and many of the requests for changes made at hat time
   have been incorporated. Carl Holmstorm will shortly be producing a
   cookbook for how to operate the program. John Conway will be
   providing documentation on how it should be used.

9. New control files *.rxg for receiver gain/Tcal data. There are new
   control files for defining the degree per flux unit (DPFU, i.e.,
   gain) of the antenna/receiver as well as noise diode values as a
   function of frequency. These files must be set-up for each band you
   intend to use the FS with. The CALTEMPS procedure and CALTEMPx and
   BEAMx commands have been deleted. Please see the example control
   files x.rx and s.rxg in /usr2/fs/st.default/control for more
   information.

10. New flux.ctl control file. Source flux is now maintained in united
    control file for all bands. The FLUXx commands are now obsolete.

11. New point.prc library and vpoint.prc has been removed. The changes
    above have greatly simplified the point.prc library so that it is
    now band independent and nearly equipment independent. The only
    small equipment dependencies are the detector devices to be
    used. Consequently, the vpoint.prc library has been eliminated.

12. Australian LBA Data Acquisition System support. This includes a
    new "dscon" bus communication daemon for the ATNF dataset bus and
    a "monit4" display process which mimics the output of the original
    DOS control process.  Up to two DAS may be controlled
    simultaneously, with each being considered to consist of two
    independant IF processors or 'ifp's.  Although a prototype
    "trackform" commands is included, it merely documents the current
    S2 output possibilities, either with or without the so-called
    "kludge" cable.  Please see the file /usr2/fs/misc/lba/readme.txt
    for more information. Thanks to Jonathan Quick at HartRAO for this
    development.

    This includes the addition of more equipment bits to the
    "fscmd.ctl" and "stcmd.ctl" files, requiring a new misc/cmdctlfix4
    script to perform the updates automatically.  Minor improvements
    were also made to the old misc/cmdctlfix, misc/cmdctlfix2 and
    misc/cmdctlfix3.  Thanks to Jonathan Quick at HartRAO for this
    fix.

13. Fsvue patched to allow compilation on FS Linux 1. A spurious
    "#include<ncurses.h>" was removed from fsvue/vueinfo.c which was
    preventing compilation under FS Linux 1. Thanks to Jonathan Quick
    at HartRAO for this fix.

14. Monit2 display for S2 drive combination fixed.  An error which
    caused the S2 record group display to be overwritten by an errant
    MkIII/IV/VLBA formatter sampling rate was fixed. Thanks to
    Jonathan Quick at HartRAO for this fix.

15. Minor error message corrections.  Changes were made to some error
    messages from "chekr" and "quikr". Thanks to Jonathan Quick at
    HartRAO for this fix.

16. The source command now accept a wider range of azimuths. The
    source command will now accept degrees as arguments within the
    range +/- 10000 degrees. This change is mainly provided to allow
    azimuths (for source "azel") to specify more than one wrap of
    azimuth. Thanks to Andrey Mikhailov at Svetloe for reporting this
    problem.

17. In the source command standard notation now accepts 100s of
    degrees. The standard notation for angles (no suffixes) as used in
    the source command will now not ignore the hundreds digit of the
    angle when the value is to be interperated as being in
    degrees. This change primarily is to allow access to azimuths
    larger than 90 degrees with the standard notation. Thanks to
    Andrey Mikhailov at Svetloe for reporting this problem.

18. The named semaphore utility function "nsem_find()" is no longer
    declared static. This is to allow programmers access to the
    corespoding numbered semaphore with the faster numbered sempahore
    utilities.

19. A bug in the calculation of the cal temperatures was fixed. The
    wrong cal temperature was returned when the tcal table for a
    polarization in the rxg file had only one point and it
    corresponded to the exact center of the detector
    bandpass. Previously in this case, the cal temp was returned as
    zero, now the correct value is returned. Thanks to Giuseppe
    Maccaferri at Medicina for reporting this problem.

20. Several error recovery problems were fixed in the new ONOFF. The
    error recovery procedure was not working correctly because any
    "break" that may have been hanging around was not being cleared
    first. This was fixed and the general handling of error recovery
    and the related error messages were improved. Thanks to Jonathan
    Quick for reporting these errors and sticking with them to help
    run the root cause.

21. Support for the MET3 met. sensors has been added. The MET3
    met. sensor and Vasiala wind sensor that are standard instruments
    for IGS sites are now supported. The basic support is provided as
    a server that runs independently of the FS. The FS interacts with
    this server to collect the data. A client, also independent of the
    FS, is also provided that will allow the met data to be collected
    and log offline. The source code and instructions for installation
    for both the server and client can be found in
    /usr2/fs/st.default/st-0.0.0/metserver and
    /usr2/fs/st.default/st-0.0.0/metclient respectively.

22. Several font bugs in fsvue and msg were fixed. Several problems
    with the fonts in these programs, for most part benign except
    under old Linux kernels such as FS Linux 2 were fixed. Thanks to
    Andrey Mikhailov at Svetloe for reporting these problems.

    fsvue now has the ability to select fonts. These options are
    available when starting fsvue:

      fsvue - will give you the fonts it used last time.
      fsvue D - will give you the terminal default fonts.
      fsvue F - will give a selection box with the fonts available on
        your system. Once you've selected the font that you want,
        click on [Save for fsvue]. fsvue will continue to use your
        saved fonts until you change it. In other words everytime you
        type 'fsvue' at the prompt it will run with the fonts you've
        selected.

23. TAC support has been improved. It has been simplified so that it
    no longer requires a daemon running in background to support
    it. Similar to the new support for the MET3 instruments, a station
    specific client, tacdclient, has been added to allow logging of
    Maser clock offsets off-line. No server is required for TAC
    support since the TAC32+ software is a server. The default client
    can be found in /usr2/fs/st.default/st-0.0.0/tacdclient.

24. ONOFF has been improved. Several bugs have been fixed. In
    particular there was some severe problems if the program was
    stopped with an "brk" before it had commanded the first
    offsets. In general the recovery after an error or "brk" has been
    improved greatly. The wait time for acquiring the first
    source is dependent on whether AQUIR is running as it had been in
    the original program.

25. GNPLT and GNDAT have been improved.

    Gnplt and gndat now works a lot better with 'range' LOs. 

    New features in gndat, the parsing program. It looks in your
    /usr2/control/ directory, and selects the .rxg files for the LOs
    in your log file. Gndat no longer needs the '/calrx/' line in the
    log file (However for now we are recommening that these still be
    included; a future update will clean-up several loose ends related
    to pointing including this one).  It also does not need the
    'onoff;' line in the log file. It simply uses the first APR record
    to start a new block of observation. This means that ONOFF can be
    started from a procedure and GNPLT/GNDAT will be able to find the
    data.

    There are shortcuts on the 'Edit' menu, for faster selection and
    plotting of Gain vs. Elevation, and TCal(K) vs. Frequency. For
    Gain vs. Elevation you select the polarization and detector you
    want, and gnplt will plot Gain vs. Elevation for that polarization
    and the calibrator sources. For TCal(K) vs. Frequency, you select
    what polarization and LO you want, and gnplt will plot TCal(K)
    vs. Frequency for that LO and polarization, also using the
    calibrator sources.

    For fitting Tcal vs. Frequency, you now have the option to either
    average TCal over all the selected times for each frequency, or
    simply taken the median TCal at each frequency. You can now also
    look at the fitting before updating the file.

    The highlighting of specific sources and frequencies now works a
    lot better, since you can select not only the frequency you want
    highlighted, but also the polarization for each frequency.

    All double clicks for editing have been removed, since they caused
    a lot of problems. You will find under the 'Help' menu what the
    new shortcuts are.

    If you click the right mouse button while the cursor is over a
    point, gnplt will draw a line between certain points depending on
    what x-axis you have selected. If you've selected frequency as
    your x-axis, gnplt will connect the points with the same time, the
    same source and the same polarization. If you have selected
    anything else as your x-axis, gnplt will connect the points with
    the same frequency, the same source and the same polarization.

    You can now edit larger groups of points with a single click. It
    works the same way as box zooming. By clicking the right button
    and drawing the box around points, you deselect the points within
    the box, as if you would have clicked on all of them. By using the
    middle button instead, you "click them back".

    You can now easily deselect all the points with a "bad" gain
    compression.  "Bad" is considered to be less than 0.95 or larger
    than 1.05 as default.  The button for doing this is under the
    'Edit' menu, and when you click it you will be able to select your
    own limits.

    If you want the plot to replot automatically when you select a
    different x- or y-axis, you can give the flag -r on the command
    line. You can also change this option after you've run the
    program. The button for this is also under the 'Edit'-menu.

    Under the 'File' menu there is a button, 'I/O setup' where you can
    change the names of the files that gnplt creates, if you for some
    reason want a different file name than the default one. All files
    that gnplt creates have the process id appended to its name. Thus
    you can run multiple sessions of gnplt on the same machine without
    the file names overlapping.

    A lot of bugs in the earlier version have been fixed. Especially
    the editing and the scaling works a lot better now.

    Some preliminary documentation is provided in the
    /usr2/fs/gnplt/almost_uptdate_docs directory. The manual.txt files
    is written by Carl Holmstrom and the gnplt.tex/.ps files by John
    Conway. The gnplt.ps file covers basic usage of the program for
    calibrating your antenna. The most significant thing that it is
    missing is the new "shortcut" selections on the main "Edit" menu
    drop-down box. These shortcuts can significantly reduce the work
    of setting up the plots. The resulting display can be then be
    customised with the other options in the "Edit", "X-axis", and
    "Y-axis" drop-down boxes. You might want to change the display
    mode to replot automatically. The gnplt.ps file did not display
    properly with the ghostscript included with FS Linux Kernel 4, but
    it did for a different version running under Windows. You may need
    to use a different computer to display this file.

26. Support for Mark 5A systems has been added. This support is
    preliminary. To enable this support, please select either "mk5a"
    or "mk5a_bs" for drive 1 in equip.ctl according to your
    equipment. For "mk5a", the FS assumes that either no bank
    management is necessary because either any recorded experiment
    will fit on one bank or the Mark 5A supports "automatic bank
    switching" so that it can change banks on its own when the
    currently in use bank becomes full. If "mk5a_bs" is selected, the
    FS will monitor how full the bank is and will automatically
    request the Mark 5A to change to the other bank bwteen scans. The
    "mk5a_bs" bank switching works only with DRUDG produced schedules.

    A new command had been added: "bank_check". This command will log
    the VSN of the disk pack in the bank currently being recorded if
    either it has not been logged since the current log ws last opened
    or it has changed since the last time it was logged. In addition
    if the selected drive is "mk5a_bs", this command will check the
    remaining record time available on the bank and if it is sufficent
    for the next scan will force a bank change before checking the
    VSN. The command used to force bank_changes "bank_set=inc" takes
    longer than one second to complete. If the time-out specified for
    the Mark 5 device is less than 2 seconds, it will automatically be
    increased to 2 seconds.

    The scan length is communicated to the FS as one of the new
    parameters in the scan_name command. The session code has also
    been added to this command.

    If the selected drive is "mk5a", the disc_end command will also
    check the VSN and log it if it has changed. This is intended to
    support "automatic bank switching" by the Mark 5A in cases were a
    scan may end up split between two disk packs.

    Regardless of which method of bank switching is used, it is
    necessary to have disk pack installed in the bank that is not
    being used before a bank change will be needed.

    Currently use of Mark 5 is selected when DRUDG is run to generate
    the .snp and .prc files for schedules that were originally
    designed for tape. There are no exclusively Mark 5 schedule files
    yet. Connection of a Mark 5 system to a formatter requires
    particular wiring. DRUDG outputs comments in the set-up procedures
    that describe the correct wrring for the configuration
    requested. These issues are discussed further in the section on
    Changes in DRUDG.
 
27. vmk5 visual Mark 5 interface added. Beppe Maccaferri at Medicina
    has written a Tcl/Tk client for the Mark 5. This should be useful
    for among other things monitoring how full the bank is. Please see
    "/usr2/fs/vmk5/Notes_about_visual_Mark5_interface.txt" for more
    information. Please be careful using this program since you can
    interfer with FS operation of the Mark 5 when you enter commands
    or queries.

28. New "exper_initi" experiment specific start-up procedure
    added. This is a new standard procedure, which is invoked in place
    of the "sched_initi" procedure that was used in previous FS
    versions. DRUDG creates this procedure in the experiment procedure
    library and includes a call to "sched_initi" in it. Thus the only
    change for users is that if they want to have an experiment
    specific start-up procedure, they would need to edit the
    "exper_initi" procedure in the experiment procedure library rather
    than create a "sched_initi" procedure. This new method allows
    DRUDG to insert commands that may be required depending on the
    equipment type, in particular Mark 5A. It also makes it easier to
    preserve a schedule non-specific set of action to be execute at
    each schedule start in the "sched_initi" procedure. Users should
    note that they should not modify anything in the exper_initi
    procedure except to add command and/or remove the call sched_initi
    (if desired).

29. Coding change: IPC keys are now generated by ftok(). The keys used
    by the FS to identify interprocess communication (IPC) resources
    were previously hard-coded. This was fine until a conflict over
    shared memory with a new X-server was discovered. The FS now uses
    the standard, but not necessarily unique method, of generating
    keys with ftok(). The FS assumes that it can use "/usr2/fs" as the
    pathname to identify its resources. If your station software uses
    any IPC keys, you should consider generating them with ftok(). The
    example files include/st_params.h, stlib/setup_st.c, and
    stalloc/stalloc.c in the /usr2/fs/st-0.0.0/ directory show how
    this might be done for the STM_KEY. Please see "man ftok" for more
    information on this function.

30. IFADJUST more robust, set-up issues identified, Mk3 supported.  A
    problem in IFADJUST that caused it to find different value (one
    incorrect) if it was run twice in a row with stable power levels
    was fixed. In addition it was discovered that there was a loose
    end in the definintion of the patching in default procedures and
    experiments procedures. For narrow X-band configuration at
    stations IF3 modules the patchings were incorrectly defined as
    have VCs 5-8 attached to IF1. This error caused the IFADJUST
    command to not work for narrow frequency sequences.  This was
    corrected a few months ago in the geodetic catalogs for the
    stations with IF3 modules.  However, it turned out that this
    change was premature becuase it was incompatible with how DRUDG
    worked to set-up the IF3. The result was that stations have had to
    edit the IF3 command to change the commanded mixer state to "out"
    for narrow band schedules.  Once this version of the FS is
    installed, this will no longer be necessary (this is discussed
    more under Changes in DRUDG). In addition the ifadjust command
    should work properly for frequency configurations.

    IFADJUST now also supports the old Mark III formatters. It will
    also workwith LBA4 racks.

			 B. Changes in DRUDG
				   
drudg opening message date is 030507. The following areas in DRUDG
were modified. Items numbered 3 and above are new since 9.5.13. Items
numbered 6 and above were added after 9.5.15.

1. Mk5 disk-only recording.
2. Geo/astro schedule recognition.
3. Option 5 footages fixed.
4. FASTx commands include fractional seconds.
5. Extra digit in RA.
6. Support for new LBA Data Acquisition System.
7. S2 support extended to support new LBA rack.
8. Loader procedure changed for long thin tapes.
9. Loopholes in headstack and track number closed.
10. Polarization included in LO command for geodetic schedules.
11. IF3 patching handled correctly.
12. Changes to header of summary files.
13. Mark5-piggyback in Mk3 mode.
14. Problems with schedules run in continuous mode.
15. Postpass for thin tapes.
16. In Mark5 mode, drudg now displays bytes in the summary listing.
17. Drudg has preliminary support for Mark 5A.

A more detailed discussion of these changes follows.

1. Mk5 disk-only recording. drudg now recognizes Mark5A or Mark5P as
   recorder types in Option 11. If your station is doing Mk5-only and
   NOT piggyback, you should use Option 11 to change your recorder
   type to "Mark5A" which is type 10. The SNAP and procedure files
   generated by drudg will have appropriate disk control commands and
   no tape commands. For stations with Mk4 formatters, the Mk5P is
   assumed to be connected to the second headstack, so tracks and
   trackform commands are generated for both headstacks, same as for
   piggyback mode.  Mk5A is handled differently. See item 17 below.

   If you are recording piggy-back, you need to use Option 13 so that
   both tape and disk commands are generated. In this case do not use
   Option 11.

2. Geo/astro schedule recognition. drudg recognizes the type of
   schedule and prints messages indicating whether the schedule is for
   geodesy or astronomy, and whether it's a VEX or standard format
   file. This feature is not used yet, but it is hoped to be reliable.
   The geo/astro decision is made, for a VEX file, based on inclusion
   of the SCHEDULING_PARAMS block.  This block is written for geo VEX
   output files but is not included in SCHED-generated VEX files.

   If you notice an incorrect comment, please let me know so that we
   can make sure this feature works for future needs.

3. Option 5 footages fixed. Footages on the last scan of a pass were
   sometimes indicated as negative numbers. This was only a problem in
   the listing, and did not indicate any actual scheduling errors. The
   negative values were due to a roundoff error in calculating
   footages from reading the .snp file. With the more accurate FASTx
   timing (see next item) the roundoff problem should be reduced. As
   an extra measure of precaution, the footage is set to 0 at the
   beginning of each forward pass if there was a previous FASTR
   command, indicating that the schedule intended to return the tape
   to zero feet to start the next pass.

4. FASTx commands include fractional seconds. The FASTx commands
   output in .snp files are output with the seconds extended to
   centiseconds. This will result in more accurate footage counts in
   the summary listings and in following the scheduled observations.

5. Extra digit in RA. An extra digit is output in the right ascension
   in the SOURCE= command. This was done on request from D. Graham
   since it is useful for pointing for millimeter observing.

6. Support for new LBA Data Acquisition System. LBA is now allowable
   as "electronics_rack_type". DRUDG will generate the setup commands
   for the individual IF processors and an appropriate "trackform"
   procedure for the S2 recorder output. VEX input is via the standard
   "chan_def" (but with an implicit promotion to a 'centreband' filter
   when only one sideband is required and re-use of flipped sidebands
   as necessary - see /usr2/fs/misc/lba/readme.txt for more detail)
   and a slightly modified "if_def" which accepts IFs '1' through '4'.
   This drudg upgrade was provided by Jonathan Quick of HARTRAO.

7. S2 support extended to support new LBA rack.  The S2 recorder type
   was extended with the addition of VEX inputs "S2_data_source"
   specifying the required 2-bit encoding type (either AT or VLBA) and
   "fanout_def" analogous to that for MkIV/VLBA recorders.  This drudg
   upgrade was provided by Jonathan Quick of HARTRAO.

8. Loader procedure changed for long thin tapes.  The "loader"
   procedure for Mark III / Mark IV and VLBA recorders now winds on
   approximately 200ft for thin tapes (tape length longer than
   17000ft) and 100ftfor thick tapes, i.e., to approximately the low
   elow tape sensor trigger point.  This is done by running the tapes
   for 22 seconds (11 seconds for thick tapes) at 135 ips.

9. Loopholes in headstack and track number closed.  A error in the VEX
   input code which incorrectly allowed through headstack 0 and track
   0 was fixed.

10. The LO commands for geodetic schedules will now include the
    polarization, e.g., lo=la,7600.10,usb,rcp,1.

11. Patching of IF3 is handled correctly for stations that have
    IF3. If LO3=L01 then IF3 is patched out. Else it is patched
    in. IF3 commands are issued if, and only if, IF3 is specified in
    the schedule. This is a change from previous versions of drudg
    where IF3 commands were generated regardless of whether it was in
    use or not.

12. Many changes were made to the header of snap summary file. These
    include: A) Showing the names of the setup proceudres the
    different modes, and the IFD procedures.  B) Including descriptive
    information about tape counters only if the specify recorder is
    used in the experiment. C) Recognizing Mark5 recorders.

13. Mark5 piggyback in mk3 should now work correctly.

14. Snap files generatd with the previous version of the Field System
    had extra FASTF and FASTR commands at the end of passes for
    continuous recording mode. This caused problems with RDV36.  This
    bug has been fixed.

15. Drudg now does a post-pass for all thin tapes if the postpass flag
    is true.  This flag is set to true for astro VEX schedules by
    default, and set to false for geo schedules. The postpass is done
    if the last reverse pass on the tape was not continous.

16. The summary listing for Mark5A and Mark5P stations now calculates
    the byte count and displays it instead of footages.

17. Drudg has preliminary support for Mark 5A.

    Drudg now supports two Mark5 modes: Mark5P and Mark5A. Mark5P mode
    should work as it always has. Mark5A mode is the new operational
    standard. This note summarizes some of the important changes made
    to drudg.

    Note that both Mark5P and Mark5A modes must be scheduled as if you
    are using tapes. To generate the appropriate snap and prc files
    you need to change the equipment type using option 11.

      1. Summary listings.  For both Mark5P and Mark5A the summary
         listing of the snap file (Option 5) gives the total recording
         space used in Gbytes. This should make it easy to figure out
         the time window for switching banks.

      2. Number of tracks recorded. In Mark5A mode the number of
         tracks recorded must be 8, 16, 32, or 64.  Drudg determines
         the number of data channels, and then rounds up to the
         nearest 8,16,32 or 64.  If the number of data channnels is:

           A.) Under 4, drudg reports an error.
           B.) More than 32 for a VLBA rack, drudg reports an error.
           C.) Less than the the number of tracks recorded, drudg
               duplicates the initial tracks. For example, if we have
               14 data channels, drudg would use 16 tracks to record
               this. The first two data channels would be duplicated.

      3. Special Mark5 commands. Drudg puts in special Mark5 commands
         in the prc files. Comments are also added explaining the
         wiring requirement for connecting the Mark 5 to the
         formatter. In summary there are four wiring cases: (1) for a
         Mark IV formatter, a Mark 5A is connected to both head
         outputs of the formatter; (2) for a VLBA formatter, a Mark 5A
         is connected to the second recorder output of the formatter
         and can record at most 32 tracks; (3) for a Mark IV
         formatter, a Mark 5P is connected only to the second head
         output, as was done before for piggyback mode; for a VLBA
         formatter, (4) a Mark 5P is connected to the second recorder
         output of the formatter, as was done before for piggyback
         mode.

    If you notice any bugs in drudg, please contact
    jmg@lyra.gsfc.nasa.gov.

 			    C. Known Bugs

The following is a summary list of known bugs. They are described in
more detail after the list.

1. Do not run "fmset" for extended periods.
2. "odd" and "even" head types not supported for Mark IV & VLBA4.
3. "odd"/"even" head types not supported for VLBA style tapeforms.
4. CHEKR does not check the status of the Mark IV formatter.
5. Extraneous errors when tape is stopped by low tape sensor.
6. "Comm=" command in logex extracts only the first command.
7. S2 error scheme clumsy.
8. No extra spaces allowed in "ibad.ctl" file.
9. ONOFF and FIVPT programs hang.
10. FS SNAP command pages don't list tape drive suffix numbers.
11. LBA rack TPI detector is not useable.

A more detailed discussion of these bugs follows.

1. Do not run "fmset" for extended periods. For stations that have
VLBA, Mark IV back-ends and/or an S2 recorder, the "fmset" program
should not be run for extended periods of time.  The "fmset" program
should be used only to set or briefly verify that the formatter time
is correct.  Do not leave "fmset" running after completing either of
these tasks, especially during an experiment.

The "fmset" program dominates the Field System when it is running and
this is likely to interfere with the running of an experiment or other
activities.  The only way to detect the time from the VLBA formatter
with greater precision than one second it to wait for the seconds
response from the formatter to change.  This requires the FS to
communicate with the formatter almost continuously.  A similar problem
exists for the S2 recorder.  This problem is less severe for the Mark
IV formatter, but extended use of "fmset" in this case should be
avoided as well.  In a future revision, this will be made more robust
so that there will probably be less danger if "fmset" is left running.
However, even in the future "fmset" should only be left running for as
short a time as possible.  A reminder about this is included in the
"fmset" menu.

2. "odd"/"even" head types not supported for Mark IV & VLBA4. The
Mark IV and VLBA4 rack version of the "form" command and the Mark IV
and VLBA4 recorder versions of the "repro" and "parity" commands do
not support the "odd" and "even" parameters for the read and write
head types and reproduce electronics in the "head.ctl" control file.
This means that automatic substitution of odd or even head in passes
that use only even or odd heads respectively does not occur.  The only
correct settings for the read and write head parameters and reproduce
electronics is "all".  This will be fixed in a future revision.
Please let Ed know if you are missing some tracks and need to work
around this limitation.

3. "odd"/"even" head types not supported for VLBA style tapeforms. For
any mode recorded with VLBA style tapeform (14 index positions), the
only correct setting of the read and write head types on the
"head.ctl" is "all".  This will be fixed in a future revision.  Please
let Ed know if you are missing some tracks and need to work around
this limitation.

4. CHEKR does not check the status of the Mark IV formatter.
Implementation of this has been deferred until the formatter
communication problems have been resolved.

5. Extraneous errors when tape is stopped by low tape sensor. When a
tape drive has been commanded to move the tape and then stops because
it hit the low tape sensor (or when S2 recorders hit the BOT or EOT),
"CHEKR" will complain periodically that the tape drive is not in the
correct state.  In principle the FS should be smarter about this.
However, if the tape is managed correctly by the schedule this error
message should never occur.  If it does, then it it an indication that
there is either a problem with: (1) the schedule, (2) the check
procedures, (3) the recorder, or (4) the tape is too short.  If any of
these cases apply they should be corrected.  It is more likely that
this error message will occur when the tape is being controlled
manually.  In this case, issuing an "ET" command will convince the FS
that the tape drive should be stopped and the error message will
cease.

6. "Comm=" command in logex extracts only the first command. The
"comm=" command in "logex" extracts only the first command commanded
and displayed.  This problem was noted by Giuseppe Maccaferri
(Medicina).

7. S2 error scheme clumsy. The error and status response number
reporting scheme for S2 recorders is clumsy.  FS errors that have
mnemonic "rl" are mostly error responses from the recorder or the RCL
interface library that is used to communicate with the recorder.  If
the numeric part of an "rl" error is greater than -130, then it is the
error code returned by the recorder.  If the numeric part is less than
-130, but greater than -300, then add 130 to the value, the absolute
value of the result is the error response code from the RCL library.
For values less than or equal to -300, a FS error has been detected.
Status response codes are all reported with mnemonic "rz" and the
numeric value is the negative of the status response code.  In all
cases an appropriate error or status message is displayed.  These
messages are retained in the log.

8. No extra spaces allowed in "ibad.ctl" file. The format of the
"ibad.ctl" must not contain any leading or embedded spaces.  In system
that use the LLP AT-GPIB driver (pre-FS Linux 4), if either the option
"no_untalk/unlisten_after" is misspelled or an incorrect device name
is supplied, the driver will cause a segmentation violation when it is
initialized and the FS will terminate.  Unfortunately there is no way
to prevent this problem in a general way; it reflects a limitation in
the driver.

9. ONOFF and FIVPT programs hang. The ONOFF and FIVPT programs have
been known to "hang" mysteriously.  This seems to be caused by some
problem with the "go" mechanism that is used to restart the program
when it pauses to allow a SNAP procedure, such as CALON or CALOFF to
execute.  The "go" that is used to restart the program fails for some
reason.  This has been exceedingly difficult to debug because it is
intermittent and fairly rare.  There is however a good work around for
it.  The CALON and CALOFF procedures are called by procedures CALONFP
and CALOFFFP for FIVPT and CALONNF and CALOFFNF for ONOFF.  FIVPT or
ONOFF may hang during (or actually just after) the execution of one
these procedures that FIVPT and ONOFF will typically hang.  If this
happens, you will have to terminate the FS to recover.  You can
prevent it from happening again (for this procedure) by adding the
lines:

!+1s
sy=go fivpt &

to the end of CALONFP or CALOFFFP.  For CALONNF and CALOFFNF, please
add:

!+1s
sy=go onoff &

If you see other situations where FIVPT or ONOFF hang, please let Ed
know.

10. FS SNAP command pages don't list tape drive suffix numbers. The FS
SNAP manual pages and the help pages available through the "help="
command do not reflect when multiple versions are available with
different suffixes depending on the number of drive specified in the
control files. For example, there is only a "tape" page, no "tape1" or
"tape2" page. However, the help facility will display the version of
the command with no suffix when an available command with a suffix is
used. For example, if two drives are defined, then "help=tape1" and
"help=tape2" will work, but "help=tape" will not and vice-versa if
only one drive is defined.

11. LBA rack TPI detector is not useable.  The Australian LBA Data
Acquisition System currently lacks a functional total power detector
though support has been included.  To allow approximate system temperature
calibration, all the setup commands and the TPI detectors of the modules
of a co-exisiting Mark IV rack are currently also available when the rack
type is specified to be LBA4.

III. Installation

If you are installing FS9 for the first time with this version, please
follow the installation instructions in Section 4.5 of the FS9
"Computer Reference" manual or the "nfsload.txt" memo.  In this case
you should also get a copy of the current FS9 "Control Files and Field
System Initialization" manual.

If you are upgrading from a version prior to 9.5.12, please upgrade to
that version first, then install this upgrade.

The following instructions are for upgrading from 9.5.12. Please
follow all the steps.

If you are upgrading from version 9.5.15-9.5.17, the instructions for
upgrading from 9.5.12 indicate which steps you can omit.

If you are upgrading from an different version that wasn't mentioned
here, please contact Ed for additional instructions.

(0) Before you begin the upgrade make sure you have a current back-up
of your system in case something goes wrong.  Please refer to the
directions for making disk-to-disk back-ups in Section 5.8 of the FS9
"Computer Reference" manual.  If you are running one of the Debian
distribution kernels and do not have documentation on how to make a
back-up, please contact Ed.  Section 5.7 of the FS9 "Computer
Reference" manual has a discussion of drive ID numbers if you are
unsure about these.  You may choose to install the FS on your back-up
disk for testing and then later copy the back-up onto the primary once
you are satisfied with the new version.  In any event, please be sure
to make a fresh back-up before continuing with the installation.

(1) Please be sure that you have at least 30 MB of free space (use the
"df" UNIX command to check free space) on your "/usr2" partition
before starting the upgrade.  This would probably only be a problem
for stations with 200 MB disks.  If you are tight on space, you may
want to delete old log files and old versions of the FS (except your
most recent one of course).  Since you should have backed-up your
system, you even can delete the "*.[oas]" and executable files of your
most recent version.  You might want to keep the source of the previous
version around for reference if you have room.  You can eliminate the
unnecessary files by "cd"-ing to the old FS directory as "prog" and
doing a "make rmdoto rmexe".  If you have any questions about how to
do this, please contact Ed.

(2) Log-in as prog.

(3) Place a copy of the fs-9.6.1 archive in your "/tmp" directory. For
example you might do the following:

      cd /tmp
      ncftp -u atri.gsfc.nasa.gov
      (enter your account name for the server at prompt)
      (enter your password for the server at prompt)
      cd /fs/dist
      get fs-9.6.1.tar.gz
      quit

Please note "ncftp" will automatically get this file in binary mode.
If you use "ftp" you may have to enable binary mode manually.

If you need to transfer the archive using DOS floppies, please see the
section "IV. Transferring The Update Archive By DOS Floppy" below.

(4) Log-out as prog and log-in as root.

(5) Extract the source from the archive:

      cd /
      tar -xzpf /tmp/fs-9.6.1.tar.gz

(6) Set the link for the new FS version:

      cd /usr2
      ln -sfn fs-9.6.1 fs

(7) VERY IMPORTANT: Log-out as root, and log-in prog.

(8) Make the FS:

      cd /usr2/fs
      make

(9) Remake your station softare. If your station software uses shared
    memory or other resources whose access is controlled by "keys",
    you should probably switch to using "ftok()" to generate the
    keys. If you are the developer of station software for your
    station, you can follow the basic directions in parenthesises at
    the end of this paragraph.  If you are not the developer of
    station software for your station, please skip to the next
    paragraph in this step (9) for instructions on how to reload your
    station software, but please inform the person who develops the
    software for your station about this issue. It is not necessary to
    change this in order to load this FS version. (In order to change
    using ftok() to generate keys, you will need to replace any
    hardwired value for a key, with text like
    'ftok("/usr2/st",1)'. The string "/usr2/st" is suggested to
    associate the key with your station software. The "1" should be
    replaced with any char value, 128 values are possible, that is
    unique for each key you need. Typically the keys are defined in
    '#define' statements in /usr2/st/include/stparams.h.  You will
    also need to make sure that for every source module that uses the
    key definition that the correct headers have been included for
    ftok(). Please see "man ftok" for more information. The modules
    that typically would need to be checked are
    /usr2/st/stalloc/stalloc.c and /usr2/st/include/stlib/setup_st.c,
    but there may be others. You can refer to the default version of
    these routines and the include file in
    /usr2/fs/st.default/st-0.0.0 as examples.)

    The following steps should do the trick to reload your station
    software if you have the "standard" configuration for station
    software:

      cd /usr2/st
      make rmdoto rmexe all

(10) Reboot your computer.

(11) Log in as oper

(12) Set-up the new control files. If you have already updated to
     version 9.5.15 through 9.5.17, you should skip all but dsad.ctl.

       cd /usr2/control
       cp /usr2/fs/st.default/control/flux.ctl .
       cp /usr2/fs/st.default/control/x.rxg .
       cp /usr2/fs/st.default/control/dsad.ctl .

     The "flux.ctl" file should not require editing.

     The "x.rxg" file should be renamed so that the part of the name
     before the dot is mnemonic for what band or receiver you are
     planning to use. Please make copies with unique names and edit
     then for additional bands. The names aren't important, the FS
     will read in all files with the extension ".rxg", up to 20 of
     them. Please edit the file(s) and update it(them) for your
     band(s). The comments should be self explanatory, but here are a
     few hints. The lines you should probably edit are: (1) the LO
     values, this must match the values used in the "LO=..." command
     for the RX you will be using, these can either be a range or up
     to two fixed values; (2) the polarizations available "lcp" and/or
     "rcp", if you have both the order isn't important, but it must
     match the order used in the (next) DPFU line; (3) the DPFUs if
     you know them, one for each polarization in the (previous)
     polarization line, they can be estimated as the Tsys in Kelvin
     divided by the SEFD, if you have no idea, you can use "1000" as a
     dummy values; (4) if you have a gain curve in the form of "ELEV
     POLY" or "ALTAZ POLY" , you can enter the coefficients on the
     appropriate line zeroth order term first, if you have no gain
     curve, leave the value as "1.0"; (5) the tcal versus frequency
     table, if you have this information, if not, you can enter a
     single value with a freqeuncy in the band (MHz) and the FS will
     use that for all frequencies for that LO; (6) for the tcal versus
     frequency table group all entires by polarization and then sort
     them into ascending frequency order within each polarization; and
     (7) do not have a given LO value specified in more than one file.
     Please note that the error messages for the parsing of these
     files are not complete yet. In general, the the hundreds digit of
     the number indicates which line the error occurred in (-7xx is
     for the tcal table). Also it may have some trouble with blank
     lines and/or missing (or present? I'm not sure) new-lines at the
     end of the file.

     You should make a version of ctlpo.ctl for each band that will
     want to measure the gain and tcal versus frequency for. Name them
     appropriately, perhaps matching the part of the name before the
     dot in the corresponding .rxg file. You can the customize the
     set-up for each band. If you only have one band or band
     combination (such as S/X), you may wish to leave your ctlpo.ctl
     unchanged for now.

     If you have LBA data acquisition systems connected, check that the
     dataset addresses in "dsad.ctl" correspond to those set by the jumpers
     on the backplane of each DAS, with 'd1' corresponding to the DAS you
     intend to use for VLBI recording (which will then be IFPs 1 and 2.)

(13) Modify your procedure files. You should skip this step if you
     have already updated to version 9.5.15 through 9.5.17 (However,
     if you have copied over the new default point.prc in a previous
     update, please edit the VIRGOA procedure in the point.prc
     procedure file and remove the dash in the name field of the
     source= command, so that it says "virgoa". If you are upgrading
     from an earlier version, you will need to make this change for
     all source= command with dashes in them, please see below). For
     station.prc:

     Please see the new default version of PREOB, MIDOB, CALTSYS, and
     MIDTP in the default procedure library for your equipment in
     /usr2/fs/st.default/proc. Update your versions to agree with the
     new defaults.  The naming conventions for these files are:

        Equipment      Prefix letters  Station Library
        Rack/Drive1/Drive2

        K42/K42            k42         k42station.prc
        K42K3/VLBA         k42k3v      k42k3vstation.prc
        K42MK4/VLBA        k42mk4v     k42mk4vstation.prc
        K42MK4/VLBAB/VLBAB k42mk4vb    k42mk4vstation2.prc
        LBA/S2             ls2         ls2station.prc
        LBA4/S2            l4s2        l4s2station.prc
        Mk3/Mk3A                       station.prc
        Mk4/Mk4            4           4station.prc
        Mk4/VLBA4          4v4         4v4station.prc
        NONE/S2            s2          s2station.prc
        VLBA/S2            vs2         vs2station.prc
        VLBA/VLBA          v           vstation.prc
        VLBA/VLBA2         v2          v2station.prc
        VLBA/VLBA/VLBA     v           vstation2.prc
        VLBA4/VLBA4        v4          v4station.prc
        VLBA4/VLBA42       v42         v42station.prc

     Please delete all CALTEMPx, FLUXx, and BEAMx commands.

     Please delete the CALTEMPS procedure and any uses of it.

     For point.prc, it may be easiest to just copy the new default
     point.prc from /usr2/fs/st.default/proc to /usr2/control and edit
     that. If you do this, the only changes that should be needed are
     to select the detectors for FIVEPT and ONOFF and the scan axes
     for FIVEPT.  Examples for two different cases are included in the
     default ACQUIRE procedure. You may want to customize other
     features like the integration time. You should make a copy of the
     ACQUIRE procedure that is specific for each band you intend to
     measure gain and Tcal data for (again using the name before the
     dot in the corresponding .rxg file as part of the procedure name
     is suggested). Each version of the ACQUIRE procedure should open
     a log with a name specific for the receiver under test.  After
     the log opening command, a "CALRX=..." command for the bands
     under test should be inserted. The CALRX commands must give the
     part of the name before the dot in the corresponding .rxg file
     and it must have the same LO definition parameters as in that
     file.  Please see the CALRX command help page for details on the
     parameters.

     If you edit your existing point.prc library: you will need to
     delete any FLUXx and BEAMx commands; and modify the parameters of
     the ONOFF command in INITP; delete additional FIVEPT and ONOFF
     commands in PRESUN, POSTSUN, PREMOON, and POSTMOON (they are no
     longer necessary since FIVPT and ONOFF now compensate for the
     size of source automatically); and change any source names with
     the hyphens to remove the hyphens (this will probably be cas-a
     cygnus-a, taurus-a, and virgo-a), source names must match the
     names in flux.ctl in order for the correct flux value to be used,
     please note that "casa" is a special name that invokes a model
     for decreasing flux as a function of time. You will also need to
     define the additional ACQUIRE procedures described above.

(13) Add the lines for LBA rack and MET3 support to the equip.ctl
     file. As oper:

       cd /usr2/control
       tail -7 /usr2/fs/st.default/control/equip.ctl >> equip.ctl

     Now edit equip.ctl and make sure there is no blank line between
     the Mark IV firmware version and the new LBA parameters. Fill in
     the number of LBA data acquisition systems connected, whether to
     switch the 160MHz anti-alias filters in or out and whether the
     systems get their input from the internal 8-bit samplers or from
     an external 4-bit source (typically only at the Australia
     Telescope Compact Array.)  If you do not have an LBA system, no
     change in the default values is needed.  And of course if you
     actually want to use the LBA support, set the rack type to "lba"
     (or "lba4" if you want to use Mark4 TPI detectors.)

     If you have a MET3 weather sensor and have set-up the metserver,
     change the met sensor type to "met3".

(14) Add the lines for the "dscon" ATNF dataset bus controller to the
     dev.ctl file. As oper:

       cd /usr2/control
       tail -2 /usr2/fs/st.default/control/dev.ctl >> dev.ctl

     If you have LBA data acquisition systems connected, fill in the
     serial port device name and required baud rate.

(15) If you do have an LBA data acquisition system, and are using the
     standard FS display layout and hot-keys, you will probably want to
     add support for the new "monit4" display process.  As oper:

     	cp /usr2/fs/st.default/oper/.Xresources ~/
     	cp /usr2/fs/st.default/oper/.fvwmrc ~/

     and similarly as prog:

     	cp /usr2/fs/st.default/prog/.Xresources ~/
     	cp /usr2/fs/st.default/prog/.fvwmrc ~/

     or merge the new information by hand.

(16) For the new combination of LBA rack and S2 recorder, there are two
     corresponding new station libraries.  If your station operates with
     this combination of equipment then as oper:

        cd /usr2/proc

        cp /usr2/fs/st.default/proc/l4s2station.prc station.prc
           or
        cp /usr2/fs/st.default/proc/ls2station.prc station.prc

        chmod go+rw station.prc

     for LBA with and without Mark4 respectively and customise it to
     suit your local settings.

(17) Add the "exper_initi" procedure to your station procedure
     library. It is best to do this with PFMED. The procedure should
     have one line in it, which should be a call to "sched_initi".
     This procedure will already be in place if you did step
     (16). Explicit instructions for creating the "exper_initi"
     procedure:

        pfmed
          pf,station
          vi,exper_initi
             enter 'a' (vi command, don't include quotes)
             enter 'sched_initi' (text with no quotes)
             Press the Escape key
             enter ':wq' (vi command, don't include quotes)
          ::

(18) If you have a Mark III/IV rack with an IF3 module, please check
     any IFDxx set-up procedures you have in your procedure
     libraries. Older versions of these procedures did not take IF3
     properly into account and only listed VCs 5-8 as connected to IF3
     when the frequency sequence was a wide X-band. Most geodetic
     stations have VCs 5-8 permanent connected to IF3. If you do,
     please make sure the patch= commands to agree with the
     wiring. You may need to adjust the example settings below for
     your equipment:

       patch=
       patch=lo1,1l,2l,3l,4h
       patch=lo2,9l,10l,11l,12h,13h,14h
       patch=lo3,5h,6h,7h,8h

     In addition, for narrow-band set-ups, you may need to add a
     lo=... line for lo3, this should be grouped with the other
     lo=... commands.  You may need to adjust the example settings
     below for your equipment:

       lo=
       lo=lo1,8080.00,usb,rcp,1
       lo=lo2,2020.00,usb,rcp,1
       lo=lo3,8080.00,usb,rcp,1

     Please be sure all IFD set-up procedures in your libraries have
     the correct patching. If they do, the "ifadjust" command should
     work well for these set-ups.

(19) Please check that all lo=... commands in the IFDxx (for example,
     xx=SX) in your procedures libraries specify the LO side-band and
     polarization as well as the LO value. The new CALTEMP and TSYS
     commands will not work unless this information is supplied.

(20) Update your stcmd.ctl file for the new format. The commands:

        cd /usr2/control
        /usr2/fs/misc/cmdctlfix4 stcmd.ctl

     should do it automatically.  You will need to rename or delete
     your old "stcmd.bak" if it already exists.  If all your station
     commands are hardware independent, i.e., the equipment bit fields
     are "FFFFFF", as they probably should be, this should work with
     no problems.  The result for hardware independent commands should
     be "FFFFFFFFF".  You should check the contents of the file to
     make sure they are correct.

     If you haven't updated your "stcmd.ctl" file since installing 9.5
     your equipment bit fields may still be "1F1F". You can correct
     this before running "cmdctlfix4" by first running "cmdctlfix3"
     and renaming or deleting "stcmd.bak".

     If you haven't updated your "stcmd.ctl" file since installing
     9.4, your equipment bit fields may still be "FF". You can correct
     this before running "cmdctlfix3" by first running "cmdctlfix2"
     and renaming or deleting "stcmd.bak".

     If you haven't updated your "stcmd.ctl" file since the S2
     equipment support was added, your equipment bits field may be
     still be "77". You can correct this before running "cmdctlfix2"
     by first running "cmdctlfix" and renaming or deleting
     "stcmd.bak".

     Please note that if your "stcmd.ctl" has been partially or
     incorrectly updated in the past, "cmdctlfix", cmdctlfix2",
     "cmdctlfix3", and "cmdctlfix4" will do the best they can and
     print a warning.

(21) Test the FS.  Generally speaking a fairly thorough test is to run
     a test experiment: start with DRUDG-ing a schedule, executing
     part of it (preferably at least a tape change and a parity check
     in each direction), do any normal post-experiment plotting and
     clean-up that you do.  The idea here is to verify that everything
     works as you expect for normal operations.  In particular for
     this upgrade you should also test the CALTSYS, PREOB, and MIDOB
     procedures and also verify that ONOFF and FIVPT work as expected.

     If your CALTEMP and TSYS commands return zero values, check the
     following: (1) you have set-up the rack with FS, in particular
     that the correct LO=... commands (and patch=... commands for Mark
     III/IV) have been executed, (2) that the LO=... commands specify
     the LO side-band and polarization parameters, and (3) that you
     have an .rxg file that specifies the calibration data for each of
     the LO settings in use (no specific LO value should be occur in
     more than on .rxg file.), in particular that you specified the
     correct LO settings and have made entries in the tcal table for
     the polarizations in use.

VII. Transferring The Update Archive By DOS Floppy

In order to assist sites that need to transfer the FS archive by DOS
floppy, "split" files of the fs-9.6.1.tar.gz archive have been placed
in the /fs/dist directory on atri.gsfc.nasa.gov.  These files are
small enough to each fit on 1.44 MB 3.5" floppy.  The files are:

fs9601tg.aa
fs9601tg.ab

If you need to use DOS floppies to get files to the FS computer,
please copy these files to some directory such as /tmp on the FS
computer and then execute the command:

cat fs9601tg.* >fs-9.6.1.tar.gz

This will create an exact image of the original fs-9.6.1.tar.gz
archive on your computer.  Please be sure to use binary transfer when
getting the files from atri or kurp-ftp.
