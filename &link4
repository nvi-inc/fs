FTN4,X
C@LINKP 
C 
        SUBROUTINE LINKP(NAMES,N1),LINK TO QUIKR (RTE-IV)C#870115:04:29#
C 
C     This routine links the appropriate segment to QUIKR 
C 
C  INPUT: 
C 
      DIMENSION NAMES(1)
C      - the names list entry with segment name, and previous segment name
C     NAMES(1) - the hashed command 
C     NAMES(2) - the second word of the segment name
C     NAMES(3) - the third word of the segment name 
C     NAMES(4) - the segment and subroutine numbers 
C     NAMES(5) - information for BOSS 
C     NAMES(6-8) - the previous segment name in entirety
C     N1 - parameter to be passed, contains RMPAR 
C 
C     CALLING SUBROUTINES: QUIKR ONLY 
C 
C     CALLED SUBROUTINES:  LINQA
C 
C 3.  LOCAL VARIABLES 
C 
      DIMENSION IMUF(10)
C                   Buffer for system status request and response 
C       ISEG    - the segment number
C       ISUB    - the subroutine number 
        DIMENSION ISGNM(3)
C      - the segment name 
C 
C 4.  CONSTANTS USED
C 
C 5.  INITIALIZED VARIABLES 
C 
C 6.  PROGRAMMER: LEE N. FOSTER, MODIFIED BY NRV
C     LAST MODIFIED: 800319 
C# LAST COMPC'ED  870115:04:29# 
C 
C     PROGRAM STRUCTURE 
C 
C     1. First build the segment name.  First two characters
C     always "QR".  Last four from names entry. 
C 
        ISGNM(1)=2HQR 
        ISGNM(2)=NAMES(2) 
        ISGNM(3)=NAMES(3) 
C 
C     NOW FIND OUT IF SEGMENT IS ALREADY RP'ED
C 
      CALL ICHMV(IMUF,1,3HST,,1,3)
      CALL ICHMV(IMUF,4,ISGNM,1,6)
      NCH = -MESSS(IMUF,9)
C                   SENG MESSAGE "ST,<PROG>" TO GET STATUS
      IF (IMUF(1).NE.2HNO) GOTO 620 
C                   IF PROG ALREADY THERE, DO NOT RP IT AGAIN 
C                   RESPONSE "NO SUCH PROG" REQUIRES RP 
      CALL ICHMV(IMUF,1,3HST,,1,3)
      CALL ICHMV(IMUF,4,NAMES(6),1,6) 
      NCH = -MESSS(IMUF,9)
C                   CHECK STATUS OF PREVIOUS SEGMENT
C     IF (IMUF(1).NE.2HNO) CALL IOF(NAMES(6),IERR,0)
C                   If previous segment is there, OF it now 
      IF(IRP(ISGNM,0,IERR,0) .LT. 0)GO TO 999 
C                   THEN RP NEW SEGMENT 
C 
620     ISEG=NAMES(4)/100 
        ISUB=MOD(NAMES(4),100)
C 
        CALL LINQA(ISEG,ISGNM(1),ISUB,1,N1) 
C 
      NAMES(6) = ISGNM(1) 
      NAMES(7) = ISGNM(2) 
      NAMES(8) = ISGNM(3) 
C                   SAVE CURRENT NAME AS PREVIOUS SEGMENT NAME
C 
999     CONTINUE
C 
        RETURN
      END 
