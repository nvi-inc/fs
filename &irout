FTN4,L
        SUBROUTINE IROUT(ILU,IBUF,IBFL,LINE,ICOL,IMODE),
     C C#870115:05:49 IROUT 4 RCA V=1#
        DIMENSION ISCR(5) 
C 
C               ESC Y PREFIX FOR CURSOR CONTROL 
C 
        DATA ISCR/15531B/ 
C 
C               GET LU FOR NO <CR> <LF> 
C 
        LUINT=2200B+ILU 
C 
C               BUILD AND MOVE IN LINE POSITION 
C 
        NCHAR=ICHMV(ISCR,3,LINE+37B,2,1)
C 
C               BUILD AND MOVE IN COLUMN POSITION 
C 
        NCHAR=ICHMV(ISCR,NCHAR,ICOL+37B,2,1)
C 
C               INSERT INVERSE VIDEO IF WANTED
C 
        IF(IAND(IMODE+1,2) .NE. 0)NCHAR=ICHMV(ISCR,NCHAR,17B,2,1) 
C 
C               POSITION CURSOR AND SET VIDEO MODE
C 
        CALL EXEC(2,LUINT,ISCR,1-NCHAR) 
C 
C               IF NO MODE GAMES SET FOR FINAL WRITE WITH <CR> <LF> 
C 
        IF(IAND(IMODE,1) .EQ. 0)LUINT=ILU 
C 
C               WRITE USER REQUESTED INFORMATION
C 
        CALL EXEC(2,LUINT,IBUF,-IBFL) 
C 
C               IF INVERSE MODE OFF WANTED WRITE IT NOW 
C 
        IF(IAND(IMODE,1) .NE. 0)CALL EXEC(2,ILU,7000B,-1) 
        RETURN
        END 
        END$
