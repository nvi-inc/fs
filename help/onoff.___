                    onoff - on-off radiometry

            Syntax:     onoff=rep,intp,cutoff,stp,wait,devices

            Response:   onoff/rep,intp,cutoff,stp,wait,ssize,mfwhm
          onoff/device,if,pol,fwhm,center,flux,dpfu,gain,product


Settable parameters:
          rep       Number of repetitions, 1 to 99. Default is 2. 
            intp        Integration period, 1 to 10 seconds. Default is 1. 
            cutoff      Elevation above which to step in elevation rather
            than azimuth, in degrees, default 75.
          stp       Distance off source for off source and calibration
          points, in multiples of a beamwidth. Default is 3.0.
            wait        Seconds to wait for onsource for each point, 1-1200
            seconds allowed, default 120.
          devices   One or more of all standard device mnemonics, plus
          all, allvc, formvc, and formif  for Mark III/IV, plus allbbc, allu,
          alll, formbbc, and formif for VLBA/4. For all racks station
          defined detectors u5 and u6 are supported if the station has
          them implemented.

Monitor-only parameters:
          ssize     source size, degrees
          mfwhm     maximum full-width-half-maximum of all selected
          devices, degrees
            device      a selected device's mnemonic 
            if          if chain for device, 1-3 for Mark III/IV and LBA4, a-d
            for VLBA/4
          pol       polarization for device, l for left and r for right
          fwhm      full-width-half-maximum for device, degrees
            center      center frequency for device, MHz
            tcal        Noise diode temperature for center, degrees K
            flux        Source flux for center, Janskys
            corr        Source flux correction for center and fwhm,
            dimensionless
            dpfu        Degrees-per-Flux-Unit, for band of device, in
            degrees/Janskys
            gain        gain curve value for band of device at current
            elevation, dimensionless
          product   dpfu*gain for device, degrees/Janskys

Comments:
This version works only with Mark III/IV or VLBA/4 devices,
i.e.,user defined devices are not supported.

The parameters should be setup by issuing a onoff=... 
command. A measurement is started by issuing a simple onoff.
This will recover the current values for the display only
parameters and schedule an external program onoff. See the
onoff manual in  Volume 2 (currently out-of-date).

The current command antenna position including offsets is
assumed to be 'onsource.'
 
It is recommended that nothing else be done, e.g. running a 
schedule, while this command is executing. Since this command
may run for an extended period of time, a mechanism has been
supplied for aborting: enter sy=brk onoff & as a SNAP command.
After aborting, the offsets will be returned to their original
values.

In order for this command to work, the following conditions
must be met: (1) the detector devices have been set up by the
Field System, (2) the appropriate lo=  commands have been
issued, (3) for a Mark III/IV or LBA4 rack only,  the IF
distributors have been set up by the Field System and  must be
in remote, (4) for a Mark III/IV or LBA4 rack only, if  a
video converter is used as a detector, the appropriate
patch=  command must have been issued, and (5) for a VLBA/4
rack only, if a BBC is used as a detector, the appropriate BBC
IF input must be selected with a bbcXX=  command.

If a noise diode temperature is less than zero, it is assumed that
there is no noise diode to use for that detector. All measurements for
that channel will be made assuming the absolute value of the diode
temperature is the system temperature. Thus if the noise diode
temperature is -100, the power measurements will come out as a
percentage of the system temperature. Other quantities dependent on
the noise diode will be displayed as 0.0.

If either noise diode temperature is greater than zero, then
two procedures must be available: calonnf and caloffnf, which
are used to turn the noise diode on and off respectively. The
recommended form for these procedures is:

CALONNF:  calon
          !+1s
          sy=go onoff & 

CALOFFNF: caloff
          !+1s
          sy=go onoff & 

calon and caloff are local procedures that do whatever is
necessary to turn the noise source on and off, respectively. 

If station dependent detectors u5 and/or u6 are used, two additional
procedures must be available to turn the signal on and off to the
detectors. The recommended form of this procedures is:

SIGONNF:  sigon
          !+1s 
          sy=go onoff &

SIGOFFNF: sigoff
          !+1s 
          sy=go onoff &

sigon and sigoff are local procedures that do whatever is
necessary to turn the signal to the station dependent
detectors on and off, respectively.

The "formbbc", "formif", and "formvc" detector device parameters will
cause the BBCs, IFs, or VCs (respectively) that are current defined
for recording by the formatter to be selected as detectors. This is
useful for checking SEFDs in all channels to be used in an experiment.

There is a known bug in the use of these procedures: calonnf,
caloffnf, sigonnf, and sigoffnf,  that may require the last
two lines to be repeated in each procedure. In other words
after the first line, each procedure should contain:

          !+1s
          sy=go onoff &
          !+1s
          sy=go onoff &

The indication that this is needed is if onoff seems to hang
after executing one of these procedures. Please see the "Known
Bugs" section of the latest update notice for more details.

The default wait time for of 120 seconds is generous, but can
be adjusted if necessary. Slower antennas may need a longer
time. Shorter times are only useful to make onoff give-up
sooner if there is a problem getting on-source.
