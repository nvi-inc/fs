FTN4,X
C@ANTCN 
      PROGRAM ANTCN(3),ANTENNA INTERFACE FOR WESTFORD C#881105:15:34# 
C# LAST COMPC'ED  881105:15:34                X 
C     This program picks up the source RA and DEC from
C     COMMON and sends them to the Westford pointing system.
C 
      INCLUDE #FSCOM::FS
C 
C 
C  INPUT: 
C 
      DIMENSION IP(5) 
C      - IP(1) - 1 for source change
C                2 for source offsets 
C                3 for az,el errors 
C 
C  OUTPUT:
C 
C     none
C 
C     LOCAL:
C 
      DOUBLE PRECISION RAD,DECD 
C 
C 
C  SUBROUTINES CALLED:
C 
C     SORCE - changes source at Haystack
C     OFSET - puts in offsets to source position
C     AEERR - gets az,el errors 
C 
C 
C     1. This is the simplest of all antenna interfaces.
C     First convert the RA and DEC on COMMON from radians to degrees. 
C     Then call the routine wich sets up a buffer for us. 
C 
      CALL RMPAR(IP)
C 
      IF (IP(1).EQ.3) GOTO 300
C 
C 
C     1.  A new source.  First check for a real source or satellite.
C 
1     IF((RA50.EQ.0.0).AND.(DEC50.EQ.0.0).AND.(EP1950.EQ.-1.) 
     . .AND.(IP(1).EQ.1) )GOTO 150
C 
C     1.1 This is a normal source.  Call SORCE with proper
C         parameters. Note we DO NOT use the overlap argument.
C 
C 
      RAD = RA50*180.0/PI 
      DECD = DEC50*180.0/PI 
      RAO = RAOFF*180.0/PI
      DECO = DECOFF*180.0/PI
      ELO = ELOFF*180.0/PI
      AZO = AZOFF*180.0/PI
C 
      IF (IP(1).EQ.1) CALL SORCE(LSORNA,RAD,DECD,EP1950,0)
      IF (IP(1).EQ.2) CALL OFSET(RAO,DECO,AZO,ELO)
C 
C  Wait for the antenna to settle.  This is required because the  
C  Type II tracking remains on and the antenna overshoots.
C 
      CALL SUSP(2,3)
      GOTO 900
C 
C     1.5 A satellite.  Calculate position and derivatives. 
C         Then call SORCE with these values and code name.
C 
150   CALL SATFS(ICRPRC,ALAT,WLONG,RAUT0,DECUT0,
     .RADOT,DECDOT,RADDOT,DECDDT) 
      CALL SATEL(10HSATELLITE ,RAUT0,DECUT0,
     .RADOT,DECDOT,RADDOT,DECDDT) 
      GO TO 900 
C 
300   CALL AEERR(AZER,ELER) 
C     WRITE(LU,9901) AZER,ELER
C9901 FORMAT("AZ,EL ERRORS="2F10.5) 
      IONSOR = 0
CCC   IF (SQRT(AZER*AZER+ELER*ELER).LT.0.006) IONSOR = 1
C  Modified by JAB, 1988 November 5:  
      IF (ABS(AZER) .LE. 0.015 .AND. ABS(ELER) .LT. 0.015)  
     &  IONSOR = 1  
C 
900   IP(1) = 0 
      IP(2) = 0 
      IP(3) = 0 
      IP(4) = 2HAN
      IP(5) = 0 
      CALL PRTN(IP) 
C 
      END 
