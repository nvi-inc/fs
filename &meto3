FTN4,X
      SUBROUTINE METO3 (E,P,H,T,OLAT,ELEVO, 
     .                  RINI),C#870115:04:46# 
  
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
  
C 3.    METO3 
C 
C 
C 3.1   PROGRAM SPECIFICATION 
C 
C 3.1.1 THIS SUBROUTINE OFFERS THE MARINI ATMOSPHERIC CORRECTION TO 
C       THE DELAY AND DELAY RATE, PROVIDED THE USER CAN COME UP WITH
C       EVERYTHING THE SUBROUTINE WANTS.  SEE THE REFERENCES TO 
C       UNDERSTAND HOW THE CODE IN THIS SUBROUTINE WORKS.  NO CHECKS
C       OF ANY KIND ARE MADE, AND NOTE THAT EVERYTHING IS HANDLED 
C       IN DOUBLE-PRECISION.
C 
C 3.1.2 RESTRICTION -- HP 21MX ONLY 
C 
C 3.1.3 REFERENCES -- (1) "CORRECTION OF RADIO RANGE TRACKING DATA FOR
C                         ATMOSPHERIC REFRACTION AT ELEVATIONS ABOVE
C                         10 DEGREES," J.W. MARINI, 2/4/74. 
C                     (2) "DIFFERENTIATION OF THE MARINI FORMULA,"
C                         GEORGE MAEDA, JULY 10 79. 
C 
C 
C 3.2   PROGRAM INTERFACE 
C 
C 3.2.1 CALLING SEQUENCE -- CALL METO3 (E,P,H,T,DEDTIM,DPDTIM,DHDTIM,DTDTIM,
C                           OLAT,ELEVO,VLIGHT,   RINI,DRINI)
C 
C       INPUT VARIABLES 
C 
C       * - THESE ARE DIRECTLY AVAILABLE FROM SUBROUTINE "METO2"
C 
C       1) E      - STAR ELEVATION ANGLE (RADIANS)
C     * 2) P      - BAROMETRIC PRESSURE AT SITE (MILLIBARS) 
C     * 3) H      - RELATIVE HUMIDITY AT SITE IN DECIMAL FORM (E.G., 0.74)
C     * 4) T      - TEMPERATURE AT SITE (DEG. C)
C       5) DEDTIM - RATE OF "E" (RADIANS/SEC) 
C     * 6) DPDTIM - RATE OF "P" (MILLIBARS/SEC) 
C     * 7) DHDTIM - RATE OF "H" ( / SEC)
C     * 8) DTDTIM - RATE OF "T" (DEG. C /SEC) 
C       9) OLAT   - GEODETIC LATITUDE OF SITE (RADIANS) 
C      10) ELEVO  - ELEVATION OF SITE ABOVE SEA LEVEL (METERS)
C      11) VLIGHT - VELOCITY OF LIGHT (METERS/SEC)
C 
C       OUTPUT VARIABLES
C 
C       1) RINI   - OUTPUT OF MARINI FORMULA DIVIDED BY VLIGHT (SEC)
C       2) DRINI  - TIME DERIVATIVE OF "RINI" DIVIDED BY VLIGHT (SEC/SEC) 
C 
C 3.2.2 COMMON BLOCKS -- NONE 
C 
C 3.2.3 PROGRAM SPECIFICATIONS -- NONE
C 
C 3.2.4 DATA BASE ACCESS -- NONE
C 
C 3.2.5 EXTERNAL I/O -- NONE
C 
C 3.2.6 SUBROUTINE INTERFACE
C 
C       CALLER SUBROUTINE -- ???? 
C       CALLED SUBROUTINE -- NONE 
C 
C 3.2.7 CONSTANTS USED -- NONE
C 
C 3.2.8 PROGRAM VARIABLES  -- CORRESPOND EXACTLY TO THOSE FOUND IN
C                             THE 2ND REFERENCE 
C 
C 3.2.9 PROGRAMMER -- GEORGE MAEDA  JULY 30 79
C                     MODIFIED BY NRV FOR FIELD SYSTEM 820530 
C 
C 
C 3.3   PROGRAM STRUCTURE 
C 
C 0.    CONSTANTS FOUND IN THE 2ND REFERENCE
  
      ESIN = DSIN(E)
      ECOS = DCOS(E)
         C = .002277D0
         Q = 237.3D0
         W = 273.16D0 
      ENOT = 6.11D0 * (10.D0 ** ((7.5D0*T)/(T+Q)))
         A = C * (P + (1255.D0/(T+W)+.05D0) * H * ENOT) 
      TERM = -.14372D0 * ELEVO / 1.D3 
         B = (2.644D-3) * DEXP(TERM)
         F = 1.D0 - (2.6D-3) * (1.D0 - 2.D0 * DSIN(OLAT) ** 2)
     .       - (3.1D-4 * ELEVO / 1.D3)
      BRAC = ESIN  +  B / ( (A+B)*(ESIN+.015D0) ) 
C 1.    PUT TOGETHER THE FINAL VALUE OF "RINI"
      RINI = (A+B)/(F*BRAC) 
      RETURN
      END 
