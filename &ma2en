FTN4,X
C@MA2EN 
      SUBROUTINE MA2EN(IBUF,IENA,ITRK,
     .         NTRK),CONVERT MAT BUFFER TO EN DATA C#890516:19:03#
C 
C     This routine converts the buffers returned from the MAT 
C     into the enabled track information. 
C 
C  INPUT: 
C 
      DIMENSION IBUF(1) 
C      - buffers of length 5 words, as returned from MATCN
C 
C  OUTPUT:
C 
C     IENA - general enable bit ("record" button) 
      DIMENSION ITRK(28)
C      - enabled tracks 
C     NTRK - number of tracks enabled (i.e. # of 1s in ITRK)
C 
C 
C     Buffers from MATCN look like: 
C     for % data:   TPtttttttt
C     where each "t" contains 3 or 4 bits regarding tape track status 
C 
C     Note we are only concerned with the last 8 characters 
C 
C 
      DO 120 I=1,2
        IC = 10 
        IF (I.EQ.2) IC = 8
        DO 110 J=I,16,14
          IA = IA2HX(IBUF,IC) 
          ITRK(J) = IAND(IA,1)
          ITRK(J+2) = IAND(IA,2)/2
          ITRK(J+4) = IAND(IA,4)/4
          ITRK(J+6) = IAND(IA,8)/8
          IA = IA2HX(IBUF,IC-1) 
          ITRK(J+8) = IAND(IA,1)
          ITRK(J+10) = IAND(IA,2)/2 
          ITRK(J+12) = IAND(IA,4)/4 
          IC = IC - 4 
110       CONTINUE
120     CONTINUE
C 
      NTRK = 0
      DO 130 I=1,28 
        IF (ITRK(I).EQ.1) NTRK = NTRK + 1 
130     CONTINUE
C 
      IENA = IAND(IA,8)/8 
C 
      RETURN
      END 
