<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="Version 0.73 - August 2023">
<title>FS 10.2-beta1 Update Notes</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="book">
<div id="header">
<h1>FS 10.2-beta1 Update Notes</h1>
<div class="details">
<span id="author" class="author">Version 0.73 - August 2023</span><br>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#_upgrading_from_10_1">2. Upgrading from 10.1</a>
<ul class="sectlevel2">
<li><a href="#_backup_your_operational_system">2.1. Backup your operational system</a></li>
<li><a href="#_fetch_10_2">2.2. Fetch 10.2</a></li>
<li><a href="#_login_as_prog">2.3. Login as prog</a></li>
<li><a href="#_set_new_make_time_environment_variables">2.4. Set new make-time environment variables</a></li>
<li><a href="#_make_the_fs">2.5. Make the FS</a></li>
<li><a href="#_update_station_code">2.6. Update station code</a></li>
<li><a href="#_make_the_station_software">2.7. Make the station software</a></li>
<li><a href="#_reboot">2.8. Reboot</a></li>
<li><a href="#_login_as_oper">2.9. Login as oper</a></li>
<li><a href="#_update_control_files">2.10. Update control files</a></li>
<li><a href="#_set_dbbc3_specific_environment_variables">2.11. Set DBBC3 specific environment variables</a></li>
<li><a href="#_remove_temporary_versions_of_feshplog">2.12. Remove temporary versions of fesh/plog</a></li>
<li><a href="#_optional_steps">2.13. Optional steps</a></li>
<li><a href="#_test_the_fs">2.14. Test the FS</a></li>
<li><a href="#_consider_when_to_update_your_backups">2.15. Consider when to update your backups</a></li>
</ul>
</li>
<li><a href="#_changes_since_10_1">3. Changes since 10.1</a>
<ul class="sectlevel2">
<li><a href="#_fs_changes">3.1. FS changes</a></li>
<li><a href="#_drudg_changes">3.2. drudg changes</a></li>
</ul>
</li>
<li><a href="#_update_ntp_configuration">Appendix A: Update NTP Configuration</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document covers the steps needed to update from FS <em>10.1</em> to
<em>10.2</em> (latest patch is <em>10.2.0</em>) and the changes in the new version.
Installing the new version (see the <a href="#_upgrading_from_10_1">Upgrading from 10.1</a> section
below) should be simpler than the update to <em>10.1</em> for most users.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Despite the next paragraph, <em>alpha</em> and <em>beta</em> releases are
not intended for operations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>FS <em>10.2</em> has been tested for a few configurations but not all
possible ones. You should test it carefully before using it for
operations. Please email Ed if you encounter problems so that we can
resolve them.</p>
</div>
<div class="paragraph">
<p>The changes in the FS and <em>drudg</em> for <em>10.2</em> are covered in the
<a href="#_changes_since_10_1">Changes since 10.1</a> section below. The most significant changes
are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for FSL11. The FSL11 distribution is based on Debian
<em>bullseye</em> and is the latest FSL<em>x</em> Linux distribution. The
installation instructions for FSL11 can be found at:
<a href="https://nvi-inc.github.io/fsl11/" class="bare">https://nvi-inc.github.io/fsl11/</a>.</p>
</li>
<li>
<p>Support for experiment names (session codes) of 16 characters or
less. This enables use of the new IVS 12-character session codes.</p>
</li>
<li>
<p>Support for the DBBC3 was extensively improved. It is now roughly
complete for the DDC firmware releases available as of June 2023.</p>
</li>
<li>
<p>The <em>plotlog</em> utility, for examining data in the log files, has been
expanded and updated. The changes include support for RDBEs, DBBC3s,
and additional data types including recorder performance statistics.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As always, we are deeply indebted to Jonathan Quick (HartRAO) for his
many significant contributions that go far beyond what is explicitly
mentioned here. For this particular release, his contributions include
feature suggestions and testing for DBBC3 support, as well as for many
non-DBBC3 specific features, and for documentation enhancements. Many
of the improvements that were made are due to his thoughtfulness and
diligence.</p>
</div>
<div class="paragraph">
<p>We thank Eskil Varenius and Jun Yang (both at Onsala) for bug reports
and feedback, particularly on DBBC3 related issues.</p>
</div>
<div class="paragraph">
<p>We thank Beppe Maccaferri (Medicina) for being a diligent tester
and reporting bugs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_upgrading_from_10_1">2. Upgrading from 10.1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You must have already upgraded to <em>10.1</em> according to the
<a href="../1/10.1.0.html">FS 10.1.0 Update Notes</a> document before
installing this update.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can make a <em>fresh</em> install of <em>10.2</em> on an FSL11 system
using the installation document, <a href="https://nvi-inc.github.io/fsl11/" class="bare">https://nvi-inc.github.io/fsl11/</a>.
Testers of previous <em>10.2</em> development versions, on any FSL<em>x</em>, can
follow the instructions here; some steps may have changed from
previous versions.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_backup_your_operational_system">2.1. Backup your operational system</h3>
<div class="paragraph">
<p>Having a back-up to return to will allow you to continue operations in
case something goes wrong with the installation. If you don&#8217;t have
your own scheme, and for more details, please see the
<a href="../../misc/install_reference.html#_making_a_back_up_before_installing">Making
a back-up before installing</a> section in the
<a href="../../misc/install_reference.html">Installation Reference</a>
document.</p>
</div>
<div class="paragraph">
<p>You can also use symbolic links with copies of your old operational
directories to switch back and forth between in your operational
<em>10.1</em> configuration and a test install of <em>10.2</em>. This is covered
in detail in the
<a href="../../misc/install_reference.html#_using_symbolic_links">Using
symbolic links</a> subsection of the section and document referenced
above.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fetch_10_2">2.2. Fetch 10.2</h3>
<div class="paragraph">
<p>There are two alternatives:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you are using FSL9, FSL10, FSL11, or another system that supports
connections to <em>github</em> and you are using <em>git</em> (as is recommended)
then as <em>prog</em> execute:</p>
<div class="literalblock">
<div class="content">
<pre>cd /usr2/fs-git
git fetch
git checkout -q 10.2.0-beta1</pre>
</div>
</div>
</li>
<li>
<p>If you are using FSL8 or are otherwise unable, or prefer not, to use
<em>git</em> (you will probably need to be <em>root</em>):</p>
<div class="paragraph">
<p>Refer to the
<a href="../../misc/release_model.html#_installing_from_an_archive">Installing
from an archive</a> subsection in the
<a href="../../misc/release_model.html">Release Model</a> document. Follow the
steps there, through the one that includes the option to set the
<em>/usr2/fs</em> link. Please note that:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p>For FSL8, or if you are otherwise unable to connect to <em>github</em>, you
will need the <strong>TIP</strong> in the <code><strong>wget</strong></code> step.</p>
</li>
<li>
<p>For the <em>tag</em> use <code>10.2.0-beta1</code>.</p>
</li>
<li>
<p>You will end using the &#8220;installing from an archive&#8221; procedure with
the step setting the link for <em>/usr2/fs</em> by running <strong><code>make
install</code></strong>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_login_as_prog">2.3. Login as prog</h3>
<div class="paragraph">
<p>If you are not already logged-in as <em>prog</em>, do that. This is necessary
for the remaining steps until <a href="#_reboot">Reboot</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_set_new_make_time_environment_variables">2.4. Set new make-time environment variables</h3>
<div class="paragraph">
<p>There are two alternatives:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>For FSL11, no new environment variables need to be set, skip to the
next step <a href="#_make_the_fs">Make the FS</a>.</p>
</li>
<li>
<p>For other FSL<em>x</em> Linux distributions, FSL10 and earlier, set the
environment variables <code>FS_F95_NO_ALLOW_ARGUMENT_MISMATCH</code> (even if not
using <em>f95</em>) and <code>FS_PYTHON_VERSION</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Some other non-FSL<em>x</em> distributions may need one or both set
as well.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
We don&#8217;t know if FS versions <em>10.&lt;x&gt;</em> will work for FSL7 and
older distributions as is, but please contact Ed if you run into
problems. We expect that they will be easy to fix.
</td>
</tr>
</table>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Update login <em>rc</em> files:</p>
<div class="paragraph">
<p>There are two alternatives:</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>If your <em>prog</em> login shell is <em>bash</em>, add the following to
<em>~prog/.profile</em>:</p>
<div class="literalblock">
<div class="content">
<pre>export FS_F95_NO_ALLOW_ARGUMENT_MISMATCH=1
export FS_PYTHON_VERSION=2</pre>
</div>
</div>
</li>
<li>
<p>If your <em>prog</em> login shell is <em>tcsh</em>, add the following to
<em>~prog/.login</em>:</p>
<div class="literalblock">
<div class="content">
<pre>setenv FS_F95_NO_ALLOW_ARGUMENT_MISMATCH 1
setenv FS_PYTHON_VERSION 2</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Logout of <em>prog</em> and back in</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_make_the_fs">2.5. Make the FS</h3>
<div class="paragraph">
<p>As <em>prog</em>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd /usr2/fs
make clean rmdoto rmexe all &gt;&amp; /dev/null
make -s</pre>
</div>
</div>
<div class="paragraph">
<p>No output from the last command indicates a successful <em>make</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you used <code>git fetch</code> during the short interval when the release&#8217;s
tag was <code>10.2-beta1</code>, you will get an error:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Makefile:35: *** no PATCHLEVEL value.  Stop.</pre>
</div>
</div>
<div class="paragraph">
<p>You can correct this with:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd /usr2/fs
git checkout main
git pull
git tag -d 10.2-beta1
git checkout -q 10.2.0-beta1</pre>
</div>
</div>
<div class="paragraph">
<p>Then re-execute the <code>make</code> commands.</p>
</div>
<div class="paragraph">
<p>Thanks to Rubén González (Ny-Ålesund) for reporting this.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_update_station_code">2.6. Update station code</h3>
<div class="paragraph">
<p>This step can <em>probably</em> deferred for now, if it is needed at all. If
you do need to make this change, it will not become necessary until
you receive schedule files with more than six characters in the name
(before the <em>.skd</em> or <em>.vex</em> extension) or you otherwise want to use
<em>.snp</em>, <em>.prc</em>, or <em>.log</em> files with names before the &#8220;dot&#8221; (<em>.</em>) of
more than eight characters. It will probably be some time before
schedules with longer names become available. However it is better to
not put off updating your software too long. There is a reasonable
chance that your software may not need any changes.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
You may be asked by a coordinating center or scheduler if
your station can handle the longer names. You should answer &#8220;no&#8221;
until you have made the necessary changes or verified that no changes
are needed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Click the &#8220;Details&#8221; toggle below for the full instructions.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>There are three issues that may need to be address (as <em>prog</em>): legacy
FORTRAN code, shared memory variables, and use of the <em>lognm</em> program.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Legacy FORTRAN code</p>
<div class="paragraph">
<p>If you have FORTRAN code in your station software, you should review
the changes in the <a href="#f95">f95</a> sub-item (if that link doesn&#8217;t work in
your browser, click on this link instead: <a href="#fsl1">FSL11</a>, open the
&#8220;Details&#8221; toggle below that location by clicking on it, go <code>Back</code> in
the browser, and finally click on the original link) of the
<a href="#_fs_changes">FS changes</a> section to see if any are applicable to your code.
Strictly speaking, they are not needed unless you are using FSL11, and
of course they can&#8217;t be fully tested until you are. As a result, you
may want to defer this until you are transitioning to FSL11 (or a later
FSL<em>x</em>).</p>
</div>
</li>
<li>
<p>Use of shared memory variables.</p>
<div class="paragraph">
<p>If your station software uses the C shared memory variables: <code>LLOG</code>,
<code>LPRC</code>, <code>LSKD</code>, <code>LSTP</code>, <code>LNEWPR</code>, <code>LNEWSK</code>, or <code>LEXPER</code>, you should
update to use <code>LLOG2</code>, <code>LPRC2</code>, <code>LSKD2</code>, <code>LSTP2</code>, <code>LNEWPR2</code>, <code>LNEWSK2</code>
or <code>LEXPER2</code> instead, respectively.</p>
</div>
<div class="paragraph">
<p>Likewise, if you use the corresponding FORTRAN <em>fscom_dum.i</em> variables
via the <code>fs_get_<em>variable</em></code>/<code>fs_set_<em>variable</em>()</code> routines
in <em>newlb/prog.c</em>, you will need to change to use the new variables
and routines.</p>
</div>
<div class="paragraph">
<p>The old variables all have a length of <code>8</code> characters. The new
variables have a length defined by the <code>MAX_SKD</code> parameter (currently
with a value of <code>18</code>) in <em>include/params.h</em> (C) and
<em>include/params.i</em> (FORTRAN).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These strings in these variables, old and new, are blank padded,
not terminated with a <code>null</code> byte.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The old variables are still available and should work fine until you
use <em>.snp</em>, <em>.prc</em>, or <em>.log</em> file names with more than eight
characters before the &#8220;dot&#8221; (<em>.</em>), in which case the values in the
old variables will be truncated versions.</p>
</div>
</li>
<li>
<p>Use of the <em>lognm</em> program</p>
<div class="paragraph">
<p>If you use the <em>lognm</em> program, you should make sure the callers can
handle log names up to <code>18</code> characters in length.</p>
</div>
<div class="paragraph">
<p>The <em>lognm</em> program returns a string no longer than the actual length
of the log name. There should be no issues for log names of eight
characters or less even if you have not made any adjustments to handle
longer names.</p>
</div>
</li>
</ol>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_make_the_station_software">2.7. Make the station software</h3>
<div class="paragraph">
<p>The layout of some variables in shared memory has changed. Even if
you have not updated your station code, you should re-<em>make</em> your
station code to be safe. If <em>/usr2/st/Makefile</em> is set-up in the
standard way, you can do this with (as <em>prog</em>):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd /usr2/st
make rmdoto rmexe all</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reboot">2.8. Reboot</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This will make sure the FS server is stopped and shared
memory is reallocated.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_login_as_oper">2.9. Login as oper</h3>
<div class="paragraph">
<p>The remaining steps are to be performed by <em>oper</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_update_control_files">2.10. Update control files</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update the <em>dbbc3.ctl</em> control file.</p>
<div class="paragraph">
<p>A line was inserted for the DDC_E firmware version. You can update
your file with:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd /usr2/control
/usr2/fs/misc/dbbc3ctlfix dbbc3.ctl</pre>
</div>
</div>
<div class="paragraph">
<p>The script will insert the needed line. It will report an error if the
file has more, or less, than the number of expected non-comment lines.
If that happens, you should correct the file.</p>
</div>
<div class="paragraph">
<p>The script will also attempt to update the comments that have changed
since FS <em>10.1</em>. If your file has the original comments from that
version they will be updated. If not, or they occurred more than once,
a warning will be printed. You may want to look into fixing any
discrepancies. You can use the example file,
<em>/usr2/fs/st.default/control/dbbc3.ctl</em>, as a guide for making
changes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The original <em>dbbc3.ctl</em> file will be saved as <em>dbbc3.ctl.bak</em>
in case you need to recover.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_set_dbbc3_specific_environment_variables">2.11. Set DBBC3 specific environment variables</h3>
<div class="paragraph">
<p>There are two alternatives:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you are not using a DBBC3, no new environment variables need to
be set, skip to <a href="#_remove_temporary_versions_of_feshplog">Remove temporary versions of fesh/plog</a>.</p>
</li>
<li>
<p>If you are using a DBBC3, you <em>may</em> need to set some environment
variables. A reasonable first approach would be to not set any at this
point, but you should revisit this issue once you have the new FS
installed and otherwise working. A full discussion of the variables
can be found in the
<a href="../1/dbbc3_ops.html#_dbbc3_specific_environment_variables">DBBC3
specific environment variables</a> appendix of the
<a href="../1/dbbc3_ops.html">FS DBBC3 Operations Manual</a>. In particular,
the section
<a href="../1/dbbc3_ops.html#_determining_what_values_to_use">Determining what
values to use</a> may be helpful.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_remove_temporary_versions_of_feshplog">2.12. Remove temporary versions of fesh/plog</h3>
<div class="paragraph">
<p>If you have installed temporary fixes of <em>fesh</em> and/or <em>plog</em> (or
other scripts) outside the normal FS source directory, you should
probably remove them. All previously supplied updates to work-around
various issues have been incorporated into this release.</p>
</div>
<div class="paragraph">
<p>Typically these temporary versions would have been installed in
<em>~oper/bin</em> and/or have aliases defined for them. We think very few
stations have installed temporary versions. If you can&#8217;t remember, you
can check for an alias, for example for <em>plog</em>, with the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>alias | grep plog</pre>
</div>
</div>
<div class="paragraph">
<p>To check if you are are using local copy in your <code>PATH</code> you can use
the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>which plog</pre>
</div>
</div>
<div class="paragraph">
<p>Instead of just deleting temporary versions or aliases, we suggest you
rename them, for example, maybe <em>plog.old</em> for <em>plog</em>. That way they
will still be accessible until you have verified that the new standard
versions work for you. If you find any fixes are missing, please
contact Ed so they can be added.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you use a local version of <em>feshp</em>, it should not need to be
changed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_optional_steps">2.13. Optional steps</h3>
<div class="paragraph">
<p>The steps in this section are optional, but you may find them useful.
All are to be performed by <em>oper</em>, except as noted. For each item,
click the &#8220;Details&#8221; toggle for the full instructions.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>For DBBC(2)/DBBC3 users, set default values for the <code>cont_cal</code>
command.</p>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>If you use continuous cal with a DBBC(2) or DBBC3, you can set the
default values for the <code>cont_cal</code> command parameters in your <code>initi</code>
procedure. This works for all parameters after the first, <code><em>state</em></code>
(<code>on</code>/<code>off</code>), which must be set every time (the default is <code>off</code>). The
remaining device parameters (<code><em>polarity</em></code>, <code><em>frequency</em></code>, and
<code><em>option</em></code>) all default to not being commanded, but will remember a
commanded value as the new default. The value commanded for the
<code><em>samples</em></code> (and filtering for the DBBC3) parameter is also remembered
as the default. This allows you to customize the values for your
system and use the <em>drudg</em> generated <code>cont_cal</code> commands to control
whether continuous calibration, and optionally what polarity, is used.</p>
</div>
<div class="paragraph">
<p>You can of course change the defaults after <code>initi</code> has run if you
want. This could be useful, for example, if you change receivers. You
might want to have a SNAP procedure in the <code>station</code> library for this
to minimize the required typing.</p>
</div>
<div class="paragraph">
<p>For example, for a DBBC(2), you can set the default <code><em>polarity</em></code>, to
<code>2</code>, <em>frequency</em>` to <code>120</code>, an <code><em>option</em></code> to <code>1</code>, and <code><em>samples</em></code> to
<code>5</code> with:</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This is not intended to be a realistic example.
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>cont_cal=undef,2,5,120,1</pre>
</div>
</div>
<div class="paragraph">
<p>The use of <code>undef</code> prevents any of the device parameters being sent to
at this time, but you can use <code>on</code> or <code>off</code> if you prefer and any set
values will be sent.</p>
</div>
<div class="paragraph">
<p>Similarly, for the DBBC3 you would use:</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This is not intended to be a realistic example.
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>cont_cal=undef,2,120,1,5</pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
The parameter order for the DBBC3 is different from the DBBC(2).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Please see <code><strong>help=cont_cal</strong></code> for full details on this command for your
equipment.</p>
</div>
</div>
</details>
</li>
<li>
<p><a href="#set_x11_widths">Setting X11 window widths</a><a id="set_x11_widths"></a>:
Increase window size to 146 columns</p>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>The new default window width for FSL11 of the <code>erchk</code>, <code>login_sh</code>,
<code>oprin</code>, and <code>scnch</code> windows is 146 columns. The main advantage of
this is that longer log lines can be displayed without wrapping. This
includes the standard fixed length error messages, none of which will
wrap and should be easier to read. Making this change is recommended
if your display can support it. If not, you might adjust the windows
to the widest that can be handled conveniently (see the <strong>TIP</strong> below
for using different sizes).</p>
</div>
<div class="paragraph">
<p>To update the usual <em>~/.Xresources</em> file, enter the commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd
/usr2/fs/misc/xresourcesfix .Xresources</pre>
</div>
</div>
<div class="paragraph">
<p>You will need to log-out on the console and log back in to see the
full change.</p>
</div>
<div class="paragraph">
<p>The script will report an error if it found the geometry value for one
of the four windows defined more than once; the extras should probably
deleted. A warning will be reported if any of those the geometry value
were not found. That may be okay, but may also indicate that the entry
was not in the format the script expected. That may need to be looked
into.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The original <em>.Xresources</em> file will be saved as
<em>.Xresources.bak</em> in case you need to recover.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>The script also includes command line options for setting a different
width, either for all the windows or for specific ones. Enter
<code><strong>/usr2/fs/misc/xresourcesfix</strong></code> for the details. You can try multiple
times with different values if between runs of the script you use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mv .Xresources.bak .Xresources</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have other, special purpose, X11 resource files, you may want
to run the script on them also. You may want to make the same changes
for <em>prog</em> (and any AUID accounts) as well.</p>
</div>
</div>
</details>
</li>
<li>
<p>Use <code>set revert-all-at-newline on</code> for <em>readline</em> to prevent the
<em>bash</em>, <em>oprin</em>, and <em>pfmed</em> histories from being changed.</p>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>This will prevent history entries (particularly in <em>bash</em>, <em>oprin</em>,
and <em>pfmed</em>) from being changed if they are edited and then not used.
Their changing in this way can be quite frustrating, but it is up to
you if you want to prevent it. In FSL11, the default is to prevent it
(this is installed by the <code>make install</code> step for the FS). If you are
using FSL10 or FSL9 (but not FSL8), you can prevent it by creating the
file, <em>~/.inputrc</em> with the commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cat &gt;~/.inputrc &lt;&lt;EOT
\$include /etc/inputrc
set revert-all-at-newline on
EOT</pre>
</div>
</div>
<div class="paragraph">
<p>You may want to make the same change for <em>prog</em> (and any AUID
accounts) as well.</p>
</div>
<div class="paragraph">
<p>To make this active for:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p><em>bash</em>&#8201;&#8212;&#8201;you will need to restart the shell, probably by logging
out and back in again</p>
</li>
<li>
<p><em>oprin</em>&#8201;&#8212;&#8201;if the FS is running, you will need to restart the FS
display client (or restart the FS if you are not using the display
server)</p>
</li>
<li>
<p><em>pfmed</em>&#8201;&#8212;&#8201;if it is running, exit and restart it</p>
</li>
</ul>
</div>
</div>
</details>
</li>
<li>
<p>Update your NTP configuration to make it more modern.</p>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>This change will make the output of the <code>check_ntp</code> procedure and the
contents of <em>/etc/ntp.conf</em> file easier to read. Instructions are
included for how to remove display of NTP related FQDNs and IP
addresses in the log, if that is an issue for your site.</p>
</div>
<div class="paragraph">
<p>If you want to make this change, it can be deferred to a convenient
time. The instructions can be found in the
<a href="#_update_ntp_configuration">Update NTP Configuration</a> appendix.</p>
</div>
</div>
</details>
</li>
<li>
<p>If you are using <em>refresh_spare_usr2</em> with FSL6-FSL9, update the
script.</p>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>If you are using FSL6-9 and have not hit the problem this change is
correcting, you may not need it. That, and the fact that there are
very few users of this script, is why this change is listed as
optional (even though in some sense it is necessary). See the
<a href="#refresh_spare_usr2">refresh_spare_usr2</a> FS change below (if that
link doesn&#8217;t work in your browser, click on this link instead:
<a href="#fs_bugs">Make miscellaneous bug fixes</a>, open the &#8220;Details&#8221; toggle
below that location by clicking on it, go <code>Back</code> in the browser, and
finally click on the original link).</p>
</div>
</div>
</details>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_test_the_fs">2.14. Test the FS</h3>
<div class="paragraph">
<p>Generally speaking, a fairly thorough test is to run a test
experiment. Start with using <em>drudg</em> to rotate a schedule,
<em>drudg</em>ing it to make <em>.snp</em> and <em>.prc</em> files and listings. Perform
any other pre-experiment preparation and tests that you normally
would, then execute part of the schedule, and perform any normal
post-experiment plotting and clean-up. The idea here is to verify that
everything works as you expect for normal operations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_consider_when_to_update_your_backups">2.15. Consider when to update your backups</h3>
<div class="paragraph">
<p>It would be prudent to wait until you have successfully run an
experiment or two and preferably received word that the experiment(s)
produced good data.</p>
</div>
<div class="paragraph">
<p>The chances of needing to use your backup from before updating should
be small. If you are using the RAID system of FSL10 or FSL11, you can
copy the backup to the (now assumed bad) updated disk. You can then
either use the restored disk for operations and/or try the FS update
again. The RAID based recoverable testing procedures for FSL10
(<a href="https://nvi-inc.github.io/fsl10/raid.html#_recoverable_testing" class="bare">https://nvi-inc.github.io/fsl10/raid.html#_recoverable_testing</a>) and
FSL11 (<a href="https://nvi-inc.github.io/fsl11/raid.html#_recoverable_testing" class="bare">https://nvi-inc.github.io/fsl11/raid.html#_recoverable_testing</a>)
have more options for recovery. Managing this is a lot easier and
safer if you have a third disk.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_changes_since_10_1">3. Changes since 10.1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are separate subsections with summaries of the changes in the FS
and <em>drudg</em>.</p>
</div>
<div class="paragraph">
<p>Clickable links such as <a href="https://github.com/nvi-inc/fs/issues/36">#36</a>
connect to specific issues reported at
<a href="https://github.com/nvi-inc/fs/issues" class="bare">https://github.com/nvi-inc/fs/issues</a>.</p>
</div>
<div class="paragraph">
<p>A complete history of changes can be found using the <code>git log</code> command
from within the FS <em>git</em> archive directory, usually <em>/usr2/fs-git</em>.</p>
</div>
<div class="paragraph">
<p>Each change is listed as a numbered title, usually with a few summary
sentences, followed by a &#8220;Details&#8221; <em>toggle</em>, like:</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>Details are shown here.</p>
</div>
</div>
</details>
<div class="paragraph">
<p>that can be clicked on to toggle showing (or not showing) the details.
In this way, you can view the summary as a list and only reveal the
details of items that interest you. The summary sentences and/or the
details toggle may be omitted if they would not add any new
information, usually because it is already covered in the numbered
title item, summary, and/or the details are very brief.</p>
</div>
<div class="sect2">
<h3 id="_fs_changes">3.1. FS changes</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#FSL11">FSL11</a>:<a id="FSL11"></a> Support FSL11</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The code was updated for FSL11 (Debian <em>Bullseye</em>). The FSL11
distribution is latest FSL<em>x</em> Linux distribution. The installation
instructions can be found at: <a href="https://nvi-inc.github.io/fsl11/" class="bare">https://nvi-inc.github.io/fsl11/</a>. The
primary changes in the FS to support FSL11 are:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p>Making typographic changes to be compatible with the new <em>f95</em>
compiler version.</p>
</li>
<li>
<p>Adding <em>python3</em> versions of existing <em>python</em> scripts.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Users of pre-FSL11 systems will need to set some environment variables
for <em>prog</em> before compiling. These are described in the installation
instructions (above) as well as in the &#8220;Details&#8221; collapsible section
below.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Remove use of <code>stime()</code></p>
<div class="paragraph">
<p>In FSL11, <code>stime()</code> is not available for newly linked applications. It
would need to be replaced with <code>clock_settime()</code>. It was not replaced
because the functionality it was used for, setting the system time,
hasn&#8217;t been available to non-<em>root</em> users since the FS was ported to
Linux (FS9), circa 1995. The FS must <em>never</em> be run by <em>root</em>.</p>
</div>
</li>
<li>
<p>New required environment variables for pre-FSL11 systems.</p>
<div class="paragraph">
<p>Two new environment variables, <code>FS_F95_NO_ALLOW_ARGUMENT_MISMATCH</code> and
<code>FS_PYTHON_VERSION</code>, were added to assist with compilation on
pre-FSL11 systems. They only need to be set once in <em>prog</em>'s login
<code>rc</code> files on these systems. Their use is explained in the next two
items.</p>
</div>
</li>
<li>
<p><a href="#f95">f95</a>:<a id="f95"></a> Changes for new <em>f95</em> compiler version</p>
<div class="paragraph">
<p>The <em>f95</em> compiler, version <em>6.3.0</em>, in FSL11 has stricter
requirements for the use of octal, hexadecimal, and binary constants
and for argument type agreement in calls to functions and subroutines
than in previous FSL<em>x</em> versions. The FS code changes made were:</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Reformat octal and hexadecimal constants</p>
<div class="paragraph">
<p>Hexadecimal, octal, and binary constants can only be used in <code>data</code>
statements or in the intrinsic function <code>int()</code>. There is a compiler
option, <code>-fallow-invalid-boz</code>, to relax this requirement. However, it
does not cover the case of actual arguments to a function at this
time. There are many of those, so it was decided to just change all
non-<code>data</code> statement use of these constants to parameters. They were
wrapped in <code>int()</code> in the <code>parameter</code> statements. The parameter names
were chosen so the constants could be globally replaced in the FORTRAN
code without overflowing the 72-character line limit. Existing octal
and hexadecimal constants in <code>parameter</code> statements were wrapped in
<code>int()</code>. The FS code did not have any binary constants.</p>
</div>
<div class="paragraph">
<p>This change can cause the symbol table for <em>f2c</em> (used by <em>fort77</em>
when it is the compiler) to overflow. The symbol table size for that
case was increased by adding the option <code>-Nn1604</code>.</p>
</div>
</li>
<li>
<p>Add use of <code>-fallow-argument-mismatch</code> compiler option.</p>
<div class="paragraph">
<p>Argument type mismatches are common in the code, particular for when
Hollerith data is being handled and sometimes <code>interger*4</code> and
sometimes <code>integer*2</code> arrays are passed as the same argument for
functions and subroutines. Since this error is benign and there was an
option to ignore it (and it worked), it was used.</p>
</div>
<div class="paragraph">
<p>For <em>f95</em> in previous FSL<em>x</em> versions, this option is not accepted
(or needed). To allow compilation on these older systems, use of an
environment variable <code>FS_F95_NO_ALLOW_ARGUMENT_MISMATCH</code> was added. If
it is set to <code>1</code>, the complier option is not used. Some other
non-FSL<em>x</em> distributions may need the variable set as well. For
these older systems, this needs to be set once in <em>prog</em>'s login <code>rc</code>
files then it is necessary to re-login into the <em>prog</em> account before
compiling.</p>
</div>
<div class="paragraph">
<p>For FS installations that are using the <em>fort77</em> complier, it is still
recommended that the variable be set to <code>1</code>. That way the
configuration will be forward compatible with a possible change to
<em>f95</em>.</p>
</div>
</li>
<li>
<p>Remove mixing of <code>integer*4</code> and <code>integer*2</code> as arguments for
intrinsic <code>and()</code>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Changes for <em>python3</em>.</p>
<div class="paragraph">
<p>FSL11 has limited support for <em>python2</em>. In particular, there is no
<code>numpy</code>. The two largest <em>python</em> programs in the FS, <em>gnplt</em> and
<em>logpl</em>, require <code>numpy</code>. Since most of the work converting was for
these two programs, it seemed best if they all were converted. There
is not expected to by any <em>python2</em> in the next Debian release,
<em>bookworm</em>.</p>
</div>
<div class="paragraph">
<p>The older <em>python2</em> version are still included in case they are
needed. For older systems that are unable to use the <em>python3</em>
versions (this includes FSL10 and older FSL<em>x</em> systems), an
environment variable <code>FS_PYTHON_VERSION</code> was added. If it is set to
<code>2</code>, the <em>python2</em> versions are linked. For these older systems, this
needs to be set once in <em>prog</em>'s login <code>rc</code> files then it is necessary
to re-login into the <em>prog</em> account before compiling.</p>
</div>
<div class="paragraph">
<p>It may be that on some of these older systems (this includes FSL10 and
older FSL<em>x</em> systems), the <em>python3</em> versions of the scripts could
be used if more Debian packages for missing <em>python3</em> modules are
installed. This has not been tested. If you try this, please let Ed
know your results. In the meantime. the original <em>python2</em> scripts are
available.</p>
</div>
<div class="paragraph">
<p>The programs affected are: <em>logpl</em>, <em>gnplt</em>, <em>monpcal</em>, <em>be_client</em>,
<em>s_client</em>, and <em>rdbemsg</em>. The <em>python3</em> source code is in directories
with the same name. The <em>python2</em> source code can be found in
directories with the same name, but with <code>-python2</code> appended. It is
expected that the <em>python2</em> and <em>python3</em> versions will be maintained
in parallel for the foreseeable future.</p>
</div>
<div class="paragraph">
<p>Four steps were used to convert the code to <em>python3</em>:</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Run code through the <em>2to3</em> utility.</p>
<div class="paragraph">
<p>This utility makes many of the typographic changes needed going from
<em>python2</em> to <em>python3</em>. It can installed, as <em>root</em>, with:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>apt-get install 2to3</pre>
</div>
</div>
</li>
<li>
<p>Run the code through the <em>reindent</em> utility.</p>
<div class="paragraph">
<p>This utility will re-indent a script using 4-space indents and no hard
tabs. It can be installed, with:</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>First, as <em>root</em>:</p>
<div class="literalblock">
<div class="content">
<pre>apt-get install pip</pre>
</div>
</div>
</li>
<li>
<p>Then as <em>prog</em> (in <em>bash</em>):</p>
<div class="literalblock">
<div class="content">
<pre>cd ~
pip3 install reindent
PATH="~/.local/bin:$PATH"</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The <code>PATH=&#8230;&#8203;</code> statement needs to be re-executed for each new
login or new <em>bash</em> shell.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Change the <em>shebang</em> lines to use <em>python3</em></p>
<div class="paragraph">
<p>The <em>python3</em> variant must be explicitly referenced for FSL11.</p>
</div>
</li>
<li>
<p>Fix runtime issues that were discovered during testing</p>
<div class="paragraph">
<p>We believe we have found all of these, but perhaps not. The most
common paths through the code were exercised, but there maybe some
obscure paths, particularly in <em>logpl</em> and <em>gnplt</em> that may still have
problems. Please report any issues you find to Ed. It should be easy
to post (and install) a patch that will fix them.</p>
</div>
<div class="paragraph">
<p>The fixes made so far include:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p>Wrap the third argument of <code>range()</code> in <code>int()</code></p>
</li>
<li>
<p>Change the <code>import</code> from <code>idlelib.TreeWidget</code> to <code>idlelib.tree</code></p>
</li>
<li>
<p>Replace the use of <code>popen2</code> with <code>subprocess</code> and use text encoding
for sub-process I/O</p>
</li>
<li>
<p>Fix archaic use of <code>strip()</code></p>
</li>
<li>
<p>Use <code>encode()</code>/<code>decode()</code> for socket I/O</p>
</li>
<li>
<p>Change <code>isAlive()</code> to <code>is_alive()</code> for threads</p>
</li>
<li>
<p>Use <code>key=functools.cmp_to_key()</code> for (time) sort.</p>
</li>
<li>
<p>Set <code>rcond=-1</code> in <code>linalg.lstsq()</code> to preserve old behavior</p>
</li>
<li>
<p>Use <code>median()</code> rather than divide-by-two to find the median of a
sorted list.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The installation of <em>2to3</em>, <em>pip</em>, and <em>reindent</em> can be reversed (if
nothing else is installed in <em>~prog/.local</em>) with:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>As <em>root</em>:</p>
<div class="literalblock">
<div class="content">
<pre>apt-get purge 2to3
apt-get purge pip</pre>
</div>
</div>
</li>
<li>
<p>As <em>prog</em> (be careful with this command in case other things than
<em>reindent</em> are installed in <em>~prog/.local</em>):</p>
<div class="literalblock">
<div class="content">
<pre>rm -rf /usr2/prog/.local</pre>
</div>
</div>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</details>
</li>
<li>
<p><a href="#Names">Names</a>:<a id="Names"></a> Support names of 18 characters or less for
the <code>schedule</code>, <code>proc</code>, and <code>log</code> commands.</p>
<div class="paragraph">
<p>With the last two characters of the names usually taken up by the
two-character station code, this allows experiment names to be 16
characters or less. This provides support for the IVS Master File <em>v2</em>
&#8220;session code&#8221; lengths of 12 characters or less. The <em>fsvue</em> and
<em>logex</em> programs were not updated for this change.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>This change is largely transparent to the users. The four visible
effects are:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p>The length and/or location of the <code>SCHED=&#8230;&#8203;</code> and <code>LOG=&#8230;&#8203;</code> fields
in the <code>System Status Monitor</code> display (<em>monit2</em>) were changed. The
<code>SCHED=..</code> field now occupies the space previously used by both
<code>SCHED=&#8230;&#8203;</code> and <code>LOG=&#8230;&#8203;</code>. The <code>LOG=&#8230;&#8203;</code> field is now in the lower
right where the (no longer used) <code>HEAD PASS # &#8230;&#8203;</code> field was
previously located.</p>
</li>
<li>
<p>The display of procedure libraries for the <code>pfdl</code> command in <em>pfmed</em>
now shows only three libraries per line. A key was also added to
describe the prefix letters.</p>
</li>
<li>
<p>The <code>log=&#8230;&#8203;</code> command now traps a log name that is too long.
Previously, it just truncated longer names to eight characters.</p>
</li>
<li>
<p>The <em>lognm</em> script will put out log names up to 18 characters in
length, previously the maximum was eight.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <em>fsvue</em> and <em>logex</em> programs were no updated for this change. If
you are using these programs, we will look into updating them, please
contact Ed. If they were working before, they should continue to work
for names of eight characters or less.</p>
</div>
<div class="paragraph">
<p>Internally, new variables were appended to shared memory for the
schedule, schedule procedure, station procedure, and log file names
and the experiment (schedule) name. The old variables are still
present and hold up to the first eight characters of longer names.
This is intended to make the changes backward compatible for station
programs (such as <em>antcn</em> and <em>telegraf</em>) that are pinned to the FS
<em>10.0</em> memory layout until they can be updated for the new variables.
Of course, longer names will appear truncated in the downstream
programs until they have been updated. The new and old variables are
described in the <a href="#_update_station_code">Update station code</a> step above.</p>
</div>
</div>
</details>
</li>
<li>
<p>Update DBBC3 support</p>
<div class="paragraph">
<p>Several changes were made to DBBC3 support.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>DBBC3 personality DDC_E support was added. The handling of TPI data
was adjusted to agree with what was observed in the field and
environment variables were added to allow further adjustments to be
made in the field and to control other features.  Information on
setting the IF target values was added. DBBC3 non-continuous (<em>spot</em>)
calibration support was completed. <em>monit7</em> was improved for
continuous calibration. Averaging (and optionally <em>filtering</em>) of
continuous calibration data was added. The <code>tpicd=tsys</code> command was
enabled. Not sending some device parameters of the <code>cont_cal</code> command
was made an option. The polarization of the IF was added to the T<sub>sys</sub>
display (<em>monit7</em>). The condition <code>ddc</code> was added to the <code>if</code> command
for the DBBC3. The order of commands for DBBC3 syncing was changed.
The order of TPI values for DBBC3 <code>iftp<em>X</em></code> commands was changed to
<code><em>on</em></code> then <code><em>off</em></code>.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Add support for the DBBC3 personality DDC_E</p>
<div class="paragraph">
<p>This personality is a close analog of the the DDC_U personality, but
has better bandpass shapes and is limited to only eight BBCs per
Core3H board.</p>
</div>
<div class="paragraph">
<p>It can be selected by setting the rack in <em>equip.ctl</em> to
<code>dbbc3_ddc_e</code>. The <em>dbbc3.ctl</em> file has an additional line for the
version (see the <a href="#_update_control_files">Update control files</a> step above for details on
installing this change). Using the string <code>nominal</code> for the BBCs/IF in
this file selects a value of eight for this case. The
<a href="../1/dbbc3_ops.html">FS DBBC3 Operations Manual</a> was updated to
include the new personality.</p>
</div>
</li>
<li>
<p>Adjust handing of TPI data to agree with what was observed (closing
<a href="https://github.com/nvi-inc/fs/issues/97">#97</a> and
<a href="https://github.com/nvi-inc/fs/issues/192">#192</a>).</p>
<div class="paragraph">
<p>The ordering of TPI data returned by the DBBC3 does not agree with the
documentation. Particularly LSB/USB are swapped and in some cases
cal-on/cal-off are swapped. The FS handling of the data was adjusted
to agree with what was observed in the field. In addition, environment
variables were added to allow the handling to be adjusted in the field
since there are some variations among firmware releases, particularly
for early ones, and changes may occur in future firmware releases.</p>
</div>
<div class="paragraph">
<p>Environment variables were also added for multicast data to control
whether time is expected, to adjust the returned time, and to set how
often to report an incorrect firmware version.</p>
</div>
<div class="paragraph">
<p>The default values for all these variables are appropriate for the
understood cases, but may need to be adjusted for some older firmware
versions. The use of these variables are covered in detail in the
<a href="../1/dbbc3_ops.html#_dbbc3_specific_environment_variables">DBBC3
specific environment variables</a> appendix of the
<a href="../1/dbbc3_ops.html">FS DBBC3 Operations Manual</a>.</p>
</div>
<div class="paragraph">
<p>Thanks to Eskil Varenius (Onsala) and Beppe Maccaferri (Medicina) for
discovering the TPI ordering issue. Thanks to Jon Quick (HartRAO) for
providing a test-bed system for detailed exploration of the issue.</p>
</div>
</li>
<li>
<p>Add information to the DBBC3 <code>if<em>X</em></code> command <code>help</code> page for the
correct <code><em>target</em></code> levels.</p>
<div class="paragraph">
<p>The nominal level is <code>32000</code>, but needs to be reduced if the BW of the
input signal is narrower than the nominal 4 GHz. Approximate target
levels for three different input BWs was added. This information was
also added to the <a href="../1/dbbc3_ops.html">FS DBBC3 Operations Manual</a>,
as the <a href="../1/dbbc3_ops.html#_if_target_levels">IF target levels</a>
section, along with some information on detecting the problem and
correcting it.</p>
</div>
<div class="paragraph">
<p>Thanks to Jun Yang (Onsala) for finding this issue and pointing out
that the compression factor of <em>onoff</em> can be used to identify it.
Thanks to Sven Bornbusch (MPIfR) for explaining the cause and
providing guidance on reasonable levels. Thanks to Jon Quick (HartRAO)
for suggesting using T<sub>sys</sub> values as a method for finding the correct
level.</p>
</div>
</li>
<li>
<p>Complete support of DBBC3 non-continuous (<em>spot</em>) calibration
(closing <a href="https://github.com/nvi-inc/fs/issues/194">#194</a>)</p>
<div class="paragraph">
<p>As part of this change, the terminology <em>spot calibration</em> was added
as a synonym for noncontinuous calibration for DBBC3s. Support for
device mnemonics <code>formmbbc</code> and <code>formif</code> were added to the T<sub>sys</sub>
related commands. The DBBC3 T<sub>sys</sub> display window (<em>monit7</em>) can now
display spot calibration data. Example procedures were added.</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><em>Spot calibration</em> terminology</p>
<div class="paragraph">
<p>The documentation now uses <em>spot calibration</em> as a synonym for
noncontinuous calibration, which is explicitly switching the noise
diode on and off for T<sub>sys</sub> measurements. This usage will eventually
extend beyond DBBC3s.</p>
</div>
</li>
<li>
<p>Add support for <code>formbbc</code> and <code>formif</code> device mnemonics for DBBC3
T<sub>sys</sub> related commands.</p>
<div class="paragraph">
<p>As with with other racks, they refer to the detectors of devices
configured for recording: <code>formbbc</code> for BBC channels, <code>formif</code> for IFs
that have BBC channels being recorded. They were added for use with
<code>tpi</code>, <code>tpical</code> <code>tpdiff</code>, <code>caltemp</code>, and <code>tsys</code> commands. Although
DBBC3 spot calibration was supported in FS <em>10.0</em>, it was not possible
to support these mnemonics until FS <em>10.1</em> and the introduction of the
<code>core3h_mode</code> command. At that time it was thought (hoped) that spot
calibration would not be needed for the DBBC3.</p>
</div>
</li>
<li>
<p>Include spot calibration results in the DBBC3 T<sub>sys</sub> monitor
display window,</p>
<div class="paragraph">
<p>The values of course only update when a new measurement is made. If
the T<sub>cal</sub> has not been defined, <code>Ntcal</code> is shown in inverse video. If
no spot calibration measurements have been made (and continuous
calibration is not enabled), <code>N cal</code> is shown in inverse video. Values
that exceed <code>999.9</code>, erroneous values (negative, infinity, and
overflow), and other setup errors, (BBC or LO not defined), are shown
as dollar signs, <code>$</code>.</p>
</div>
</li>
<li>
<p>Add example spot calibration procedures for the DBBC3.</p>
<div class="paragraph">
<p>Example <code>caltsys</code> and <code>caltsys_man</code> procedures were added to the
<em>st.default/proc/d3fbstation.prc</em> example library.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Thanks to Beppe Maccaferri (Medicina) and Jun Yang (Onsala) for
pointing out support was needed and discovering that the existing spot
calibration support still worked for the DBBC3.</p>
</div>
</li>
<li>
<p>Improve <em>monit7</em> for continuous calibration.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>N cal</code> is now displayed when continuous calibration is not
enabled (and no <em>spot</em> calibration is available).</p>
<div class="paragraph">
<p>Previously it was <code>Nccal</code> (and only applied to continuous
calibration).</p>
</div>
</li>
<li>
<p>Invalid T<sub>sys</sub> values (overflow, infinity, and the cal-off TPI
being zero) are shown with a cyan background.</p>
<div class="paragraph">
<p>The cases are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the BBC &#8220;on&#8221; and/or &#8220;off&#8221; TPI values overflow (<code>65536</code>),
<code>ovrfl</code> is shown.</p>
</li>
<li>
<p>If the &#8220;on&#8221; and &#8220;off&#8221; TPI values are equal <code>&#160;inf&#160;</code> is
shown.</p>
</li>
<li>
<p>If the &#8220;off&#8221; TPI value is zero, <code>off=0</code> is shown.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Negative T<sub>sys</sub> values are shown with a magenta background.</p>
<div class="paragraph">
<p>This is intended to bring attention to the polarity being incorrect.</p>
</div>
</li>
<li>
<p>Allow more digits for negative T<sub>sys</sub></p>
<div class="paragraph">
<p>A larger range of negative values is shown by dropping the fractional
digit as needed. The number of significant digits shown is not reduced.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Add averaging (and optionally <em>filtering</em>) of continuous DBBC3
T<sub>sys</sub> data.</p>
<div class="paragraph">
<p>This was missing from <em>10.1</em> and is useful with low power noise diodes
and/or varying RFI to provide a more stable T<sub>sys</sub> value.
Additionally, an experimental <em>filter</em> feature was added for removing
RFI affected samples.</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Averaging of T<sub>sys</sub> data</p>
<div class="paragraph">
<p>This works differently from the DBBC2 continuous calibration averaging
which forms an average T<sub>sys</sub> value by averaging the TPI counts (as
opposed to the T<sub>sys</sub> values). That approach gives the highest
precision for non-AGC data, but has somewhat reduced accuracy with AGC
if there are significant level changes. It is good to keep in mind
that T<sub>sys</sub> is a station diagnostic and doesn&#8217;t have the same accuracy
requirements as amplitude calibration, which uses the raw TPI count
data.</p>
</div>
<div class="paragraph">
<p>For the DBBC3, the averages are formed using exponential smoothing of
the T<sub>sys</sub> values themselves. The decay time-constant for the
smoothing is set, in seconds, by the <code><em>samples</em></code> parameter of the FS
<code>cont_cal</code> command. If multicast packets are lost, that is not taken
into account; the data is treated as though it had uniform one second
spacing.</p>
</div>
<div class="paragraph">
<p>The averages are restarted for either of these events:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p>The <code>tpicd</code> command is used to reinitialize the sampling
configuration. This may indicate a setup change. A consequence of this
is that the <code><strong>tpicd</strong></code> command (with no parameters) can be used to
restart the averages manually at any time.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If <em>tpicd</em> is configured for continuous logging
(<code>tpicd=yes,&#8230;&#8203;</code>, which is not used normally for observing), using
<code>tpicd</code> to reset the averages will cause logging to be started if it
is not already).
</td>
</tr>
</table>
</div>
</li>
<li>
<p>A change in any FS <code>cont_cal</code> command parameters.</p>
<div class="paragraph">
<p>The <code>cont_cal</code> command <code><em>samples</em></code> parameter also sets the number of
cycles of the <code>tpicd</code> command for logging the averaged T<sub>sys</sub> data. It
is expected that the cycle period for <code>tpicd</code> will normally be set to
<code>100</code> centiseconds, in which case the T<sub>sys</sub> values will be logged
every <code><em>samples</em></code> seconds. If the cycle period of <code>tpicd</code> is set to
longer than <code>100</code> centiseconds, the logging period will be
correspondingly longer than the time-constant.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The special value of <code>0</code> for <code><em>samples</em></code> disables averaging and sets
the number of cycles of <code>tpicd</code> for logging the T<sub>sys</sub> data to one.
The logged (and displayed) T<sub>sys</sub> values are truly statistically
independent only if <code>0</code> is used. This was the behavior of FS <em>10.1</em>.</p>
</div>
</li>
<li>
<p>Filtering of T<sub>sys</sub> values</p>
<div class="paragraph">
<p>Nine new parameters in <em>cont_cal</em> command are used to control
filtering (see <code><strong>help=cont_cal</strong></code> or
<a href="https://github.com/nvi-inc/fs/blob/main/help/cont_cal.j__" class="bare">https://github.com/nvi-inc/fs/blob/main/help/cont_cal.j__</a>). In
addition to enabling filtering with a <code><em>filter</em></code> parameter of <code>1</code>, the
user can specify a threshold, in percent of the average for a device,
per IF, for rejecting values from being included in the average. This
feature is experimental and may be changed and other filtering schemes
may be added.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for pointing out that averaging was
missing, as well suggesting filtering, the algorithm, and many
fruitful discussions and feedback on the implementation.</p>
</div>
</li>
<li>
<p>Enable <code>tpicd=tsys</code> for DBBC3.</p>
<div class="paragraph">
<p>Each time this command is used, there is a one-time display of the log
entires of the T<sub>sys</sub> when continuous calibration is in use. This is
useful for getting a static display of the current T<sub>sys</sub> values.</p>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for pointing out that this was missing.</p>
</div>
</li>
<li>
<p>Add not commanding of the <code><em>polarity</em></code>, <code><em>frequency</em></code>, and
<code><em>option</em></code> device parameters as an option in the DBBC3 <code>cont_cal</code>
command.</p>
<div class="paragraph">
<p>The behavior is now the same as for the DBBC (i.e., DBBC2). These
parameters are not sent to the device unless they have been specified
in the FS <code>cont_cal</code> command. Thereafter they are sent with the
previously specified value. (A value to <code>-1</code> can be used to disable
sending of the parameter again.)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As described in the <a href="#cont_cal_defaults">Setting cont_cal
defaults</a> change item in this document, it is now possible to use
<code>undef</code> as the first (<code><em>state</em></code>) parameter to set the defaults for
these parameters without sending them to the device.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Add polarization to <code>IF</code>/<code>RF</code> header in the DBBC3 T<sub>sys</sub> monitor
display (<em>monit7</em>).</p>
<div class="paragraph">
<p>If the LO and its polarization are defined for the displayed IF, the
polarization will be shown as <code>(L)</code> or <code>(R)</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>(L)</code> or <code>(R)</code> are displayed regardless of what
polarization pair is in use: Left/Right, Horizontal/Vertical, or X/Y.
Following the usual alphabetical order convention within a pair: <code>LR</code>,
<code>HV</code>, and <code>XY</code>, you can assume: <code>L</code>=<code>H</code>=<code>X</code> and <code>R</code>=<code>V</code>=<code>Y</code>. Until the
FS is updated to recognize pairs other than Left/Right, you need to
know which pair is in use to interpret what is shown.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for suggesting showing the polarization
and the format.</p>
</div>
</li>
<li>
<p>Add DBBC3 <code>ddc</code> as a condition for the <code>if</code> command.</p>
<div class="paragraph">
<p>Currently only DDC personalities are supported for DBBC3, but this
inclusion makes DBBC(2) <code>caltsys</code> procedures for <em>spot</em> cal compatible
with the DBBC3 and will support possible future expansion to other
personalities.</p>
</div>
</li>
<li>
<p>Change the order of commands for DBBC3 syncing.</p>
<div class="paragraph">
<p>The sequence of commands for syncing the DBBC3 were changed in the
<a href="../1/dbbc3_ops.html#_sync_time">Sync time</a> section of the
<a href="../1/dbbc3_ops.html#_alternate_core3h_board_configuration_method">Alternate
Core3H board configuration</a> appendix of the <a href="../1/dbbc3_ops.html">FS
DBBC3 Operations Manual</a>.</p>
</div>
<div class="paragraph">
<p>There is now a <code>pps_sync</code> command both before and after the <code>timesync</code>
commands. Despite this improvement using this method is still not
recommended.</p>
</div>
<div class="paragraph">
<p>Thanks to Sven Dornbusch (MPIfR) for providing the best sequence of
commands.</p>
</div>
</li>
<li>
<p>Change the order of TPI values for DBBC3 <code>iftp<em>X</em></code> commands to
<code><em>on</em></code> then <code><em>off</em></code></p>
<div class="paragraph">
<p>This disagrees with the DBBC3 documentation, but agrees with what the
DBBC3 returns for polarity <code>0</code>. It also agrees with the order of all
other <code><em>on</em></code> and <code><em>off</em></code> values in the DBBC3 documentation (for
<code>bbc<em>NNN</em></code>, multicast IF, and multicast BBC data).</p>
</div>
</li>
</ol>
</div>
</div>
</details>
</li>
<li>
<p>Improve <em>plotlog</em></p>
<div class="paragraph">
<p>This utility, for examining data in the log files, has been
extensively expanded and updated. The changes include support for
RDBEs, DBBC3s, and additional data types including recorder
performance statistics.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>Each change is summarized in the paragraph below (apologies to
<em>Harper&#8217;s</em> magazine&#8217;s <em>Findings</em> columns), more details follows.</p>
</div>
<div class="paragraph">
<p>The default plot device for X11 displays was changed to be useful.  If
the FS is running and no log was specified, the data in the current FS
log will be plotted. Added recorder performance statistics. The
plotting of clock data was expanded. Plots of wind speed and direction
were added. Plotting CDMS data was added. T<sub>sys</sub> plots for DBBC3s and
RDBEs were added. Phase-cal tone plots for RDBEs were added. Plots of
LSB Mark IV decoder phase-cal data were added. Phases outside
[-180°,+180°] are now automatically marked as bad, but can be included
with the <code>-Y</code> option. Clock and cable values outside (-10,+10) seconds
are now automatically marked as bad, but can be included with the <code>-C</code>
option. Plots of Wettzell style <code>/rx/</code> data were added. Bad points are
now displayed as open circles and slightly off the upper (or right)
edge of the plots. Any values in time plots that did not decode are
now consistently displayed at the upper edge of the plots.  Plotting
of phase differences attempts to provide better vertical plot limits
if the differences cluster around ±180°. Support for the <em>giza</em> plot
library was added. Bad horizontal tick marks in some <code>-p</code> plots were
fixed. Some command line options were changed and some added. Use of
a nonexistent command line option is now trapped. The <code>-h</code> (help)
output was improved. The version was bumped to <em>2.4</em>. Some
improvements were made in the code.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change the plot device for X11 displays to <code>/xw</code> (closing
<a href="https://github.com/nvi-inc/fs/issues/183">#183</a>).</p>
<div class="paragraph">
<p>If the <code>DISPLAY</code> variable is set and no other plot device was
specified, the program assumes it should plot on the X11 display. The
old default X11 plot device, <code>/xterm</code>, didn&#8217;t work. That device
apparently worked for some pre-FSL8 distribution. For as far back as
FSL8 <code>/xterm</code> seems to be available, but doesn&#8217;t work. So this has
probably been a problem since at least 2009. <em>plotlog</em> was introduced
(using <code>/xterm</code>) in FS <em>9.8.0</em> (July 2005) with commit
52398939d5f867b2e7ab4e18f8886babda6dfaae. FSL5 (<em>woody</em>) was probably
active at that time. <code>/xw</code> now seems to be a good choice in FSL8 and
later.</p>
</div>
</li>
<li>
<p>Plot the data in the current log file if the FS is running and no
log was specified on the command line.</p>
</li>
<li>
<p>Add recorder performance statistics</p>
<div class="paragraph">
<p>Time plots were added for:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist disc">
<ul class="disc">
<li>
<p>Delay in recorder starting (seconds)</p>
</li>
<li>
<p>Shortness of recording length (seconds)</p>
</li>
<li>
<p>Missing bytes (count)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>All information is inferred from the <code>scan_name=&#8230;&#8203;</code> command, the
command that starts the recording (<code>disk_record=on</code> or
<code>mk6<em>x</em>=record=&#8230;&#8203;</code>), and the results of <code>scan_check</code>. The FS,
<em>cplane</em> (Mark 6), and <em>jive5b</em> forms of <code>scan_check</code> are supported.</p>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for suggestions about what information
to report.</p>
</div>
</li>
<li>
<p>Expand clock plotting.</p>
<div class="paragraph">
<p>The clock plotting was expanded to plot all data collected by commands
with names that contain <code>fmout</code>, <code>gps</code>, and <code>maser</code>. Additionally,
RDBE <code>dot2pps</code> and <code>dot2gps</code> data from multicast and <code>dbe_pps_offset</code>
and <code>dbe_gps_offset</code> commands are plotted. The DBBC3 <code>pps2dot</code> data
from multicast and the <code>mcast_time</code> command are plotted. For the RDBE
and DBBC3, if both command stream and multicast versions are
available, only the multicast is plotted unless the <code>-B</code> option is
used, which will include both.</p>
</div>
<div class="paragraph">
<p>Opposite signed versions of the same offset (e.g. <code>gps-fmout</code> and
<code>fmout-gps</code>) are no longer combined in one plot (with appropriately
adjusted signs). Keeping them separate makes the plots more
representative of the log contents.</p>
</div>
<div class="paragraph">
<p>Thanks to Karine Le Bail and Rüdiger Haas (both at Onsala) for
arranging to produce experiment logs with <code>mcast_time</code> data for
testing.</p>
</div>
</li>
<li>
<p>Add plotting of wind speed and direction.</p>
<div class="paragraph">
<p>If fields for these data are present in the <code>wx/</code> log entries they
will be plotted. This is in contrast to temperature, pressure and
humidity, which are always plotted if <code>wx/</code> entires are present.
Missing values for any fields are shown as &#8220;out-of-range&#8221; (near the
top-edge of the corresponding plot).</p>
</div>
</li>
<li>
<p>Add plotting of CDMS data.</p>
<div class="paragraph">
<p>As with <code>cable/</code> data, the default is to plot the values as the change
in one-way delay in picoseconds, relative to the first valid value
found in the log. Also as with <code>cable/</code>, the <code>-r</code> option can be used
to plot the raw values instead. Values greater than <code>999998.5</code>, which
only occurs for error conditions, are marked as &#8220;bad&#8221;.</p>
</div>
</li>
<li>
<p>Add plotting of RDBE and DBBC3 T<sub>sys</sub> values from multicast.</p>
<div class="paragraph">
<p>By default, only the data from the first encountered detector (other
than channel <code>00</code> for RDBEs) from each IF band is plotted. The <code>-m</code>,
and <code>-M</code>, options can be used to select, and deselect, different sets
of detectors based on regular expressions. This is similar in function
to the <code>-g</code>/<code>-G</code> options (the latter, formerly the <code>-e</code> option),
except <code>-m</code>/<code>-M</code> only apply to RDBE and DBBC3 T<sub>sys</sub> data and are
applied as they are read-in instead of when they are plotted. This
makes them a bit faster since there are typically many values
involved.</p>
</div>
</li>
<li>
<p>Add plotting of RDBE phase-cal data from multicast</p>
<div class="paragraph">
<p>By default, only the first encountered tone from each IF is plotted.
The <code>-d</code>, and <code>-D</code>, options can be used to select, and deselect,
different sets of tones based on regular expressions. This is similar
in function to the <code>-g</code>/<code>-G</code> options (the latter, formerly the <code>-e</code>
option), except that <code>-d</code>/<code>-D</code> are only applied to RDBE phase-cal
tones and are applied as they are read-in instead of when they are
plotted. This makes them a bit faster since there are typically many
values involved.</p>
</div>
<div class="paragraph">
<p>The <code>-j</code> (T<sub>sys</sub> normalization) and <code>-k</code> options are not supported for
RDBE phase-cal yet.</p>
</div>
<div class="paragraph">
<p>The (new) <code>-v</code> option plots phase differences between tones in the
same RDBE IF channel.</p>
</div>
</li>
<li>
<p>Add plotting of the first encountered LSB phase-cal tone per
converter for the Mark IV decoder (and K5TS) output.</p>
<div class="paragraph">
<p>This is in addition to the already supported first encountered USB
tone per converter.</p>
</div>
<div class="paragraph">
<p>For phase difference plots (options <code>-lanw</code>) when both USB and LSB
tones are present, the differences for only one tone per converter are
plotted. If USB and LSB is present for an individual converter, the
difference between the side-bands is plotted after the differences for
pairs of different converters.</p>
</div>
</li>
<li>
<p>Mark phases outside [-180°,+180°] as bad by default.</p>
<div class="paragraph">
<p>This can useful for Mark IV decoder communication errors. All phase
can be included with the new <code>-Y</code> option.</p>
</div>
</li>
<li>
<p>Mark clock and cable values outside (-10,10) seconds as bad by
default.</p>
<div class="paragraph">
<p>These are generally not useful values, but can be included if needed
with the new <code>-C</code> option. Normally they only occur if a counter is
being used and a bad value is returned.</p>
</div>
</li>
<li>
<p>Add support for Wettzell&#8217;s style of <code>/rx/</code> data.</p>
<div class="paragraph">
<p>The most useful fields for plotting in Wettzell&#8217;s <code>/rx/</code> data are of
the form <code><em>number</em>[<em>units</em>]</code> where <code><em>number</em></code> is a floating point
number and <code><em>units</em></code> is one of <code>dB</code>, <code>dBm</code>, <code>degC</code>, or <code>MHz</code>. By
default, <em>plotlog</em> will only plot what seems to be the most
interesting of these, which are the <code>degC</code> fields in any record and
the <code>dBM</code> fields in the <code>IF<em>xx</em></code> records (the <code>dBM</code> and <code>MHz</code> fields
in the <code>lo<em>x</em></code> records, and the <code>dB</code> fields in the <code>IF<em>xx</em></code>
records, are usually static). The <code>-W</code> option can be used to plot all
the <code><em>number</em>[<em>units</em>]</code> fields.</p>
</div>
<div class="paragraph">
<p>It is assumed that only one field of a given <code>units</code> type exists per
log entry type. The latter is determined by the first field of the log
entry, typically <code>lo<em>x</em></code> or <code>IF<em>xx</em></code>, for a given <code><em>x</em></code> or <code><em>xx</em></code>.
For example, <code>loa</code>, <code>lob</code>, <code>IFAH</code>, <code>IFAV</code> are all different types for
this purpose. If there is more than one field with a given <code>units</code>
type in a log entry type, the plot for that type combination will be
garbled. As of this writing there are no known cases of this.</p>
</div>
</li>
<li>
<p>Display bad points as open circles and move them slightly off the
top (or right) plot edge.</p>
<div class="paragraph">
<p>Displaying them as open circles makes it clearer that they are
different than the &#8220;good&#8221; points which are closed circles. Moving
them slightly off the top (or right) edge improves their visibility
and eliminates ambiguity about which plot they are part of in stacked
plots.</p>
</div>
</li>
<li>
<p>Always display values that don&#8217;t decode at the upper edge of time
plots.</p>
<div class="paragraph">
<p>Previously for some data types, specifically <code>cable</code>, <code>rx</code>, <code>sx</code>, <code>sk</code>
and <code>fmout-gps</code>, samples were omitted if they did not decode as
floating point numbers. Now they are displayed at the upper edge of
the plot, as occurs for other data types, so their presence is
visible. The only cases where samples are completely omitted now is
when the form of the entry is too garbled to be identified or the
command is missing (possibly because it timed-out). These two
situations may be noticeable if the plot for a data type is missing
entirely or is sparser than expected.</p>
</div>
</li>
<li>
<p>Plotting of phase differences attempts to provide better vertical
plot limits if the differences cluster around ±180°.</p>
<div class="paragraph">
<p>If there is a gap in the phase differences of 180° or more and there
is some data in both the bottom and top of the [-180°,+180°] range,
the data is adjusted to be around +180°. This doesn&#8217;t fix all overly
large vertical scales, but it improves the worst ones.</p>
</div>
</li>
<li>
<p>Add support for the <em>giza</em> plot library.</p>
<div class="paragraph">
<p>The <em>pgperl</em> package provided by some Linux distributions (for example
FSL11) may use the <em>giza</em> plotting library instead of <em>pgplot</em>.
Unfortunately, <em>giza</em> is not yet a fully compatible replacement for
<em>pgplot</em>. Several differences have been noticed, so far, in <em>giza</em>
version <code>1.2.0</code> (which is used by FSL11):</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
FSL11 offers an optional non-standard version of <em>pgperl</em> that
uses <em>pgplot</em>. Every effort has been made to make this &#8220;safe,&#8221;
however using it is at your own risk. Installing FSL11 will not
include it by default. You can find the directions for installing this
non-standard package at:
<a href="https://nvi-inc.github.io/fsl11/installation.html#_install_pgplot_version_of_pgperl" class="bare">https://nvi-inc.github.io/fsl11/installation.html#_install_pgplot_version_of_pgperl</a>.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="ulist disc">
<ul class="disc">
<li>
<p>The default line-width is thicker. It appears to actually be what
would be line-width <code>2</code> in <em>pgplot</em>. It appears that the line-widths
are off by one (see the next item as well).</p>
</li>
<li>
<p>Setting the line-width accepts <code>0</code>, which gives the same width as
<code>1</code>, the minimum, in <em>pgplot</em>. However, line-width <code>0</code> causes the plot
borders to not appear for device <code>/xw</code>.</p>
</li>
<li>
<p>The closed circle graph marker <code>17</code> is significantly less distinct.</p>
</li>
<li>
<p>The open circle graphs markers, symbols <code>20</code> through <code>27</code> (and some
others), have thicker lines than in <em>pgplot</em>. For <code>20</code> and <code>21</code>, it is
difficult to make out that they are open.</p>
</li>
<li>
<p>Graph markers are clipped if they are on the edge of a plot instead
of allowing them to spill over. This makes them harder to see.</p>
</li>
<li>
<p>Automatic spacing of vertical tick marks is overly dense.</p>
</li>
<li>
<p>Requested horizontal tick spacings are only approximately respected.</p>
</li>
<li>
<p>The environment variables <code>PGPLOT_BACKGROUND</code> and
<code>PGPLOT_FOREGROUND</code> for setting the plot colors are not respected.
Versions that start with <code>GIZA_</code> also do not work.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>If the script detects that <em>giza</em> is in use, it will adjust the
line-width, except for plot device <code>/xw</code>, and use a larger open circle
for "`bad'" points. The resulting plots are usable, but not as good as
with <em>pgplot</em>. These adjustments can be disabled, individually, with
<code>-Z</code> option if they cause a problem or if a later version of <em>giza</em>
has better agreement with <em>pgplot</em>. If <em>giza</em> is not detected, the
<code>-Z</code> option can be used for force the adjustments. Please see the <code>-h</code>
output for more details.</p>
</div>
<div class="paragraph">
<p>One advantage of <em>giza</em> is that a PDF file is available as an output
device.</p>
</div>
</li>
<li>
<p>Fix bad horizontal ticks for <code>-p</code> option.</p>
<div class="paragraph">
<p>Previously except for the last page, there was an extra set of
horizontal tick marks in the bottom plot on each page. Additionally,
the horizontal tick labels on these pages were for the extra set of
ticks. This has been fixed. There is no extra set of tick marks and
the labels are correct.</p>
</div>
</li>
<li>
<p>Change the command line options.</p>
<div class="paragraph">
<p>In addition to adding the <code>-B</code>, <code>-C</code>, <code>-d</code>/<code>-D</code>, <code>-m</code>/<code>-M</code>, <code>-W</code>,
<code>-Y</code>, and <code>-Z</code> options as mentioned above, the following changes were
made:</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The old <code>-e</code> option was moved to <code>-G</code> (now paired with <code>-g</code>) for
parallel construction with <code>-D</code>/<code>-d</code> and <code>-M</code>/<code>-m</code> and to make room
for the new <code>-e</code> option.</p>
</li>
<li>
<p>The new <code>-e</code> option can be used to specify the rack type as
<code>dbbc3</code> or <code>rdbe</code>, This can be useful for DBBC3 and RDBE log snippets
that don&#8217;t contain an <code>equip</code> line near the start. This only affects
DBBC3 and RDBE T<sub>sys</sub>, and RDBE phase-cal, processing.</p>
</li>
<li>
<p>The new <code>-l</code> option can used to specify the location, which is
only used in the plot titles. This can be useful for log snippets that
don&#8217;t contain a <code>location</code> line.</p>
</li>
<li>
<p>The new <code>-S</code> option can be used to require a leading slash before
the command name for <code>wx/</code>, <code>cable/</code>, and <code>cdms/</code> entries. For example
with <code>-S</code>, the search string for <code>wx/</code> entries is <code>/wx/</code>. This is
useful, for example, if there are non-data entry of the form <code>wx/</code> and
the data entries are of the form, <code>/wx/.</code> The program accepts the form
without the leading <code>/</code> because that is what some stations produce for
the data entries and that will match for stations that do use as a
leading <code>/</code>. This option is only to help for stations with non-data
entries that do not have the leading <code>/</code> and data entries with the
leading <code>/</code>.</p>
</li>
<li>
<p>The new <code>-T</code> option can used to specify a string to replace the
log file name in the plot titles. This can be particular useful if
more than one log is used on the command line, resulting in a
&#8220;merged&#8221; plot.</p>
</li>
<li>
<p>The old <code>-v</code> (version) option was moved to <code>-V</code> to make room for
the new <code>-v</code> option, which plots phase differences between phase-cal
tones within an RDBE IF.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Trap attempts to use a nonexistent command line option.</p>
<div class="paragraph">
<p>The script now stops if this occurs instead of continuing with an
error message that might be missed.</p>
</div>
</li>
<li>
<p>Improve the <code>-h</code> help output.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>A suggestion for a file name extension for the <code>/vps</code> device was
added.</p>
</li>
<li>
<p>The explanation of the <code>-2</code> option was improved.</p>
</li>
<li>
<p>How to set the background and foreground plot colors was added.</p>
<div class="paragraph">
<p>This can be used to change the background/foreground colors to
white/black from black/white. The latter are used by default for the
X11 display with some FSL<em>x</em>.</p>
</div>
</li>
<li>
<p>An explanation was added that out-of-range phase values in the
<code>-p</code> plots are placed near the right-hand edge of the plots.</p>
</li>
<li>
<p>An explanation of what happens when more than one log file is
specified on the command line, i.e., the data from all the logs is
merged.</p>
</li>
<li>
<p>Add explanation of the option philosophy:</p>
<div class="paragraph">
<p>Generally, the philosophy is that if no options are specified the
script should do something that is likely to be useful. Options can be
added to tune the behavior for different situations. Scripts or
aliases can be used if any options are needed routinely.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Bump version number to <em>2.4</em>.</p>
</li>
<li>
<p>Improve the code</p>
<div class="paragraph">
<p>A few internal improvements were made:</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The efficiency of finding the <code>location</code> log record was improved
by only parsing for it if it has not been found before (and was not
specified by <code>-l</code>). As a result, only the first one encountered (or
the <code>-l</code> value) is used now.</p>
</li>
<li>
<p>The help output was changed to a multi-line string for easier
maintenance.</p>
</li>
<li>
<p>The order of options in the <code>Getopts</code> call was alphabetized.</p>
</li>
<li>
<p>Removing DOS end-of-lines (to help with files that were
transferred via machines with such end-of-lines) was improved so that
it did not need to be handled in each search string.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</details>
</li>
<li>
<p><a href="#cont_cal_defaults">Setting cont_cal
defaults</a><a id="cont_cal_defaults"></a>: Cleanup setting parameter defaults
for the DBBC and DBBC3 <code>cont_cal</code> commands.</p>
<div class="paragraph">
<p>Add <code>undef</code> as a value for the <code><em>state</em></code> parameter to not command the
device. Change the default value for the <code><em>samples</em></code> parameter to be
the previous value.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>The <code>cont_cal</code> commands are unique among FS commands in that the
defaults for most of their parameters are the previous values
commanded. This occurs in an attempt to simplify <em>drudg</em>'s
generation of the <code>cont_cal=&#8230;&#8203;</code> commands in the setup procedures
without it having to know additional details of the station. The
concept is that the user can set the value of the parameters <em>drudg</em>
doesn&#8217;t know about (<code><em>frequency</em></code>, <code><em>option</em></code>, and <code><em>samples</em></code>) in the
<code>initi</code> procedure and then they will be the default for those
parameters in the commands that <em>drudg</em> generates.</p>
</div>
<div class="paragraph">
<p>With this approach, <em>drudg</em> only needs to set the continuous
calibration <code><em>state</em></code> (<code>on</code> or <code>off</code>) and optionally, if the <code><em>state</em></code>
is <code>on</code>, the <code><em>polarity</em></code> (<code>0</code>, <code>1</code>, <code>2</code>, or <code>3</code>). If the other
parameters change for different receivers, something additional will
be required, such as commanding new defaults when there is a receiver
change.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><em>drudg</em> can be configured to not set the <code><em>polarity</em></code> and then that can
come from the previous value used by the command.</p>
</div>
<div class="paragraph">
<p>The <em>skedf.ctl</em> options for controlling how <em>drudg</em> handles the
<code>cont_cal</code> command are <code>cont_cal</code> and <code>cont_cal_polarity</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Two things were missing to make the scheme work in a general way.
First, there was no way to set the defaults without commanding the
device. This can be an issue if there is no correct choice for the
<code><em>state</em></code> and/or some values may cause a device problem. Using <code>undef</code>
for the <code><em>state</em></code> (instead of <code>on</code> or <code>off</code>) will now suppress sending
the parameters to the device.</p>
</div>
<div class="paragraph">
<p>Secondly, due to an oversight, it was not possible to set the default
for the <code><em>samples</em></code> parameter. As result, if a value other than <code>10</code>
was used, it had to be edited into each <code>cont_cal=&#8230;&#8203;</code> command.  This
has been fixed so that the default for the <code><em>samples</em></code> will be the
previous value (initially <code>10</code>).</p>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for pointing out that the implementation
was incomplete and fruitful discussions about how to complete it.</p>
</div>
</div>
</details>
</li>
<li>
<p><a href="#shutdown">Server shutdown</a><a id="shutdown"></a>: Shutdown display server
on <code>terminate</code> (closes
<a href="https://github.com/nvi-inc/fs/issues/176">#176</a>).</p>
<div class="paragraph">
<p>When the display server is in use, terminating the FS now also
shutdowns the server. An interlock was introduced to prevent
termination if it would also stop active <em>autoftp</em> and/or <em>fs.prompt</em>
instances.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>Previously, if the display server was in use, it continued running in
background when the FS was terminated; now it will shutdown. Not
shutting down was introduced in commit
<code>85b24dc67111d82371c3fd0b850b19174840e0e4</code>, and first released in FS
<em>10.0.0</em>, as part of a larger scheme to serve client web pages. In the
short-term, that plan is not being followed through on and the change
had some negative impacts for local use. Manually stopping the server
was required in certain cases:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p>If <em>antcn</em>, or another local program opens an X11 application, say
for example, for a dialog box to let the operator select the antenna,
the application will appear on that display. If later an operator on a
different display wants to restart the FS, the server would have to be
stopped before restarting the FS for the X11 application to appear on
the new display.</p>
</li>
<li>
<p>To update the environment variables used by the FS</p>
</li>
<li>
<p>To change the user that owns the FS processes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Manually stopping the server is no longer required in these, or any
other, cases.</p>
</div>
<div class="paragraph">
<p>A small downside of this change is that if the FS is terminated and
restarted in quick succession, there may be a socket conflict (while
the old server instance cleans up) that prevents the restart. This can
be handled by waiting a moment and trying to restart again.</p>
</div>
<div class="paragraph">
<p>An implication of stopping the server is that any running <em>autoftp</em>
and <em>fs.prompt</em> processes will also be terminated. This is
undesirable, especially in the case of <em>autoftp</em> since any active data
transfers would be terminated. To avoid this, an interlock was
introduced. When the server is in use and any <em>autoftp</em> or <em>fs.prompt</em>
instances are active, termination will be prevented with explanatory
error messages. If it is necessary terminate, an override parameter,
<code>force</code>, can be used:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>terminate=force</pre>
</div>
</div>
<div class="paragraph">
<p>To keep things simple, the previous override parameter,
<code>disk_record_ok</code>, for terminating if disk recording is active has been
eliminated and that functionality is now included in the <code>force</code>
parameter as well. See <code><strong>help=terminate</strong></code> for more explanation.</p>
</div>
<div class="paragraph">
<p>The interlock for preventing termination if <em>pfmed</em> is active was
moved to be before the interlocks that can be overridden with <code>force</code>.
It is not possible to override the <em>pfmed</em> interlock and there is no
point using <code>force</code> if termination will be blocked by <em>pfmed</em> anyway.</p>
</div>
<div class="paragraph">
<p>The <a href="../../../misc/env_vars.html#_runtime_variables">Runtime
variables</a> section of the <a href="../../../misc/env_vars.html">FS
Environment Variables</a> document was updated to reflect this change.</p>
</div>
<div class="paragraph">
<p>The <a href="../0/fsserver_changes.html">FS 10.0.0 Server changes</a> document
was updated to reflect this change.</p>
</div>
</div>
</details>
</li>
<li>
<p>Add <em>streamlog</em> utility (closes
<a href="https://github.com/nvi-inc/fs/issues/64">#64</a>).</p>
<div class="paragraph">
<p>The <em>streamlog</em> utility is a script that outputs log entries as they
are written. It can be used by itself or with other programs that
filter for specific log entries. It will provide the most complete
output when the display server is enabled, but should also be useful
when it is not.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>By default, if the FS is already running, the script will output log
entries to <code>stdout</code> (for simple interactive use, this is the user&#8217;s
terminal) as they are generated. A small number of entries may be lost
when the FS is started. When the display server is not enabled, a
small number of entries may be lost when the active log is changed.</p>
</div>
<div class="paragraph">
<p>The script has four command line options. Generally speaking they
should <em>not</em> be used with <em>streamlog</em> in <em>stpgm.ctl</em>. The options are:</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>-d</code>&#8201;&#8212;&#8201;display stream</p>
<div class="paragraph">
<p>This option is only available if the display server is enabled. It
outputs the display server stream instead of the log stream. The
display stream is what is displayed in the log display window by the
FS client. There are several differences between what is is shown in
the log display window and what goes in the log. The most significant
of these are:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p>The log display output uses a shorter time-tag field.</p>
</li>
<li>
<p>Some output lines are suppressed in the log display window because
they would be overwhelming and would generally not be helpful for
interactive use.</p>
</li>
<li>
<p>Some FS error messages are not shown in the log display window
because the operator has suppressed them with the <code>tnx</code> command.</p>
</li>
<li>
<p>The log display window includes some output that is not in the log,
specifically the FS startup and termination messages and some program
error messages.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>-h</code>&#8201;&#8212;&#8201;help output</p>
</li>
<li>
<p><code>-s</code>&#8201;&#8212;&#8201;scroll-back</p>
<div class="paragraph">
<p>When the display server is enabled and the script is started and/or
the FS is started, any log entries in the scroll-back buffer will also
be output. This may reduce the number of lines that might be lost when
the FS is started.</p>
</div>
<div class="paragraph">
<p>If the display server is not enabled, up to 20 (a little more than the
number of lines in the typical log header) old log lines will be
output when the script is started, the active file log is changed, or
the FS is started. This may result in some lines being output more
than once. It may reduce the number of lines that will be missed
during these transitions.</p>
</div>
</li>
<li>
<p><code>-w</code>&#8201;&#8212;&#8201;wait for FS start</p>
<div class="paragraph">
<p>Wait for the FS to start and/or continue to wait for the FS to be
restarted if it is terminated.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The limitations and considerations for why these options should <em>not</em>
be used in <em>stpgm.ctl</em> are:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p>The '-d' option can be used in <em>stpgm.ctl</em> if the display server is
in use. However, it would be safer to use the log output (no <code>-d</code>)
instead. If it is used without the display server enabled, it will
crash the FS immediately after start-up.</p>
</li>
<li>
<p>The <code>-h</code> option is not useful in <em>stpgm.ctl</em>. Its use will cause the
FS to crash immediately after start-up if the display server is not
enabled. It will also crash the FS if the display server is in enabled
and it it is used in an <code>n</code> line in <em>stpgm.ctl</em>.</p>
</li>
<li>
<p>The <code>-s</code> option can be used in <em>stpgm.ctl</em> but is of marginal value.
It may reduce the number of lines that might be lost at FS start-up.
With the display server not enabled, it may reduce the number of lines
lost at the transition to a new log.</p>
</li>
<li>
<p>The <code>-w</code> option is not useful in <em>stpgm.ctl</em> and will cause problems
in some cases if the display server is not enabled.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Thanks to Dave Horsley (Hobart) for coming up with the idea for this
script, the initial version, and many of the incremental improvements.</p>
</div>
</div>
</details>
</li>
<li>
<p>Make miscellaneous enhancements.</p>
<div class="paragraph">
<p>About eight additional small features were changed or added. These
enhancements included two new utility scripts and cleanup of several
small issues.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>No longer ring the bell for large structure correction warnings.
Increase the default X11 window width. Prevent problems with <em>erchk</em>
when the display server is not in use. Use <code>set revert-all-at-newline
on</code> to prevent old commands in the history from being altered. Add
script for calculating \(\mathit{\frac{G}{T}}\). Improve
recommended NTP configuration. Improve <em>pfmed</em>. Add <em>rdbe30_mon.py</em>
script.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change the warning for a large structure size correction in <em>onoff</em>
to not ring the bell.</p>
<div class="paragraph">
<p>The error number was change from <code>-7</code> to <code>7</code>. It was also expanded to
handle four character device mnemonics, which was missing before.</p>
</div>
<div class="paragraph">
<p>This also means that the warning will no longer show-up in <em>erchk</em> and
<em>sterp</em>.</p>
</div>
</li>
<li>
<p>Increase default X11 window size to 146.</p>
<div class="paragraph">
<p>The new default window widths for the <code>erchk</code>, <code>login_sh</code>, <code>oprin</code>,
and <code>scnch</code> windows is 146 columns. The advantages of the new width is
that it is the smallest that will allow:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist disc">
<ul class="disc">
<li>
<p>Standard error messages displayed from the log to fit in the
<code>login_sh</code> window without wrapping (a minimum of 141 columns is
required for this)</p>
</li>
<li>
<p>Standard error messages displayed with the default largest
indentation of four asterisks (plus a space) in the <code>erchk</code> window to
fit without wrapping (a minimum of 146 columns is required for this)</p>
</li>
<li>
<p>All four of these windows to have an aligned right edge if their
left edges are aligned with the left edge of the screen,</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Of course, it is entirely up to you what widths you want to use for
your system and that will depend on your display. A script,
<em>misc/xresourcesfix</em> is included that will allow you to adjust the
widths for these windows, either all the same, or different for each
window. If your <em>erchk.ctl</em> uses more than four characters of
indentation, you will need to increase the width correspondingly to
avoid wrapping. See the <a href="#set_x11_widths">Setting X11 window widths</a>
sub-step in the <a href="#_optional_steps">Optional steps</a> above for the details.</p>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for encouraging this recognition that
more modern systems usually have more display real estate and that it
should be used.</p>
</div>
</li>
<li>
<p>Prevent <em>erchk</em> issues when the display server is not enabled.</p>
<div class="paragraph">
<p>This is to guard against accidentally starting <em>erchk</em> if the display
server is not running. This might happen, for example, if the multiple
copies copies of <em>erchk</em> are normally used when the display server is
running. Two fixes were made that only affect <em>erchk</em> when the display
server is not in use:</p>
</div>
<div class="ulist disc">
<ul class="disc">
<li>
<p><em>erchk</em> can no longer be started if the FS is not running</p>
</li>
<li>
<p>Multiple copies of <em>erchk</em> cannot be started.</p>
<div class="paragraph">
<p>This would cause each copy of <em>erchk</em> to get some subset of the error
messages.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for reporting these issues.</p>
</div>
</li>
<li>
<p>Use <code>set revert-all-at-newline on</code> for <em>readline</em>.</p>
<div class="paragraph">
<p>This update prevents history entries from being changed if they are
edited and then not used. This &#8220;feature&#8221; of changing the history
entries can be quite frustrating, particularly in <em>bash</em>. It can be
disabled in FSL9, FSL10, and FSL11, on a per user basis, by creating
the file:</p>
</div>
<div class="listingblock">
<div class="title">~/.inputrc</div>
<div class="content">
<pre class="highlight"><code>$include /etc/inputrc
set revert-all-at-newline on</code></pre>
</div>
</div>
</li>
<li>
<p>Add script, <em>govert</em>, to calculated \(\mathit{\frac{G}{T}}\)
from SEFDs (closing <a href="https://github.com/nvi-inc/fs/issues/197">#197</a>).</p>
<div class="paragraph">
<p>\(\mathit{\frac{G}{T}}\) is a common figure-of-merit used for
communications antennas.</p>
</div>
<div class="paragraph">
<p>The script <em>misc/govert</em> was added to calculate
\(\mathit{\frac{G}{T}}\) from <em>onoff</em> output, using a very simple
calculation. It may not meet your accuracy requirements. For extended
sources, it can be also be impacted by the crude resolution
corrections used by the FS. The formula used is</p>
</div>
<div class="paragraph text-center">
<p>\(\mathit{\frac{G}{T}=10 log_{10}\left(\frac{8 \pi k}{\lambda^2
SEFD}\right)}\), where \(\mathit{k}\) is the Boltzmann constant.</p>
</div>
<div class="paragraph">
<p>The script takes the name of a FS log with <em>onoff</em> output as an
argument. It outputs the <code>SIG</code> and <code>VAL</code> records with a <code>G/T</code> column
appended. Note that the values in the <code>SIG</code> records are the RMS
scatters of the underlying data propagated to the final quantities,
not the sigmas of the means for those quantities. A <code>-u</code> option can be
used to map the results to unity gain. Use
<code><strong>/usr2/fs/misc/govert&#160;-h</strong></code> for help with the script.</p>
</div>
<div class="paragraph">
<p>Thanks to Stuart Weston (Warkworth) for requesting this capability and
testing the script.</p>
</div>
</li>
<li>
<p>Improve recommended NTP configuration</p>
<div class="paragraph">
<p>Change the <code>check_ntp</code> procedure to not use the <code>-n</code> option of <em>ntpq</em>.
Make aliases in <em>/etc/hosts</em> for all NTP servers for easier reading of
<code>ntpq -p</code>. Use aliases in <em>/etc/ntp.conf</em> for easier viewing and
maintenance. Add information on how to redact server FQDNs and IP
addresses from log.</p>
</div>
<div class="paragraph">
<p>The recommended NTP configuration can be found in <em>misc/ntp.txt</em>. The
&#8220;items&#8221; listed in the following descriptions are where the change is
covered in that file.</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Change the <code>check_ntp</code> procedure to not use the <code>-n</code> option of
<em>ntpq</em></p>
<div class="paragraph">
<p>This allows descriptive names, instead of IP addresses, to be
displayed for servers by <em>ntpq</em>. Item <code>6a</code>.</p>
</div>
<div class="paragraph">
<p>The example <em>.prc</em> files were updated to agree.</p>
</div>
</li>
<li>
<p>Make aliases in <em>/etc/hosts</em> for all NTP servers for easier reading
of <code>ntpq -p</code>.</p>
<div class="paragraph">
<p>This defines descriptive aliases for <code>ntpq -p</code> to display. Item <code>6d</code>.</p>
</div>
</li>
<li>
<p>Use aliases in <em>/etc/ntp.conf</em> for easier viewing and maintenance.</p>
<div class="paragraph">
<p>With the aliases defined in <em>/etc/hosts</em>, this avoids the need to use
IP addresses, which are harder to recognize. Without the defined
aliases, using IP addresses was necessary to avoid problems when there
is DNS outage. Item <code>2b</code>.</p>
</div>
</li>
<li>
<p>Add information on how to redact server FQDNs and IP addresses from
log.</p>
<div class="paragraph">
<p>If site IT policies prohibit public dissemination of FQDNs and IP,
this information can be used to keep that information out of the log
files, which are often uploaded to publicly accessible servers. Item
<code>6e</code>.</p>
</div>
</li>
<li>
<p>Make other minor wording improvememts.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Make miscellaneous improvements (some internal) to <em>pfmed</em>.</p>
<div class="paragraph">
<p>The visible improvements are largely making the terminology in program
messages related to procedure libraries consistent, but some bugs were
fixed too. The internal improvements are mostly to make the handling
of FORTRAN <code>character</code> variables in subroutines work for arbitrary
length variables passed in as arguments.</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The visible changes include:</p>
<div class="ulist disc">
<ul class="disc">
<li>
<p>In program messages, the term &#8220;active&#8221;, as opposed to &#8220;open&#8221;, is
always used for the procedure library that <em>pfmed</em> is currently
working on.</p>
</li>
<li>
<p>In program messages, the term &#8220;library&#8221;, as opposed to &#8220;file&#8221;,
is always used for a procedure library, except for some file oriented
error messages. Error messages in <em>boss</em> related to procedure
libraries were also made consistent.</p>
</li>
<li>
<p>The FS <code>help</code> command pages for the <code>schedule</code> and <code>proc</code> commands
were updated to be consistent with the above terminology.</p>
</li>
<li>
<p>A &#8220;key&#8221; was added to the end of the <code>pfdl</code> command output to
describe the prefix letters before the library names (<code>&gt;</code>, active in
<em>pfmed</em>; <code>A</code>, the current FS schedule library; <code>S</code>, the current FS
station library, always <code>station</code>). These prefix letters are now
displayed correctly.</p>
</li>
<li>
<p>Fix <code>pfst</code> command to trap the &#8220;old&#8221; library not existing.
Previously, it would be created as an empty library.</p>
</li>
<li>
<p>Fix <code>pfst</code> command to allow copying of the library that is the
active library in <em>pfmed</em>. This was broken for <em>gfortan</em> which allows
a file to be open to only one unit, but worked for <em>fort77</em> (which
uses <em>f2c</em>). It now works independently of the compiler being used.
This had previously been fixed for the <code>st</code> command in commit
<code>ec03102e02ee2525243dfc3fba57981c6781f139</code> for FS <em>9.13.1</em> in August
2019.</p>
</li>
<li>
<p>Improve detection of the FS being active if it is started while
<em>pfmed</em> is running, which is apparently okay. There may still be some
race conditions for this situation.</p>
</li>
<li>
<p>Improved the error message for <em>pfmed</em> already being in use.</p>
</li>
<li>
<p>A missing error message for no procedure library being active was
restored.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The internal changes include:</p>
<div class="ulist disc">
<ul class="disc">
<li>
<p>Making <code>character</code> arguments of subroutine independent of the actual
length of the passed variable. This was very helpful for making the
change in the procedure library name lengths.</p>
</li>
<li>
<p>Make the lengths of character variables consistent with their usage
for procedure names, procedure library names, and file extensions.
This was very helpful for making the change in the procedure library
name lengths.</p>
</li>
<li>
<p>Improve the code for the <code>ds</code> command. This included fixing
<code>character</code> subroutine arguments to be adjustable, removing Hollerith
use of <code>character</code> variables, and cleaning-up edge cases for the
bubble-sort.</p>
</li>
<li>
<p>Make the same terminology consistency improvements (&#8220;active&#8221; and
&#8220;library&#8221;) in the code and comments that are visible to the user.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Include <em>rdbe30_mon.py</em></p>
<div class="paragraph">
<p>This script, written by Russ McWhirter (Haystack), is very useful for
evaluating RDBE functionality. Russ has graciously agreed to allow it
to be distributed with the FS to simplify making it available to
stations that have RDBEs.</p>
</div>
<div class="paragraph">
<p>The (original) <em>python2</em> version is available as
<em>/usr2/fs/misc/rdbe30_mon.py2</em>. The <em>python3</em> version is available as
<em>/usr2/fs/misc/rdbe30_mon.py</em>.</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Some of its features are:</p>
<div class="ulist">
<ul>
<li>
<p>When started, it opens four windows: <code>Command List</code>, <code>Command Log</code>,
<code>Monitor</code>, and <code>Plots</code>. The windows may be closed individually, but
closing the <code>Monitor</code> window will cause the program to exit. The
default positions of the windows can be set with command line options
(see below).</p>
</li>
<li>
<p>Command line options:</p>
<div class="ulist circle">
<ul class="circle">
<li>
<p><code>-h <em>multicast_host</em></code></p>
</li>
<li>
<p><code>-p <em>multicast_port</em></code></p>
</li>
<li>
<p><code>-H <em>RDBE_host</em></code></p>
</li>
<li>
<p><code>-P <em>RDBE_port</em></code></p>
</li>
<li>
<p><code>--command</code>, <code>--log</code>, <code>--monitor</code>, and <code>--plot</code> to set the X11
display geometry of the corresponding windows. Only the position of
the window should be set, e.g., <code>+0+0</code>, as the value for the option.</p>
</li>
</ul>
</div>
</li>
<li>
<p>An enable/disable plotting checkbox and a Phase-cal offset (MHz)
entry box on the <code>Plots</code> window. The plots shown are in order (from
the top):</p>
<div class="ulist circle">
<ul class="circle">
<li>
<p>Raw data</p>
</li>
<li>
<p>FFT of raw date</p>
</li>
<li>
<p>Histogram of raw data</p>
</li>
<li>
<p>Time domain Extracted PCal (Complex)</p>
</li>
<li>
<p>FFT of Extracted Pcal: Amplitude</p>
</li>
<li>
<p>FFT of Extracted Pcal: Phase</p>
</li>
<li>
<p>Count difference for Tcal: IF0, IF1</p>
</li>
</ul>
</div>
</li>
<li>
<p>The commands in the <code>Command List</code> window can be edited. Pressing
<kbd>F1</kbd>, or right clicking, on a command will cause it to be sent to
the RDBE.</p>
</li>
<li>
<p>Files:</p>
<div class="paragraph">
<p>These files are created in the current working directory. The value of
<em>&lt;RDBE_ADDR&gt;</em> is the IP address of the RDBE.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>rdbe30_monrc_&lt;RDBE_ADDR&gt;.db</em>&#8201;&#8212;&#8201;holds the geometry of the
windows between invocations of the script. Geometry values from
command line options override these.</p>
</li>
<li>
<p><em>rdbe30_mon_cmd_&lt;RDBE_ADDR&gt;.log</em>&#8201;&#8212;&#8201;holds a record of the
commands sent to the RDBE and the responses.</p>
</li>
<li>
<p><em>rdbe30_mon_dat_&lt;RDBE_ADDR&gt;.log</em>&#8201;&#8212;&#8201;holds a record of the
multicast data received from the RDBE. This file can become quite
large.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Installation</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Install the <code>matplotlib</code> appropriate for your system&#8217;s <em>python</em>
version, if not already included. This will need to be done by <em>root</em>.</p>
<div class="ulist disc">
<ul class="disc">
<li>
<p>Usually for <em>python2</em>:</p>
<div class="literalblock">
<div class="content">
<pre>apt-get install python-matplotlib</pre>
</div>
</div>
</li>
<li>
<p>Usually for <em>python3</em>:</p>
<div class="literalblock">
<div class="content">
<pre>apt-get install python3-matplotlib</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>IMPORTANT: For the remainder of these instructions make sure you
are in the <em>oper</em> account, switching if necessary.</p>
</li>
<li>
<p>Copy the version that is correct for your system (for <em>python2</em>,
use <code>.py2</code> instead of <code>.py</code>) to your <em>~oper/bin</em> directory.</p>
<div class="literalblock">
<div class="content">
<pre>cp /usr2/fs/misc/rdbe30_mon.py ~oper/bin</pre>
</div>
</div>
</li>
<li>
<p>Place a line for each RDBE in your <em>clpgm.ctl</em> control file. You
can refer to the default <em>st.default/control/clpgm.ctl</em> file. For
example, for RDBE-A (for <em>python2</em>, use <code>.py2</code> instead of <code>.py</code>) add a
line like:</p>
<div class="literalblock">
<div class="content">
<pre>mona   d popen 'cd /tmp;rdbe30_mon.py -h 224.0.2.10 -p 20021 -H rdbea 2&gt;&amp;1' -n rdbemona</pre>
</div>
</div>
<div class="paragraph">
<p>Substitute the correct multicast address (<code>-h</code>) and port (<code>-p</code>) for
your device. For other RDBEs, copy that line and make appropriate
changes (for example for RDBE-B: <code>mona</code> &#8594; <code>monb</code>, <code>rdbea</code> &#8594; <code>rdbeb</code>,
<code>rdbemona</code> &#8594; <code>rdbemonb</code>, change the multicast address and port).</p>
</div>
<div class="paragraph">
<p>The <code>cd /tmp</code> in the line causes the script&#8217;s files to be written to
(and read from) <em>/tmp</em>; so they won&#8217;t clutter up other directories.
They will also be automatically deleted each time the system is
rebooted. You can place them in a different directory if you want to
preserve them.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You can control the initial placement of the windows by adding the
<code>--command</code>, <code>--log</code>, <code>--monitor</code>, and <code>--plot</code> options with
appropriate placement geometry values.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The RDBE host address alias, in this example <code>rdbea</code>, must be
defined in <em>/etc/hosts</em>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Running the script</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The script should not be left running during operations. If
the plotting function is enabled, it is CPU intensive.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can run the script from the operator input window, e.g., for
RDBE-A:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>client=mona</pre>
</div>
</div>
<div class="paragraph">
<p>Exit the program by closing the <code>Monitor</code> window</p>
</div>
</li>
<li>
<p>The following changes were needed for the <em>python3</em> version:</p>
<div class="ulist">
<ul>
<li>
<p>The first three changes for <em>python3</em> in the &#8220;Details&#8221; for the
<a href="#FSL11">FSL11</a> changes above: running the script through <em>2to3</em> and
<em>reindent</em> and changing the <em>shebang</em> line.</p>
</li>
<li>
<p>Change <code>import</code> of <code>NavigationToolBar2TkAgg</code> to
<code>NavigationToolBar2Tk</code></p>
</li>
<li>
<p>Change log file output to buffered</p>
</li>
<li>
<p>Use <code>draw()</code> instead of <code>show()</code></p>
</li>
<li>
<p>Use data <code>encode()</code>/<code>decode()</code> for socket I/O</p>
</li>
<li>
<p>Select real part of complex array for plotting to eliminate warning</p>
</li>
<li>
<p>Remove use of <code>buffer()</code> to linearise an array.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</details>
</li>
<li>
<p><a href="#fs_bugs">Make miscellaneous bug fixes</a><a id="fs_bugs"></a>:</p>
<div class="paragraph">
<p>About 15 small bugs were fixed. All were fairly minor but one could
cause a crash if a DBBC2 was in a bad state.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>Fix crashes for DBBC2 communication errors. Fix <em>plog</em> to support
sending multiple files to BKG. Correct logging of multicast time for
DBBC3 Core3H board <code>5</code>. Prevent multicast time-out errors from being
suppressed after the DBBC3 returns an error. Fix using a DBBC IF
channel as a detector in <em>fivpt</em> and <em>onoff</em> with continuous
calibration. Fix parsing of detectors for T<sub>sys</sub> related commands.
Fix plotting of data from paired commands in <em>logpl</em>. Prevent DBBC
communication errors with the PFB personalty from causing a crash.
Remove redundant class number clearing. Demote <code>if</code> and <code>setup_proc</code>
commands from being immediate execution commands. Correct T<sub>sys</sub> error
messages for four character device names. Correct DBBC3 <code>bbc_gain</code>
first parameter error messages. Correct the DBBC error message for an
incorrect detector device in T<sub>sys</sub> related commands. Fix the home
directory permissions for AUID accounts. Fix the <em>refresh_spare_usr2</em>
scripts for FSL6-8 and FSL9.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Fix crashes for DBBC2 communication errors (closing
<a href="https://github.com/nvi-inc/fs/issues/191">#191</a>).</p>
<div class="paragraph">
<p>There were two errors in class number handing of communicating with a
DBBC2 (the FS refers to the device as a &#8220;DBBC&#8221;). They occurred in
the periodic checking of the DBBC2 personality/version and the the VSI
clock rate. Crashes only seemed to happen when the DBBC2 is in a bad
state, and then after about ~35 <code>ch -810 Communication error for
DBBC.</code> errors. There should no longer be any crashes even if the DBBC2
is in the bad state. Rebooting the DBBC2 may fix the bad state. That
is a good thing to do since calibration data may be lost and other
problems may occur while it is in the bad state.</p>
</div>
<div class="paragraph">
<p>These errors were present since the addition of these checks in
commits <code>8e59c7c3502243ea7762c2bfa062a06bad427de2</code>, January 2016,
released as FS <em>9.11.9</em>, and
<code>0fd3f965075ae91ec12768a4a4a2f5911e973824</code>, April 2019, released as FS
<em>9.13.1</em>.</p>
</div>
<div class="paragraph">
<p>This fix is also included in patch releases <em>10.0.1</em> and <em>10.1.1</em>.</p>
</div>
<div class="paragraph">
<p>Thanks to Eskil Varenius (Onsala) for reporting this problem and
testing the fix.</p>
</div>
</li>
<li>
<p>Fix <em>plog</em> to support sending multiple files to BKG (closes
<a href="https://github.com/nvi-inc/fs/issues/186">#186</a>).</p>
<div class="paragraph">
<p>Due to a bug, <em>plog</em> was unable to send multiple files to BKG in one
invocation. The result was that none were sent. This situation comes
up routinely when sending both reduced and <em>full.log</em> files for VGOS.</p>
</div>
<div class="paragraph">
<p>Thanks to Kiah Imai (KPGO) for reporting this and testing the fix.</p>
</div>
</li>
<li>
<p>Correct logging of multicast time for DBBC3 Core3H board <code>5</code>
(closing <a href="https://github.com/nvi-inc/fs/issues/198">#198</a>).</p>
<div class="paragraph">
<p>In <em>10.1</em>, the time of the log entry time-stamp was being substituted
for the time returned from board <code>5</code>. This only affected DDC_U (and
off-label use of DDC_E) firmware. This would have had no impact if the
board time agreed with the log entry time, which it usually would. If
the board time was actually wrong, that would have still be recorded
by the <em>mcast_time</em> command, which should be in <code>midob</code>, and would
have been visible in the T<sub>sys</sub> monitor display.</p>
</div>
<div class="paragraph">
<p>Thanks to Eskil Varenius (Onsala) for discovering this (while testing
with DDC_V <em>v125</em>) and helping verify the extent of the issue. Thanks
Jon Quick (HartRAO) for provided a system to use in developing the
fix.</p>
</div>
</li>
<li>
<p>Prevent multicast time-out errors from being suppressed after the
DBBC3 returns an error (closing
<a href="https://github.com/nvi-inc/fs/issues/195">#195</a>).</p>
<div class="paragraph">
<p>This caused time-out errors to be ignored until the next successful
DBBC3 communication. This could be induced with a bad low-level DBBC3
command, e.g., <code>dbbc3=junk</code>.</p>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for reporting this bug.</p>
</div>
</li>
<li>
<p>Fix using a DBBC IF channel as a detector in <em>fivpt</em> and <em>onoff</em>
with continuous calibration (closing
<a href="https://github.com/nvi-inc/fs/issues/190">#190</a>).</p>
<div class="paragraph">
<p>The DBBC (i.e., the DBBC2) does not provide separate cal-on and
cal-off TPIs for an IF detector when continuous calibration is in use.
Implementing something useful in the FS for this case had been
overlooked. Unfortunately until it was fixed, the FS produced unusable
T<sub>ant</sub> measurements in <em>fivpt</em> and nonsensical T<sub>sys</sub> values for those
detectors in <em>fivpt</em> and <em>onoff</em>.</p>
</div>
<div class="paragraph">
<p>This was improved by (i) internally treating that detector as having a
T<sub>cal</sub> value of <code>-100</code> (i.e., assuming there is no noise diode for
this detector) and (ii) using the unswitched power. This results in
<em>fivpt</em> T<sub>ant</sub> and estimated peak values being printed in percent of
system temperature in <em>fivpt</em> and T<sub>sys</sub> for that detector as <code>-100</code>
in <em>onoff</em>. If the T<sub>cal</sub> defined in the <em>.rxg</em> file was already
negative, that value is used instead.</p>
</div>
<div class="paragraph">
<p>If the IF channel is not corrupted by RFI, this makes it usable for
pointing measurements. It use should still be avoided for gain
calibration measurements for other reasons, primarily having a very
broad bandpass, but in some cases not having a center frequency that
<em>onoff</em> can calculate accurately. Additionally, the value of the
&#8220;DBBC IF power conversion factors&#8221; in <em>equip.ctl</em> may not have
accurate values.</p>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for reporting the existing poor
behavior, pointing out that something useful could be done, and
testing the improvement.</p>
</div>
</li>
<li>
<p>Fix parsing of detectors for T<sub>sys</sub> related commands: <code>tpi</code>,
<code>tpical</code>, <code>tpzero</code>, <code>tpdiff</code>, <code>tpgain</code>, <code>tpdiffgain</code>, <code>caltemps</code>, and
<code>tsys</code> (partially closing
<a href="https://github.com/nvi-inc/fs/issues/194">#194</a>).</p>
<div class="paragraph">
<p>There were two problems:</p>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Buffer shortness</p>
<div class="paragraph">
<p>The buffers for parsing the commands were too short to accommodate a
list of all the individual detectors for a given rack type. Although
detectors are usually specified with mnemonics that specify groups of
detectors (such as <code>formbbc</code> and <code>formif</code>), the shortness of the
buffers prevented specify an arbitrary list of individual detectors.
This was corrected for all rack types. However, the number of possible
detectors for a DBBC3 is so large that they can&#8217;t all fit in the
buffer (1024 characters) that FS uses for communication between
programs. Until that is expanded, which it will be for R2DBE support,
the maximum number of DBBC3 detectors is limited by that.</p>
</div>
</li>
<li>
<p>Buffer not cleared before reuse</p>
<div class="paragraph">
<p>A buffer used to decode the individual detectors was not properly
cleared before being used to decode the next detector. As a result, if
a detector was incompletely specified, but was completed by leftover
characters in the buffer, no error was detected and an incorrect
detector may have been selected. This was corrected for all rack
types. This bug could interact with the preceding bug (&#8220;Buffer
shortness&#8221;) to prevent a truncated detector at the end of the buffer
from being reported as an error.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Thanks Jun Yang (Onsala) for reporting these issues.</p>
</div>
</li>
<li>
<p>Fix plotting of data from paired commands in <em>logpl</em> (closing
<a href="https://github.com/nvi-inc/fs/issues/182">#182</a>).</p>
<div class="paragraph">
<p><em>logpl</em> can plot data from paired commands. The first command of a
pair (its description in <em>logpl.ctl</em> starts with a <code>$</code>) is associated
with the second of the pair (its description ends with <code>$</code>). <em>logpl</em>
selects the data to plot based on the first command. The next
following instance of the second command has the value to be plotted.
This can be useful for situations where one command identifies what is
being sampled (e.g., a BBC defined by <code>pcalports=</code>) and the data
values come from a second command (e.g., amplitude or phase for a
single sideband from <code>decode4/pcal</code>).</p>
</div>
<div class="paragraph">
<p>The problem arises if the corresponding second command is missing
(perhaps due to a time-out) before the next instance of the first
command. In that case, <em>logpl</em> thinks the next occurring second
command should be used, even if the intervening first command
identifies different data. The result is that data from two different
selections may appear on one plot. That makes a mess.</p>
</div>
<div class="paragraph">
<p>This was fixed by invalidating the match of a first command if another
instance of it occurs, but with a different string value. This
prevents a match on the second command of a pair if the first command
of that pair with a different string has occurred since the original
first command with the right string.</p>
</div>
</li>
<li>
<p>Prevent DBBC communication errors with the PFB personality from
causing a crash for the <code>tpi</code>, <code>tpical</code>, and <code>tpzero</code> commands,</p>
<div class="paragraph">
<p>The PFB personality is not heavily used and what use it gets does not
usually include T<sub>sys</sub> measurements.</p>
</div>
<div class="paragraph">
<p>The error check was lost in commit
<code>224cc218b7519c300c11c59aea6391a6da3b122b</code>, August 2019, for the merge
of the <code>master</code> branch into the <code>VGOS</code> branch.</p>
</div>
</li>
<li>
<p>Remove redundant class number clearing, which only occurred after
an error when setting the AGC in <em>onoff</em> for DBBC2s and DBBC3s.</p>
<div class="paragraph">
<p>The could potentially have caused clearing of a class number that was
already in use for something else. The chances of a problem occurring
were pretty low.</p>
</div>
<div class="paragraph">
<p>This error was introduced with the initial support for the DBBC2 and
DBBC3. For the DBBC2, this was commit
<code>f3ee6ea64be008b2bb0ebcbf3f54223b43de8b23</code>, January 2013, released as
FS <em>9.11.2</em>; DBBC3, <code>19a69540f9f03d4b1035cde4bd097a5babb3ddfe</code>,
October 2018, FS <em>9.12.12</em>.</p>
</div>
</li>
<li>
<p>Demote <code>if</code> and <code>setup_proc</code> commands from being <em>immediate</em>
execution commands (closing
<a href="https://github.com/nvi-inc/fs/issues/189">#189</a>).</p>
<div class="paragraph">
<p>If entered interactively, they would execute immediately even if there
was a time block on the operator command stream. This was not an issue
for the schedule stream, where they were normally used, since that
stream doesn&#8217;t have the functionality of immediate execution commands.
As a result, the old behavior was benign for schedules. It was also of
no consequence interactively unless there was a time block.</p>
</div>
</li>
<li>
<p>Correct T<sub>sys</sub> error messages (overflow, infinity, less than zero)
for four character device names</p>
<div class="paragraph">
<p>This supports DBBC3 devices and future devices that may have more than
two characters.</p>
</div>
</li>
<li>
<p>Correct DBBC3 <code>bbc_gain</code> first parameter error messages.</p>
<div class="paragraph">
<p>Previously they were just the messages for the DBBC (i.e., DBBC2).</p>
</div>
</li>
<li>
<p>Correct the DBBC error message for an incorrect detector device in
the <code>tpi</code>, <code>tpical</code>, <code>tpzero</code>, <code>tpdiff</code>, <code>caltemp</code> and <code>tsys</code> commands</p>
<div class="paragraph">
<p>Previously it was the one for the VLBA rack.</p>
</div>
</li>
<li>
<p>Set the home directory permissions for AUID accounts to <code>0750</code>.</p>
</li>
<li>
<p><a href="#refresh_spare_usr2">refresh_spare_usr2</a><a id="refresh_spare_usr2"></a>:
Fix the <em>refresh_spare_usr2</em> scripts for FSL6-8 and FSL9.</p>
<div class="paragraph">
<p>Since the scripts use <code>set -e</code>, the <code>fuser -k -m /usr2</code> command will
fail if no user is active on the spare computer <em>/usr2</em> partition.
Since no user should be active on <em>/usr2</em> when the script is used, it
should not succeed. The fix for this is to change the command for
FSL6-8 to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fuser -k -m /usr2 || :</pre>
</div>
</div>
<div class="paragraph">
<p>For FSL9, it is changed to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fuser -k -M -m /usr2 || :</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In the uninstalled script, the line is commented out.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</details>
</li>
<li>
<p>Make miscellaneous <code>help</code> page, and other help output, improvements</p>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>Improve the <code>help</code> pages for <code>cont_cal</code> for the DBBC and DBBC3.
Improve the <code>help</code> page for <code>cont_cal</code> for the DBBC3.  Improve <code>help</code>
page for <code>bbc_gain</code> for DBBC2 and DBBC3. Fix <code>-help</code> command line
option for <em>gnplt</em>. Improve <code>logpl</code> help contents for the Main screen.
Improve <code>help</code> page for the <code>setup_proc</code> command.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Improve the <code>help</code> pages for <code>cont_cal</code> for the DBBC and DBBC3.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Clarify that the DBBCs send the continuous calibration control
signal to the receiver.</p>
</li>
<li>
<p>Clarify that the <code><em>samples</em></code> parameter, in addition to setting
the averaging interval (or decay constant), also sets the number of
<em>tpid</em> cycles for logging the averaged T<sub>sys</sub>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for the information on the calibration
signal and pointing out that the logging interval was not clear.</p>
</div>
</li>
<li>
<p>Improve the <code>help</code> page for <code>cont_cal</code> for the DBBC3</p>
<div class="paragraph">
<p>The only polarity values that should be used are <code>0</code> and <code>2</code>. The TTL
signal levels that correspond to these values are stated.</p>
</div>
<div class="paragraph">
<p>Thanks to Sven Dornbusch (MPIfR) for this clarification on what values
to use. Thanks to Jon Quick (HartRAO) for the information on the
signal levels.</p>
</div>
</li>
<li>
<p>Improve <code>help</code> page for <code>bbc_gain</code> for DBBC2 and DBBC3</p>
<div class="paragraph">
<p>The usage of the second and third parameters for <code><em>gainU</em></code> and
<code><em>gainL</em></code>, respectively, for setting the levels manually was
clarified.</p>
</div>
</li>
<li>
<p>Fix <code>-help</code> command line option for <em>gnplt</em> (closing
<a href="https://github.com/nvi-inc/fs/issues/184">#184</a>).</p>
<div class="paragraph">
<p>This option was fixed to provide a synopsis of the command line
arguments instead of failing entirely.</p>
</div>
<div class="paragraph">
<p>Thanks to Jon Quick (HartRAO) for reporting this error.</p>
</div>
</li>
<li>
<p>Improve <em>logpl</em> help contents for the Main screen</p>
<div class="paragraph">
<p>The description of the three bottom buttons in the Plot Details box
was improved. This was primarily to say that the deleting of
individual points is with a double right-click instead of a
left-click. Other small improvements were made.</p>
</div>
</li>
<li>
<p>Improve <code>help</code> page for the <code>setup_proc</code> command,</p>
<div class="paragraph">
<p>Minor wording improvements.</p>
</div>
</li>
</ol>
</div>
</div>
</details>
</li>
<li>
<p>Make miscellaneous documentation changes</p>
<div class="paragraph">
<p>About a dozen small improvements and expansions were made to the web
pages. These are beyond changes that were made as part of feature
changes and the update notes for this release.</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>Improve the description of the <code>use_setup_proc</code> <em>drudg</em> option.
Improve the description of the <code>thread<em>suffix</em></code> procedure. Fix the
<code>record = &#8230;&#8203;</code> command description for recorder tuning. Remove
&#8220;10.1&#8221; from the title of the &#8220;FS DBBC3 Operations Manual&#8221;. Add
update notes for FS <em>10.0.1</em> and <em>10.1.1</em> patch releases. Modify the
FS <em>10.1.0</em> update notes to recognize that the default branch may
already be <em>main</em>. Add a <strong>TIP</strong> for managing directory names of FS
installations from archives. Add a <strong>TIP</strong> for how to avoid losing your
place in a &#8220;Details&#8221; toggle when following a link. Add explanation
of how to navigate to a link in a &#8220;Details&#8221; toggle in a different
document. Expand &#8220;Font Conventions&#8221; document. Update &#8220;Converting to
a 64-bit System&#8221; document. Update instructions for making the
<code>gh-pages</code> documentation.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Improve the description of the <code>use_setup_proc</code> <em>drudg</em> option in
the
<a href="../1/dbbc3_ops.html#_minimizing_the_use_of_setup_procedures">Minimizing
the use of setup procedures</a> appendix of the
<a href="../1/dbbc3_ops.html">FS DBBC3 Operations Manual</a> document.</p>
</li>
<li>
<p>Improve the description of the <code>thread<em>suffix</em></code> procedure in the
<a href="../1/dbbc3_ops.html#_thread_procedure">Thread Procedure</a> appendix of
the <a href="../1/dbbc3_ops.html">FS DBBC3 Operations Manual</a> document.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Add a description of the <code>ds</code> added to the <code>datastream</code> label for
the file name and that it stays lowercase all the way to the file
name.</p>
</li>
<li>
<p>Add an explanation that this results in a double <em>ds</em> in the file
name, which is intentional (closing
<a href="https://github.com/nvi-inc/fs/issues/193">#193</a>).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Fix the <code>record = &#8230;&#8203;</code> command in the
<a href="../1/dbbc3_ops.html#_flexbuff_recorder">FlexBuff Recorder</a>
subsection the <a href="../1/dbbc3_ops.html#_recorder_tuning">Recorder
tuning</a> appendix of the <a href="../1/dbbc3_ops.html">FS DBBC3
Operations Manual</a> document.</p>
<div class="paragraph">
<p>The second colon was missing. The FS code was correct. This was only a
documentation issue.</p>
</div>
<div class="paragraph">
<p>Thanks to Marjolein Verkoutor (JIVE) for reporting this.</p>
</div>
</li>
<li>
<p>Remove &#8220;10.1&#8221; from the title of the <a href="../1/dbbc3_ops.html">FS
DBBC3 Operations Manual</a>.</p>
</li>
<li>
<p>Add documents <a href="../1/10.1.1.html">FS 10.1.1 Update Notes</a> and
<a href="../0/10.0.1.html">FS 10.0.1 Update Notes</a> for new patches releases.</p>
</li>
<li>
<p>Modify document <a href="../1/10.1.0.html">FS 10.1.0 Update Notes</a> to
<em>not</em> change the default branch to <em>main</em> when preserving the old
repository if it was cloned around June 5, 2022 or later.</p>
<div class="paragraph">
<p>In this case, the default is already <em>main</em>.</p>
</div>
</li>
<li>
<p>Add a <strong>TIP</strong> for managing directory names of FS installations from
archives in the
<a href="../../misc/release_model.html#_installing_from_an_archive">Install
from an archive</a> subsection of the
<a href="../../misc/release_model.html">Release Model</a> document.</p>
<div class="paragraph">
<p>Making a copy as a new directory before making any local changes can
make it easier to track changes and which version is in use.</p>
</div>
</li>
<li>
<p>Add a <strong>TIP</strong> for how to avoid losing your place in a &#8220;Details&#8221;
toggle for a FS or <em>drudg</em> change list item when following a link
(basically: right-click and open a new tab). This was added to the
<a href="../1/10.1.0.html#improve_presentation">Improve presentation</a> FS
change sub-item (if that link doesn&#8217;t work in your browser, the <strong>TIP</strong>
is copied below) of the <a href="../1/10.1.0.html">FS 10.1.0 Update Notes</a>
document. The <strong>TIP</strong> added is:</p>
<div class="sidebarblock">
<div class="content">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
An alternative to avoid this is to right click the link, then
open it in a new tab, and then click on that tab. To return to the
original document, you can close the new tab or click on the original
document&#8217;s tab, whatever you prefer.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>Add explanation of how to navigate to a link in a &#8220;Details&#8221;
toggle in a different document, if the browser doesn&#8217;t support going
to it directly. This was added to the
<a href="../1/10.1.0.html#improve_presentation">Improve presentation</a> FS
change sub-item (if that link doesn&#8217;t work in your browser, the text
is copied below) of the <a href="../1/10.1.0.html">FS 10.1.0 Update Notes</a>
document. The text added is:</p>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Links that point into a <strong>Details</strong> toggle in a different document do
not work in all browsers. To help with that, if the relevant text is
small it is reproduced within an embedded sidebar block (grey
background). Otherwise, a second link to the title of the item with
the toggle is provided along with instructions to follow the link
(probably opening it in a new tab would be best), open the toggle, and
then search for the anchor text of the original link.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>Expand the <a href="../../../misc/font_conventions.html">FS Font
Conventions</a> document.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Subsections for following topics were added:</p>
<div class="ulist disc">
<ul class="disc">
<li>
<p>Links to different documents and into collapsible blocks</p>
</li>
<li>
<p>Collapsible blocks</p>
</li>
<li>
<p>Embedded sidebar blocks</p>
</li>
<li>
<p>Nesting blocks</p>
</li>
<li>
<p>List continuation</p>
</li>
<li>
<p>Unordered list markers</p>
</li>
</ul>
</div>
</li>
<li>
<p>The example for inline links was improved.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Add explanation for generating an <em>ssh</em> key for <em>scp</em> commands when
converting to 64-bit.</p>
<div class="paragraph">
<p>The <a href="../../../misc/64-bit_conversion.html">Converting to a 64-bit
System</a> document was updated.</p>
</div>
</li>
<li>
<p>Update instructions in the <em>making_gh-pages.txt</em> file for the
current default branch, <em>main</em>.</p>
</li>
</ol>
</div>
</div>
</details>
</li>
<li>
<p>Make miscellaneous cosmetic changes</p>
<div class="paragraph">
<p>About 10 small cosmetic issues were fixed</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>Change title for <code>cable</code> data in <em>logpl</em>. Fix <em>gnplt</em> error message
for the GUI crashing. Remove more extraneous <code>(..)</code> strings from some
error messages. Fix column alignment of the header for the <code>APR</code> lines
in <em>onoff</em>. Prevent <em>monit7</em> from crashing if the rack type is
non-DBBC3.  Remove an extraneous leading blank in <em>erchk</em>. Improve
coding of <em>tpicd</em> for DBBC3. Fix comments in an <em>include</em> file.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Change description (title) for <code>cable</code> in the default <em>logpl.ctl</em>
file to not include <code>length</code>.</p>
<div class="paragraph">
<p><em>logpl</em> plots the raw <code>cable</code> data, not converted to length.</p>
</div>
</li>
<li>
<p>Fix <em>gnplt</em> error message for the GUI crashing to mention <code>gnplt</code>
rather than <code>LogPlotter</code>.</p>
</li>
<li>
<p>Remove more extraneous <code>(..)</code> strings from some error messages.</p>
<div class="paragraph">
<p>The most common of these were fixed in FS <em>10.1</em>, but a few more were
uncovered. These were due to unnecessary setting of variables in
<em>dbbcn</em>, <em>mk5cn</em>, and <em>rdbcn</em>. Additionally, a change was made to
<em>boss</em> that may eliminate this issue if there are any remaining
instances.</p>
</div>
</li>
<li>
<p>Fix column alignment of the header for the <code>APR</code> lines in <em>onoff</em>.</p>
<div class="paragraph">
<p>Beginning with the <code>T</code> column header, the rightmost ones were moved
one character farther right.</p>
</div>
<div class="paragraph">
<p>The misalignment had apparently been there since <em>onoff</em> was rewritten
in commit <code>1b68b90f216412b90c31afca2ab1eb7168602280</code>, October 2002,
for release FS <em>9.5.15</em>,</p>
</div>
</li>
<li>
<p>Prevent <em>monit7</em> from crashing if the rack type is non-DBBC3.</p>
<div class="paragraph">
<p>Now it prints a warning and then exits after 10 seconds. <em>monit7</em> is
only for use with a DBBC3.</p>
</div>
</li>
<li>
<p>In <em>erchk</em>, remove an extraneous leading blank that was inserted if
there was no additional indentation.</p>
</li>
<li>
<p>Fix <em>tpicd</em> to get current DBBC3 variables from the local copy of
the shared memory data structure rather than directly from shared
memory.</p>
</li>
<li>
<p>Correct comments in <em>include/dbbc3_bbcnn_ds.h</em>.</p>
</li>
</ol>
</div>
</div>
</details>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_drudg_changes">3.2. drudg changes</h3>
<div class="paragraph">
<p><em>drudg</em> opening message date is <code>2023-02-21</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make typographic changes for the new <em>f95</em> version in FSL11.</p>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>These are similar to changes described in the <a href="#f95">f95</a> FS change
item (if that link doesn&#8217;t work in your browser, click on this link
instead: <a href="#FSL11">FSL11</a>, open the &#8220;Details&#8221; toggle below that
location by clicking on it, go <code>Back</code> in the browser, and finally
click on the original link). There were only a few octal constants
outside of <code>parameter</code> statements and these were in simple assignment
statements. All octal constants were wrapped in <code>int()</code>. There were no
<code>and()</code> statements with mixed sized <code>integer</code>s. There were no
hexadecimal or binary constants at all.</p>
</div>
</div>
</details>
</li>
<li>
<p>Accept input schedule files (<em>.skd</em> and <em>.vex</em>) with up to 16
characters before the dot (<code>.</code>) for the extension.</p>
<div class="paragraph">
<p>This change was made to agree with <a href="#Names">Names</a> FS change item
above.</p>
</div>
</li>
<li>
<p>Prepend <code>ds</code> to the <em>name</em> (second) parameter in the
<code>datasteram=add,{thread},*</code> command in the single-thread-per-file
<code>thread<em>suffix</em></code> SNAP procedure for VDIF recording.</p>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="paragraph">
<p>The command now reads: <code>datastream=add,ds{thread},*</code>. This change is
intended to be forward compatible with emerging file naming
conventions for recorded data. For more information on the
<code>thread<em>suffix</em></code> SNAP procedure, see the
<a href="../1/dbbc3_ops.html#_thread_procedure">Thread Procedure</a> appendix of
the <a href="../1/dbbc3_ops.html">FS DBBC3 Operations Manual</a> document.</p>
</div>
</div>
</details>
</li>
<li>
<p>Make miscellaneous small bug fixes and improvements</p>
<div class="paragraph">
<p>About four small changes were made</p>
</div>
<details>
<summary class="title">Details</summary>
<div class="content">
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Improve <em>skdrut/errormsg.f</em> to avoid problems with bounds checking
by not hard-coding the <code>character</code> argument&#8217;s length.</p>
</li>
<li>
<p>Fix <em>skdrut/trimlen.f</em> to prevent problems with bounds checking if
the string is blank.</p>
</li>
<li>
<p>Fix <em>drudg/snap.f</em> to use the experiment name internal to the file
rather than from the filename.</p>
</li>
<li>
<p>Fix <em>drudg/strip_path.f</em> to check for enough space to store the
file name.</p>
</li>
</ol>
</div>
</div>
</details>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_update_ntp_configuration">Appendix A: Update NTP Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although the use of NTP on the FS computer is strongly encouraged for
most situations, this entire appendix is optional.</p>
</div>
<div class="paragraph">
<p>The recommended NTP configuration is described in <em>misc/ntp.txt</em>
(<a href="https://github.com/nvi-inc/fs/blob/main/misc/ntp.txt" class="bare">https://github.com/nvi-inc/fs/blob/main/misc/ntp.txt</a>). If you have
not implemented it before, you can use the information there to do so.</p>
</div>
<div class="paragraph">
<p>As of FS <em>10.2</em> the recommendations have been improved. If you have
previously used those recommendations, this appendix describes how to
update your implementation for the improvements. You should review the
directions below, and the contents of <em>misc/ntp.txt</em> to which they
refer, before deciding what to do. The &#8220;items&#8221; listed in the
following descriptions are where the change is covered in that file.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>As <em>root</em>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Add aliases for all your NTP servers to <em>/etc/hosts</em>. Item <code>6d</code>.</p>
</li>
<li>
<p>Change your <em>/etc/ntp.conf</em> file to use the aliases in <em>/etc/hosts</em>.
Item <code>2b</code>.</p>
</li>
<li>
<p>Restart <em>ntpd</em>.</p>
<div class="paragraph">
<p>For <em>init.d</em> systems, FSL9 and earlier, you can use:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/etc/init.d/ntp restart</pre>
</div>
</div>
<div class="paragraph">
<p>For <em>systemd</em> systems, FSL10 and later:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>systemctl restart ntp</pre>
</div>
</div>
<div class="paragraph">
<p>Rebooting is an option for restarting NTP on any system.</p>
</div>
</li>
<li>
<p>Verify NTP operation (any user can do this)</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Check to make sure you get the expected servers listed by <code>ntp
-p</code>.</p>
<div class="paragraph">
<p>If not, you may need to recheck you definition of aliases in
<em>/etc/hosts</em> and their use in <em>/etc/ntp.conf</em>;</p>
</div>
</li>
<li>
<p>Check that the <code>remote</code> for each server is an alias.</p>
<div class="paragraph">
<p>If not, you may need to adjust your <em>/etc/hosts</em> file.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>As <em>oper</em>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Update your <code>check_ntp</code> procedure to not use the <code>-n</code>
option of <em>ntpq</em>. Item <code>6a</code>.</p>
<div class="paragraph">
<p>You can also expand the list of servers that are displayed by
adjusting the <em>grep</em> command in the procedure. The details are covered
in item <code>6a</code>.</p>
</div>
</li>
<li>
<p>Optionally, redact FQDNs and IP addresses from the output of
<code>check_ntp</code>. Item <code>6e</code>.</p>
<div class="paragraph">
<p>Some sites may have IT policies that require this, but it may be
prudent for everyone to implement it,</p>
</div>
</li>
<li>
<p>Verify the output of <code>check_ntp</code>.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Make sure the <code>remote</code> field is the alias, not the IP address,
for each server.</p>
<div class="paragraph">
<p>If not, you may not have removed the <code>-n</code> option from <code>ntpq  -np</code> to
make it <code>ntpq -p</code>.</p>
</div>
</li>
<li>
<p>If you intended to redact IP addresses from the output, make sure
no IP addresses appear, but instead the string <code>REDACTED</code>. You can
compare to <code>ntpq -p</code> run from a shell, which will not have <code>REDACTED</code>.</p>
<div class="paragraph">
<p>If you still get IP addresses from <code>check_ntp</code>, then you may need to
fix the use of the filter in item <code>6e</code>.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-07-11 09:12:53 -0400
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>