FTN4,X
C@IAS2B 
C 
      INTEGER FUNCTION IAS2B(INCHR,IFCHR,N),C#890516:19:12    # 
C 
C     IAS2B 
C 
C 1.  NAME PROGRAM SPECIFICATION
C 
C       1.1     IAS2B           THIS ROUTINE CONVERTS N CHARACTERS TO 
C                       AND INTEGER AND RETURNS THE VALUE TO THE USER 
C                       LEADING BLANKS ARE IGNORED AND A MINUS SIGN 
C                       GIVES A NEGATIVE NUMBER 
C 
C 
C 1.2.   RESTRICTIONS - limits on use of routine
C 
C 1.3.   REFERENCES - document cited
C 
C 2.  NAME INTERFACE
C 
C 2.1.   CALLING SEQUENCE: INT=IAS2B(INCHR,IFCH,N)
C 
C     INPUT VARIABLES:
C 
C       IFCHR   - THE FIRST CHARACTER IN INCHR TO BE USED 
C 
C       N       - THE NUMBER OF CHARACTERS TO BE USED 
C 
      DIMENSION INCHR(2)
C 
C       INCHR   - THE CHARACTER STREAM TO BE CONVERTED TO AN INTEGER
C 
C 
C     OUTPUT VARIABLES: 
C 
C       IAS2B   - THE INTEGER RESULTING FROM THE CONVERSION 
C                   IF ANY INVALID CHARACTERS ARE FOUND A -32768 IS RETURNED
C 
C 2.5.   SUBROUTINE INTERFACE:
C 
C       THIS IS A UTILITY ROUTINE 
C 
C     CALLED SUBROUTINES: ICHAR 
C 
C 3.  LOCAL VARIABLES 
C 
C       ISIGN   - THE SIGN HOLDER (=+1 UNLESS A - PRECEEDS NUMBER)
C 
C       IX      - USED TO COMPUTE BINARY VALUE OF RESULT
C 
C 6.  PROGRAMMER: LEE N. FOSTER 
C     LAST MODIFIED:
C# LAST COMPC'ED  890516:19:12urrent date) #
C 
C     PROGRAM STRUCTURE 
C 
C       6.1     INIALIZE STATE VARAIBLES
C 
        ISIGN=1 
        IX=0
C 
C       6.2     LOOP THROUGH A CHARACTER AT A TIME
C 
              DO 500 I=1,N  
C 
C                     GET THE CHARACTER ISOLATED
C 
              IC=ICHAR(INCHR,IFCHR+I-1)   
C 
C                     IS IT AN INTEGER
C 
              IF(60B .LE. IC .AND. IC .LE. 71B) GO TO 300 
C 
C                     IF NOT A INTEGER HAS AN ONE BEEN FOUND
C 
              IF( IX .NE. 0) GO TO 910
C 
C                     IS IT A SIGN AS IN -
C 
              IF(IC .EQ. 55B) GO TO 200 
C 
C                     DID SOMEBODY GIVE US A +
C 
              IF(IC .EQ. 53B) GO TO 500 
C 
C                     BLANKS ONLY OTHER THING PERMITTED 
C 
              IF(IC .EQ. 40B) GO TO 500 
C 
C                     IF NONETHING HAS WORKED ABORT 
C 
              GO TO 910 
C 
200           CONTINUE
C 
C                     RECORD MINUS SIGN OCCURRENCE
C 
              ISIGN=-1
              GO TO 500 
C 
300           CONTINUE
C 
C                     INTEGERS ARE EASY TO HANDLE 
C 
              IX=10*IX+IC-60B 
C 
500     CONTINUE
C 
C       6.2     MERGE SIGN AND NUMBER INFORMATION TO RESULT 
C 
        IAS2B=ISIGN*IX
        GO TO 999 
C 
910     CONTINUE
C 
C       6.3     SIGNAL ERROR RESULT (LARGEST NEGATIVE NUMBER) 
C 
        IAS2B=100000B 
999     CONTINUE
      RETURN
      END 
        END$
